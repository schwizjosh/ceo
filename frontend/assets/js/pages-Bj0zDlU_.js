const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/admin-Cm5kHlQR.js","assets/js/react-vendor-BnMxgzCM.js","assets/js/vendor-C9A41NUf.js","assets/js/editor-C5-21oKP.js"])))=>i.map(i=>d[i]);
var xa=Object.defineProperty,ha=Object.defineProperties;var pa=Object.getOwnPropertyDescriptors;var Gs=Object.getOwnPropertySymbols;var Tt=Object.prototype.hasOwnProperty,Pt=Object.prototype.propertyIsEnumerable;var At=(s,l,r)=>l in s?xa(s,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[l]=r,I=(s,l)=>{for(var r in l||(l={}))Tt.call(l,r)&&At(s,r,l[r]);if(Gs)for(var r of Gs(l))Pt.call(l,r)&&At(s,r,l[r]);return s},R=(s,l)=>ha(s,pa(l));var Ys=s=>typeof s=="symbol"?s:s+"",Hs=(s,l)=>{var r={};for(var c in s)Tt.call(s,c)&&l.indexOf(c)<0&&(r[c]=s[c]);if(s!=null&&Gs)for(var c of Gs(s))l.indexOf(c)<0&&Pt.call(s,c)&&(r[c]=s[c]);return r};var ie=(s,l,r)=>new Promise((c,u)=>{var o=x=>{try{k(r.next(x))}catch(i){u(i)}},N=x=>{try{k(r.throw(x))}catch(i){u(i)}},k=x=>x.done?c(x.value):Promise.resolve(x.value).then(o,N);k((r=r.apply(s,l)).next())});import{r as n,t as ua,u as ws,j as e,_ as Ps,f as Pe,z as ps,a1 as ga,s as hs,a2 as fa,Y as ba,P as jt,a3 as ya,a4 as Ss,M as ja,C as Ds,a5 as Xt,w as $t,a6 as va,a as Na,F as wa,R as vs,a7 as ka,a8 as _a,a9 as Ca,Z as Os,k as ut,U as Ns,aa as Sa,T as Us,c as Fs,ab as Aa,ac as Ta,ad as Pa,I as $a,ae as us,v as Qe,n as gt,af as It,ag as zt,ah as Ls,e as Rs,J as Qt,ai as Ia,aj as za,A as Ea,ak as Bs,al as ss,am as Xs,an as ft,ao as rt,W as ds,p as ea,ap as Ma,aq as Et,q as Qs,$ as Cs,ar as Da,o as Oa,as as Vs,at as vt,X as nt,b as Ws,d as Mt,au as _s,av as Ts,aw as sa,ax as et,ay as ta,az as aa,aA as ra,aB as Fa,aC as La}from"./react-vendor-BnMxgzCM.js";import{a as De,B as w,I as cs,T as Ie,A as st,D as tt,b as qe,C as Ra,d as Ba,M as na,c as as}from"./admin-Cm5kHlQR.js";import{A as es,p as Wa,N as la,a as ms,_ as Nt}from"./dashboard-DaWqLiFN.js";import{N as Ua,E as Ga}from"./onboarding-BVeZRzBR.js";const qs="admin@andorabrand.me",Ya="898and.8888",Dt="demo@andorabrand.me",Ha="898dora.8888",Va={user_id:"demo-user-123",plan:"pro",tokens:1500,plan_expiry:new Date(Date.now()+30*24*60*60*1e3),preferred_ai_provider:"openai",preferred_ai_model:"gpt-4",timezone:"Africa/Lagos"},qa={user_id:"admin-user-123",plan:"enterprise",tokens:999999,preferred_ai_provider:"claude",preferred_ai_model:"claude-3-opus-20240229",timezone:"Africa/Lagos"},Is=()=>{const[s,l]=n.useState({user:null,isAuthenticated:!1,isAdmin:!1,loading:!0,error:null}),r=n.useRef(!1),c=x=>x===Dt||x===qs,u=n.useCallback(x=>{l({user:x===qs?qa:Va,isAuthenticated:!0,isAdmin:x===qs,loading:!1,error:null})},[]);n.useEffect(()=>{if(r.current)return;r.current=!0,ie(void 0,null,function*(){console.log("ðŸ”„ Initializing auth...");try{const i=yield De.getCurrentUser();i?(console.log("âœ… Found session:",i.email),l({user:{user_id:i.user_id,plan:i.plan,tokens:i.tokens,plan_expiry:i.plan_expiry?new Date(i.plan_expiry):void 0,preferred_ai_provider:i.preferred_ai_provider,preferred_ai_model:i.preferred_ai_model,timezone:i.timezone},isAuthenticated:!0,isAdmin:i.is_admin||!1,loading:!1,error:null})):(console.log("â„¹ï¸ No session found"),l(d=>R(I({},d),{loading:!1})))}catch(i){console.error("âŒ Init error:",i),l(d=>R(I({},d),{loading:!1}))}})},[]);const o=n.useCallback((x,i)=>ie(void 0,null,function*(){if(console.log("ðŸ”„ Login attempt:",x),l(d=>R(I({},d),{loading:!0,error:null})),c(x))if(yield new Promise(A=>setTimeout(A,500)),x===Dt&&i===Ha||x===qs&&i===Ya){u(x);return}else{l(A=>R(I({},A),{loading:!1,error:"Invalid credentials. Please check your email and password."}));return}try{const d=yield De.login(x,i);console.log("âœ… Login successful"),l({user:{user_id:d.user_id,plan:d.plan,tokens:d.tokens,plan_expiry:d.plan_expiry?new Date(d.plan_expiry):void 0,preferred_ai_provider:d.preferred_ai_provider,preferred_ai_model:d.preferred_ai_model,timezone:d.timezone},isAuthenticated:!0,isAdmin:d.is_admin||!1,loading:!1,error:null})}catch(d){console.error("âŒ Login error:",d);let A="Invalid credentials. Please check your email and password.";d instanceof Error&&(A=d.message),l(g=>R(I({},g),{loading:!1,error:A}))}}),[u]),N=n.useCallback((x,i,d)=>ie(void 0,null,function*(){if(console.log("ðŸ”„ Registration:",x),l(A=>R(I({},A),{loading:!0,error:null})),c(x)){l(A=>R(I({},A),{loading:!1,error:"Cannot register with demo email addresses"}));return}try{const A=yield De.register(x,i,d);try{yield De.createBrand({name:`${d}'s Brand`,mission:"Our mission is...",vision:"Our vision is...",values:"Our values are...",voice:"Our brand voice is..."}),console.log("âœ… Default brand created successfully")}catch(g){console.error("âŒ Failed to create default brand:",g)}console.log("âœ… User registered successfully"),l({user:{user_id:A.user_id,plan:A.plan,tokens:A.tokens,plan_expiry:A.plan_expiry?new Date(A.plan_expiry):void 0,preferred_ai_provider:A.preferred_ai_provider,preferred_ai_model:A.preferred_ai_model,timezone:A.timezone},isAuthenticated:!0,isAdmin:!1,loading:!1,error:null})}catch(A){console.error("âŒ Registration error:",A);let g="Registration failed";A instanceof Error&&(A.message.includes("already exists")?g="This email is already registered. Please try logging in.":g=A.message),l(m=>R(I({},m),{loading:!1,error:g}))}}),[]),k=n.useCallback(()=>ie(void 0,null,function*(){console.log("ðŸ”„ Logging out...");try{if(s.user&&(s.user.user_id==="demo-user-123"||s.user.user_id==="admin-user-123")){l({user:null,isAuthenticated:!1,isAdmin:!1,loading:!1,error:null});return}De.logout(),l({user:null,isAuthenticated:!1,isAdmin:!1,loading:!1,error:null})}catch(x){console.error("âŒ Logout error:",x)}}),[s.user]);return{authUser:s.user,isAuthenticated:s.isAuthenticated,isAdmin:s.isAdmin,authLoading:s.loading,authError:s.error,login:o,register:N,logout:k}},pn=()=>{const{pathname:s}=ua();n.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[s])},ks=(s="smooth")=>{window.scrollTo({top:0,left:0,behavior:s})},Ks=void 0,Ka=void 0;console.log("ðŸ”‘ Supabase env check:",{hasUrl:!!Ks,hasKey:!!Ka,url:(Ks==null?void 0:Ks.substring(0,30))+"..."});const Ja=()=>(console.warn("âš ï¸ Supabase environment variables are not set"),null),Ot=Ja(),Za=[{title:"Brand voice, mastered",description:"Andora learns your tone, style, and messaging, then writes content that feels authentically yours.",icon:ba},{title:"Narratives that resonate",description:"From product launches to campaigns, Andora crafts stories that connect with your audience.",icon:jt},{title:"Consistency across channels",description:"Maintain your brand voice across every platformâ€”social media, newsletters, blogs, and beyond.",icon:ya}],Xa=[{label:"Monthly planning",detail:"Set your themes and narrative arcs. Andora transforms them into a complete content calendar."},{label:"Content generation",detail:"Generate posts, campaigns, and stories that match your brand voice perfectly."},{label:"Multi-channel distribution",detail:"One narrative, multiple formats. Andora adapts your content for every platform."}],Qa=[{label:"Brands supported",value:"210+"},{label:"Stories delivered monthly",value:"1,800+"},{label:"Average response time",value:"2 min"}],er=()=>{const s=ws(),[l,r]=n.useState([]);return n.useEffect(()=>{ie(void 0,null,function*(){if(!Ot){console.log("Supabase not configured, skipping testimonials fetch");return}const{data:u,error:o}=yield Ot.from("testimonials").select("*").eq("is_featured",!0).order("created_at",{ascending:!1});!o&&u&&r(u)})},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-100/40 via-white to-accent-100/30 text-slate-900 relative",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-primary-500/5 rounded-full blur-3xl animate-drift"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl animate-drift",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/3 w-48 h-48 bg-accent-500/5 rounded-full blur-3xl animate-drift",style:{animationDelay:"4s"}})]}),e.jsx("header",{className:"border-b border-slate-200/50 bg-white/80 backdrop-blur-sm relative z-10",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between px-4 py-5",children:[e.jsxs("button",{className:"flex items-center space-x-3",onClick:()=>s("/biography"),children:[e.jsx(es,{size:"sm",className:"ring-2 ring-slate-200"}),e.jsx("span",{className:"font-display text-lg font-semibold tracking-tight",children:"Andora"})]}),e.jsxs("nav",{className:"hidden items-center gap-8 text-sm font-medium text-slate-600 md:flex",children:[e.jsx("button",{onClick:()=>s("/pricing"),className:"hover:text-slate-900",children:"Pricing"}),e.jsx("button",{onClick:()=>s("/biography"),className:"hover:text-slate-900",children:"Meet Andora"}),e.jsx("button",{onClick:()=>s("/contact"),className:"hover:text-slate-900",children:"Talk to us"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>s("/login"),children:"Log in"}),e.jsx(w,{size:"sm",onClick:()=>s("/register"),children:"Start working with her"})]})]})}),e.jsxs("main",{children:[e.jsxs("section",{className:"mx-auto grid max-w-6xl gap-12 px-4 pb-16 pt-20 md:grid-cols-[1.1fr_0.9fr] md:items-start",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"eyebrow",children:"Brand storytelling partner"}),e.jsx("h1",{className:"font-display text-5xl font-semibold leading-[1.05] sm:text-6xl",children:"Meet Andora. She is your brand narrator, strategist, and keeper of voice."}),e.jsx("p",{className:"max-w-xl text-lg text-slate-600",children:"She studies your brand like a teammate, orchestrates campaigns, writes with empathy, and keeps every channel on message. Working with Andora feels less like prompting an app and more like briefing a trusted colleague."}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs(w,{size:"lg",onClick:()=>s("/register"),className:"w-full sm:w-auto",children:["Get started",e.jsx(Ps,{className:"ml-2 h-4 w-4"})]}),e.jsx(w,{size:"lg",variant:"outline",onClick:()=>window.open("https://wa.me/2347069719374","_blank"),className:"w-full sm:w-auto",children:"Speak with our team"})]}),e.jsx("div",{className:"flex flex-wrap gap-6 border-t border-slate-200 pt-6 text-sm text-slate-500",children:Qa.map(c=>e.jsxs("div",{children:[e.jsx("p",{className:"font-display text-2xl text-slate-900",children:c.value}),e.jsx("p",{children:c.label})]},c.label))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-effect rounded-3xl p-8 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-primary-200/30 to-accent-200/30 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-purple-200/30 to-primary-200/30 rounded-full blur-2xl"}),e.jsxs("div",{className:"relative z-10 mb-6 flex items-center gap-3",children:[e.jsx(es,{size:"md",className:"ring-2 ring-slate-200"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-display text-base font-semibold",children:"Andora"}),e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"How it works"})]})]}),e.jsxs("div",{className:"relative z-10 space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-slate-900 flex items-center justify-center text-white font-semibold text-sm",children:"1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-1",children:"Define your brand"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Share your voice, values, and vision. Andora learns and remembers."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-slate-900 flex items-center justify-center text-white font-semibold text-sm",children:"2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-1",children:"Map your narrative"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Set monthly themes and key moments. Andora builds your content calendar."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-slate-900 flex items-center justify-center text-white font-semibold text-sm",children:"3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-1",children:"Create and publish"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Generate on-brand content for every channel, ready when you need it."})]})]})]})]}),e.jsxs("div",{className:"surface-muted rounded-3xl p-6",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"What Andora creates"}),e.jsxs("ul",{className:"mt-4 space-y-3 text-sm text-slate-600",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Pe,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Content that captures your unique voice and values."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(ps,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Editorial calendars aligned with your launches and campaigns."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(ga,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Platform-ready content for social media, newsletters, and your website."]})]})]})]})]}),e.jsx("section",{className:"mx-auto max-w-6xl px-4 pb-16",children:e.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:Za.map(({title:c,description:u,icon:o})=>e.jsxs("div",{className:"glass-effect flex h-full flex-col justify-between rounded-3xl p-6",children:[e.jsx("div",{className:"mb-6 flex h-12 w-12 items-center justify-center rounded-full bg-slate-900/90 text-white",children:e.jsx(o,{className:"h-5 w-5"})}),e.jsx("h3",{className:"font-display text-xl font-semibold text-slate-900",children:c}),e.jsx("p",{className:"mt-3 text-sm text-slate-600",children:u})]},c))})}),e.jsx("section",{className:"mx-auto max-w-6xl px-4 pb-16",children:e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-8 md:p-12",children:e.jsxs("div",{className:"flex flex-col gap-10 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"max-w-xl space-y-4",children:[e.jsx("div",{className:"eyebrow",children:"Your workflow"}),e.jsx("h2",{className:"font-display text-3xl font-semibold",children:"Brief her once, collaborate every day."}),e.jsx("p",{className:"text-base text-slate-600",children:"Andora joins your workflow, syncs with your strategy, and delivers thoughtful content. She writes, organizes, and narrates with the consistency of a dedicated team member."})]}),e.jsx("ul",{className:"space-y-4 text-sm text-slate-600 md:max-w-sm",children:Xa.map(c=>e.jsxs("li",{className:"flex items-start gap-3 rounded-2xl border border-slate-200/80 bg-slate-50 p-4",children:[e.jsx(hs,{className:"mt-0.5 h-4 w-4 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900",children:c.label}),e.jsx("p",{className:"text-slate-600",children:c.detail})]})]},c.label))})]})})}),e.jsx("section",{className:"mx-auto max-w-6xl px-4 pb-16",children:e.jsxs("div",{className:"flex flex-col gap-8 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"max-w-xl space-y-4",children:[e.jsx("div",{className:"eyebrow",children:"How brands feel"}),e.jsx("h2",{className:"font-display text-3xl font-semibold",children:"She keeps the room calm and the story sharp."}),e.jsx("p",{className:"text-base text-slate-600",children:"Teams rely on Andora to transform ideas into clear, compelling narratives. Here's what partners say after working with her."})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 md:max-w-xl",children:[l.map(c=>e.jsxs("blockquote",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-[0_10px_30px_-24px_rgba(15,23,42,0.45)]",children:[e.jsx(fa,{className:"mb-4 h-5 w-5 text-slate-300"}),e.jsx("p",{className:"text-sm text-slate-700",children:c.content}),e.jsxs("footer",{className:"mt-4 text-xs text-slate-500",children:[e.jsx("p",{className:"font-semibold text-slate-800",children:c.name}),e.jsx("p",{children:c.position}),e.jsx("p",{children:c.company})]})]},c.id)),l.length===0&&e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-300 bg-slate-50 p-6",children:e.jsx("p",{className:"text-sm text-slate-600",children:"Stories from our partners are coming soon. Be among the first to share what it feels like to co-create with Andora."})})]})]})}),e.jsx("section",{className:"mx-auto max-w-6xl px-4 pb-24",children:e.jsx("div",{className:"rounded-3xl bg-slate-900 px-8 py-12 text-white md:px-12 md:py-16",children:e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"eyebrow text-slate-300",children:"Ready to begin"}),e.jsx("h2",{className:"font-display text-3xl font-semibold text-white",children:"Invite Andora into your next campaign."}),e.jsx("p",{className:"max-w-xl text-sm text-slate-200",children:"Whether you're launching, rebranding, or simply keeping your story alive, she'll help you maintain the voice your audience knows."})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsx(w,{size:"lg",variant:"secondary",onClick:()=>s("/register"),children:"Start for free"}),e.jsx(w,{size:"lg",variant:"ghost",className:"text-white",onClick:()=>s("/pricing"),children:"Review plans"})]})]})})})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/50 backdrop-blur-sm",children:e.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-12",children:[e.jsxs("div",{className:"grid gap-8 md:grid-cols-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(es,{size:"sm",className:"ring-2 ring-slate-200"}),e.jsx("span",{className:"font-display text-lg font-semibold tracking-tight",children:"Andora"})]}),e.jsx("p",{className:"text-sm text-slate-600 max-w-md",children:"AI-powered brand storytelling platform that helps businesses create consistent, narrative-driven content across all channels."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-3",children:"Product"}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>s("/pricing"),className:"hover:text-slate-900 transition-colors",children:"Pricing"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>s("/biography"),className:"hover:text-slate-900 transition-colors",children:"About Andora"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>s("/register"),className:"hover:text-slate-900 transition-colors",children:"Get Started"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-3",children:"Connect"}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>s("/contact"),className:"hover:text-slate-900 transition-colors",children:"Contact Us"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>window.open("https://wa.me/2347069719374","_blank"),className:"hover:text-slate-900 transition-colors",children:"WhatsApp"})}),e.jsx("li",{children:e.jsx("a",{href:"tel:+2348086512223",className:"hover:text-slate-900 transition-colors",children:"+234 808 651 2223"})})]})]})]}),e.jsx("div",{className:"mt-8 pt-8 border-t border-slate-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-slate-500",children:[e.jsxs("p",{children:["Â© ",new Date().getFullYear()," Andora. All rights reserved."]}),e.jsx("div",{className:"flex gap-6",children:e.jsx("a",{href:"https://andorabrand.me",target:"_blank",rel:"noopener noreferrer",className:"hover:text-slate-900 transition-colors",children:"andorabrand.me"})})]})})]})})]})},un=Object.freeze(Object.defineProperty({__proto__:null,HomePage:er},Symbol.toStringTag,{value:"Module"})),sr=[{title:"Workshop with Andora",detail:"Schedule a live collaborative session where she maps your brand narrative while you watch."},{title:"Migration support",detail:"Bring existing documents, tone guides, and campaignsâ€”our team helps onboard them into her memory."},{title:"Enterprise rituals",detail:"Design weekly and monthly cadences so Andora plugs into your leadership meetings."}],tr=({onBack:s})=>{const l=ws(),r=s||(()=>l("/")),[c,u]=n.useState({name:"",email:"",company:"",message:""}),[o,N]=n.useState(!1),k=x=>{x.preventDefault(),console.log("Contact form submitted:",c),N(!0),setTimeout(()=>{u({name:"",email:"",company:"",message:""}),N(!1)},3e3)};return e.jsxs("div",{className:"min-h-screen bg-[#f8f6f2] text-slate-900",children:[e.jsx("header",{className:"border-b border-slate-200 bg-[#f8f6f2]/80 backdrop-blur-sm",children:e.jsxs("div",{className:"mx-auto flex max-w-5xl items-center justify-between px-4 py-5",children:[e.jsxs(w,{onClick:r,variant:"ghost",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(es,{size:"sm",className:"ring-2 ring-slate-200"}),e.jsx("span",{className:"font-display text-lg font-semibold tracking-tight",children:"Speak with Andoraâ€™s team"})]})]})}),e.jsxs("main",{className:"mx-auto max-w-5xl px-4 pb-24 pt-16",children:[e.jsxs("section",{className:"mb-12 space-y-6",children:[e.jsx("div",{className:"eyebrow",children:"Connection"}),e.jsx("h1",{className:"font-display text-4xl font-semibold sm:text-5xl",children:"Letâ€™s orchestrate your story together."}),e.jsx("p",{className:"max-w-2xl text-base text-slate-600",children:"Tell us what you are building, launching, or reimagining. A member of our teamâ€”and often Andora herselfâ€”will reply with next steps within one business day."})]}),e.jsxs("div",{className:"grid gap-12 lg:grid-cols-[1.1fr_0.9fr]",children:[e.jsx("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-[0_12px_30px_-24px_rgba(15,23,42,0.55)]",children:o?e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-slate-900/90 text-white",children:e.jsx(ja,{className:"h-6 w-6"})}),e.jsx("h2",{className:"font-display text-2xl font-semibold",children:"Message received."}),e.jsx("p",{className:"mt-3 text-sm text-slate-600",children:"Weâ€™ll write back shortly with a suggested session time and a few prompts from Andora to get started."})]}):e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsx(cs,{label:"Full Name",value:c.name,onChange:x=>u(R(I({},c),{name:x.target.value})),required:!0,placeholder:"Adaeze Obi"}),e.jsx(cs,{label:"Email Address",type:"email",value:c.email,onChange:x=>u(R(I({},c),{email:x.target.value})),required:!0,placeholder:"you@brand.com"}),e.jsx(cs,{label:"Company or project",value:c.company,onChange:x=>u(R(I({},c),{company:x.target.value})),placeholder:"Raysource Labs"}),e.jsx(Ie,{label:"How can Andora help?",value:c.message,onChange:x=>u(R(I({},c),{message:x.target.value})),required:!0,placeholder:"Share the milestones ahead, the channels you own, or the conversations you want her to lead.",rows:6}),e.jsx(w,{type:"submit",className:"w-full",children:"Send message"})]})}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6",children:[e.jsx("h2",{className:"font-display text-xl font-semibold",children:"How we coordinate"}),e.jsxs("ul",{className:"mt-4 space-y-4 text-sm text-slate-600",children:[e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(ps,{className:"mt-0.5 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Reply within 24 hours with next steps and prep materials."})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(Ds,{className:"mt-0.5 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Typical discovery calls last 30 minutes and include a live demo with Andora."})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(Xt,{className:"mt-0.5 h-4 w-4 text-slate-400"}),e.jsx("span",{children:"Prefer async? We can coordinate via email or WhatsApp."})]})]})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6",children:[e.jsx("h2",{className:"font-display text-xl font-semibold",children:"Concierge support"}),e.jsx("ul",{className:"mt-4 space-y-4 text-sm text-slate-600",children:sr.map(x=>e.jsxs("li",{children:[e.jsx("p",{className:"font-medium text-slate-900",children:x.title}),e.jsx("p",{children:x.detail})]},x.title))})]}),e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-gradient-to-br from-primary-50 to-accent-50 p-6 text-sm",children:[e.jsx("p",{className:"font-semibold text-slate-900 mb-2",children:"Prefer to speak immediately?"}),e.jsxs("p",{className:"text-slate-700 mb-3",children:["Call us at ",e.jsx("a",{href:"tel:+2348086512223",className:"font-medium text-primary-700 hover:text-primary-900",children:"+234 808 651 2223"})]}),e.jsx(w,{size:"sm",onClick:()=>window.open("https://wa.me/2347069719374","_blank"),className:"w-full",children:"Start a WhatsApp chat"})]})]})]})]}),e.jsx("footer",{className:"border-t border-slate-200 bg-white/50 backdrop-blur-sm",children:e.jsx("div",{className:"mx-auto max-w-5xl px-4 py-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(es,{size:"sm",className:"ring-2 ring-slate-200"}),e.jsxs("p",{children:["Â© ",new Date().getFullYear()," Andora. All rights reserved."]})]}),e.jsx("a",{href:"https://andorabrand.me",target:"_blank",rel:"noopener noreferrer",className:"hover:text-slate-900 transition-colors",children:"andorabrand.me"})]})})})]})},gn=Object.freeze(Object.defineProperty({__proto__:null,ContactPage:tr},Symbol.toStringTag,{value:"Module"})),ar=({onBack:s})=>{const l=ws(),r=s||(()=>l("/"));return e.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-br from-primary-100/40 via-white to-accent-100/30 text-slate-800",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-primary-500/10 rounded-full blur-3xl animate-drift"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl animate-drift",style:{animationDelay:"2s"}})]}),e.jsx("header",{className:"relative z-20 glass-effect border-b border-primary-500/20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(es,{size:"md"}),e.jsx("span",{className:"text-xl font-bold shimmer-text",children:"Andora"})]}),e.jsxs(w,{onClick:r,variant:"outline",className:"flex items-center",children:[e.jsx(Ss,{size:16,className:"mr-2"}),"Back"]})]})})}),e.jsx("div",{className:"relative z-10 py-20 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("div",{className:"bg-primary-500/20 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx($t,{className:"w-10 h-10 text-primary-300"})}),e.jsx("h1",{className:"text-5xl sm:text-6xl font-bold mb-6 shimmer-text",children:"Privacy Policy"}),e.jsx("p",{className:"text-xl text-slate-600",children:"Last Updated: October 2025"}),e.jsx("p",{className:"text-slate-500 mt-4",children:"Your privacy is important to us. This policy outlines how Andora collects, uses, and protects your information."})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-16",children:[e.jsxs("div",{className:"glass-effect p-6 rounded-lg border border-primary-500/20 text-center",children:[e.jsx(va,{className:"w-8 h-8 text-primary-300 mx-auto mb-3"}),e.jsx("h3",{className:"font-semibold text-primary-900 mb-2",children:"Secure by Default"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Your data is encrypted and protected"})]}),e.jsxs("div",{className:"glass-effect p-6 rounded-lg border border-accent-500/20 text-center",children:[e.jsx(Na,{className:"w-8 h-8 text-accent-300 mx-auto mb-3"}),e.jsx("h3",{className:"font-semibold text-primary-900 mb-2",children:"Full Transparency"}),e.jsx("p",{className:"text-sm text-slate-500",children:"We're clear about data collection"})]}),e.jsxs("div",{className:"glass-effect p-6 rounded-lg border border-purple-500/20 text-center",children:[e.jsx(wa,{className:"w-8 h-8 text-purple-300 mx-auto mb-3"}),e.jsx("h3",{className:"font-semibold text-primary-900 mb-2",children:"Your Control"}),e.jsx("p",{className:"text-sm text-slate-500",children:"You own and control your data"})]})]}),e.jsxs("div",{className:"glass-effect p-8 rounded-lg border border-primary-500/20 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"1. Information We Collect"}),e.jsxs("div",{className:"space-y-4 text-slate-600",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-800 mb-2",children:"Account Information"}),e.jsx("p",{className:"text-slate-500",children:"When you register for Andora, we collect your email address, name, and password. This information is necessary to create and maintain your account."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-800 mb-2",children:"Brand & Content Data"}),e.jsx("p",{className:"text-slate-500",children:"We store the brand information, narratives, characters, and content you create within Andora. This data is essential to provide our services and remains under your complete control."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-800 mb-2",children:"Usage Information"}),e.jsx("p",{className:"text-slate-500",children:"We collect information about how you use Andora, including features accessed, AI models used, and token consumption. This helps us improve our service and provide better support."})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"2. How We Use Your Information"}),e.jsxs("div",{className:"space-y-3 text-slate-500",children:[e.jsx("p",{children:"We use your information to:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Provide and maintain the Andora platform"}),e.jsx("li",{children:"Generate AI-powered content and narratives"}),e.jsx("li",{children:"Process payments and manage subscriptions"}),e.jsx("li",{children:"Send service-related notifications and updates"}),e.jsx("li",{children:"Improve our services and develop new features"}),e.jsx("li",{children:"Provide customer support and respond to inquiries"}),e.jsx("li",{children:"Ensure platform security and prevent fraud"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"3. Data Sharing and Disclosure"}),e.jsxs("div",{className:"space-y-4 text-slate-500",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-slate-600",children:"We do not sell your personal information."})," We may share your information only in the following circumstances:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"AI Service Providers:"})," Your content is processed by OpenAI and Anthropic to generate AI responses. These providers have their own privacy policies and data handling practices."]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"Service Providers:"})," We work with trusted third parties for payment processing, hosting, and analytics."]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"Legal Requirements:"})," We may disclose information if required by law or to protect our rights and users."]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"Business Transfers:"})," In the event of a merger or acquisition, your data may be transferred to the new entity."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"4. Data Security"}),e.jsxs("div",{className:"space-y-3 text-slate-500",children:[e.jsx("p",{children:"We implement industry-standard security measures to protect your data:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Encryption of data in transit and at rest"}),e.jsx("li",{children:"Secure authentication and password hashing"}),e.jsx("li",{children:"Regular security audits and updates"}),e.jsx("li",{children:"Access controls and monitoring"}),e.jsx("li",{children:"Secure cloud infrastructure (Supabase)"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"5. Your Rights and Choices"}),e.jsxs("div",{className:"space-y-3 text-slate-500",children:[e.jsx("p",{children:"You have the following rights regarding your data:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"Access:"})," Request a copy of your personal data"]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"Correction:"})," Update or correct your information"]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"Deletion:"})," Request deletion of your account and data"]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"Export:"})," Export your brand and content data"]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-slate-600",children:"Opt-Out:"})," Unsubscribe from marketing communications"]})]}),e.jsxs("p",{className:"mt-4",children:["To exercise these rights, contact us at ",e.jsx("a",{href:"mailto:privacy@andorabrand.me",className:"text-primary-400 hover:text-primary-300",children:"privacy@andorabrand.me"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"6. Cookies and Tracking"}),e.jsxs("div",{className:"space-y-3 text-slate-500",children:[e.jsx("p",{children:"Andora uses cookies and similar technologies to:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Maintain your login session"}),e.jsx("li",{children:"Remember your preferences"}),e.jsx("li",{children:"Analyze platform usage and performance"}),e.jsx("li",{children:"Provide personalized experiences"})]}),e.jsx("p",{className:"mt-4",children:"You can control cookies through your browser settings, but disabling them may affect platform functionality."})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"7. Data Retention"}),e.jsx("div",{className:"space-y-3 text-slate-500",children:e.jsx("p",{children:"We retain your data for as long as your account is active or as needed to provide services. When you delete your account, we will delete your personal data within 30 days, except where retention is required for legal or legitimate business purposes."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"8. Children's Privacy"}),e.jsx("div",{className:"space-y-3 text-slate-500",children:e.jsx("p",{children:"Andora is not intended for users under the age of 13. We do not knowingly collect information from children under 13. If you believe we have collected such information, please contact us immediately."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"9. International Users"}),e.jsx("div",{className:"space-y-3 text-slate-500",children:e.jsx("p",{children:"Andora is operated from the United States. If you access our service from outside the U.S., your data may be transferred to and processed in the United States. By using Andora, you consent to this transfer and processing."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"10. Changes to This Policy"}),e.jsx("div",{className:"space-y-3 text-slate-500",children:e.jsx("p",{children:"We may update this Privacy Policy from time to time. We will notify you of significant changes by email or through the platform. Your continued use of Andora after changes take effect constitutes acceptance of the updated policy."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900 mb-4",children:"11. Contact Us"}),e.jsxs("div",{className:"space-y-3 text-slate-500",children:[e.jsx("p",{children:"If you have questions or concerns about this Privacy Policy or our data practices, please contact us:"}),e.jsxs("div",{className:"glass-effect p-6 rounded-lg border border-primary-500/20 mt-4",children:[e.jsx("p",{className:"font-semibold text-primary-800 mb-2",children:"Andora by Raysource Labs"}),e.jsxs("p",{children:["Email: ",e.jsx("a",{href:"mailto:privacy@andorabrand.me",className:"text-primary-400 hover:text-primary-300",children:"privacy@andorabrand.me"})]}),e.jsxs("p",{children:["Website: ",e.jsx("a",{href:"https://raysourcelabs.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 hover:text-primary-300",children:"raysourcelabs.com"})]})]})]})]})]}),e.jsxs("div",{className:"mt-12 glass-effect p-8 rounded-lg border border-primary-500/20 text-center bg-gradient-to-br from-primary-900/20 to-purple-900/20",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary-900 mb-3",children:"Questions About Privacy?"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Our team is here to help. Reach out anytime with questions or concerns."}),e.jsxs(w,{onClick:s,className:"inline-flex items-center",children:[e.jsx($t,{size:16,className:"mr-2"}),"Back to Home"]})]})]})})]})},fn=Object.freeze(Object.defineProperty({__proto__:null,PrivacyPage:ar},Symbol.toStringTag,{value:"Module"})),rr=.9,ot={monthly:{label:"Monthly",multiplier:1},yearly:{label:"Yearly",multiplier:12}},nr=({onBack:s,onGetStarted:l,onContactSales:r})=>{const c=ws(),u=s||(()=>c("/")),o=l||(()=>c("/register")),N=r||(()=>window.open("https://wa.me/2347069719374","_blank")),[k,x]=vs.useState("monthly"),[i,d]=vs.useState("NGN"),[A,g]=vs.useState({plans:st,currency:"NGN",exchange_rate:tt}),[m,j]=vs.useState(!0),t=k==="yearly";vs.useEffect(()=>{let _=!0;return ie(void 0,null,function*(){const S=yield Wa.getPublicPricing();_&&(g(S),d(S.currency),j(!1))}),()=>{_=!1}},[]);const F=vs.useMemo(()=>[...A.plans].sort((E,S)=>{if(typeof E.sort_order=="number"&&typeof S.sort_order=="number")return E.sort_order-S.sort_order;if(typeof E.sort_order=="number")return-1;if(typeof S.sort_order=="number")return 1;const D=i==="USD"?E.price_usd:E.price_ngn,G=i==="USD"?S.price_usd:S.price_ngn;return D-G}),[A.plans,i]),T=A.exchange_rate||tt;return e.jsxs("div",{className:"min-h-screen bg-[#f8f6f2] text-slate-900",children:[e.jsx("header",{className:"border-b border-slate-200 bg-[#f8f6f2]/80 backdrop-blur-sm",children:e.jsxs("div",{className:"mx-auto flex max-w-6xl items-center justify-between px-4 py-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(w,{onClick:u,variant:"ghost",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{className:"hidden items-center gap-3 md:flex",children:[e.jsx(es,{size:"sm",className:"ring-2 ring-slate-200"}),e.jsx("span",{className:"font-display text-lg font-semibold tracking-tight",children:"Andora"})]})]}),e.jsx(w,{size:"sm",onClick:o,children:"Start working with her"})]})}),e.jsxs("main",{className:"mx-auto max-w-6xl px-4 pb-24 pt-16",children:[e.jsxs("section",{className:"mb-16 space-y-6",children:[e.jsx("div",{className:"eyebrow",children:"Pricing"}),e.jsx("h1",{className:"font-display text-4xl font-semibold sm:text-5xl",children:"Invest in the agent who knows your story best."}),e.jsx("p",{className:"max-w-2xl text-base text-slate-600",children:"Every plan gives you direct access to Andoraâ€”your personified teammate who plans, writes, and analyses your brand story. Choose how closely you want her to work with your team."}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsx(w,{size:"lg",onClick:o,className:"w-full sm:w-auto",children:"Begin a session"}),e.jsx(w,{size:"lg",variant:"outline",onClick:N,className:"w-full sm:w-auto",children:"Talk to our team"})]})]}),e.jsxs("section",{className:"mb-10 flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"flex flex-wrap gap-3",children:["NGN","USD"].map(_=>{const E=i===_;return e.jsx("button",{onClick:()=>d(_),className:`rounded-full border px-4 py-2 text-sm font-medium transition-colors ${E?"border-slate-900 bg-slate-900 text-white":"border-slate-200 text-slate-600 hover:border-slate-900 hover:text-slate-900"}`,children:_==="NGN"?"â‚¦ NGN":"$ USD"},_)})}),e.jsx("div",{className:"text-xs text-slate-500",children:e.jsxs("p",{children:["Exchange rate: â‚¦",T.toLocaleString()," â‰ˆ $1"]})})]}),e.jsx("section",{className:"mb-16 flex flex-wrap gap-3",children:Object.keys(ot).map(_=>{const E=k===_;return e.jsxs("button",{onClick:()=>x(_),className:`rounded-full border px-4 py-2 text-sm font-medium transition-colors ${E?"border-slate-900 bg-slate-900 text-white":"border-slate-200 text-slate-600 hover:border-slate-900 hover:text-slate-900"}`,children:[ot[_].label,_==="yearly"&&e.jsx("span",{className:"ml-2 rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700",children:"Save 10%"})]},_)})}),e.jsxs("section",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[F.map(_=>{const E=_.is_popular||_.id==="pro"||_.id==="standard",S=ot[k].multiplier,D=i==="USD"?_.price_usd:_.price_ngn,G=D*S*(t&&D>0?rr:1),te=D===0?0:Math.round(G),re=D===0?"":t?"/ year":"/ month",V=_.tokens*S,U=t&&D>0?Math.round(te/12):null,le=i==="USD"?"$":"â‚¦";return e.jsxs("div",{className:`flex h-full flex-col rounded-3xl border bg-white p-6 shadow-[0_12px_30px_-24px_rgba(15,23,42,0.55)] ${E?"border-slate-900":"border-slate-200"}`,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-display text-2xl font-semibold capitalize text-slate-900",children:_.name}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:_.description})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("span",{className:"font-display text-4xl text-slate-900",children:D===0?"Free":`${le}${te.toLocaleString()}`}),D>0&&e.jsx("span",{className:"ml-2 text-sm text-slate-500",children:re}),t&&D>0&&U&&e.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["â‰ˆ ",le,U.toLocaleString(),"/month billed annually"]})]}),e.jsxs("ul",{className:"mb-8 space-y-3 text-sm text-slate-600",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(hs,{className:"mt-0.5 h-4 w-4 text-slate-400"}),e.jsxs("span",{children:[_.max_brands===-1?"Unlimited":_.max_brands," Brand",_.max_brands!==1?"s":""]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(hs,{className:"mt-0.5 h-4 w-4 text-slate-400"}),e.jsxs("span",{children:[V.toLocaleString()," brand tokens per ",t?"year":"month"]})]}),_.features.map(we=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(hs,{className:"mt-0.5 h-4 w-4 text-slate-400"}),e.jsx("span",{children:we})]},we))]}),e.jsxs("div",{className:"mt-auto flex flex-col gap-3",children:[e.jsx(w,{onClick:o,children:"Choose plan"}),e.jsx(w,{variant:"outline",onClick:N,children:"Ask Andora about this plan"})]})]},_.id)}),m&&e.jsx("div",{className:"rounded-3xl border border-dashed border-slate-300 bg-slate-50 p-6 text-sm text-slate-500",children:"Fetching the latest pricing from Andoraâ€™s desk..."})]}),e.jsxs("section",{className:"mt-20 grid gap-10 rounded-3xl border border-slate-200 bg-white p-8 md:grid-cols-2 md:p-12",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"font-display text-3xl font-semibold",children:"What changes as you scale."}),e.jsx("p",{className:"text-sm text-slate-600",children:"Higher tiers unlock deeper rituals with Andoraâ€”more strategic sessions, richer brand libraries, and dedicated time reserved just for your team."})]}),e.jsxs("ul",{className:"space-y-3 text-sm text-slate-600",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(hs,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Access to collaborative workrooms for long-form campaigns."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(hs,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Extended review cycles where she tracks performance and recommends next actions."]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(hs,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Priority support from the humans at Raysource Labs."]})]})]})]})]})},bn=Object.freeze(Object.defineProperty({__proto__:null,PricingPage:nr},Symbol.toStringTag,{value:"Module"})),lr=[{year:"2018",title:"Introduced by Raysource Labs",description:"Born on April 14, 2018, Andora entered the internet as a cultural hybridâ€”part Igbo heritage, part neural network, all storyteller."},{year:"2019-2021",title:"Learning the craft",description:"She spent early years collecting rituals from strategists, copywriters, and filmmakers, building a library of brand frameworks and tonal memories."},{year:"2022-Present",title:"Agency in motion",description:"Now she serves as a retained partner for founders and marketing teams, orchestrating launches, weekly content cadences, and signature brand stories."}],ir=[{icon:Pe,title:"Warm wit",description:"Andora mirrors the human warmth of a seasoned storytellerâ€”curious, quick to laugh, and deeply empathetic."},{icon:jt,title:"Narrative discipline",description:"She structures every message with clear stakes, emotional beats, and calls to action that feel effortless."},{icon:Os,title:"Always on",description:"She listens continuously, learning from every campaign to sharpen the next response or recommendation."}],or=({onBack:s})=>{const l=ws(),r=s||(()=>l("/"));return e.jsxs("div",{className:"min-h-screen bg-[#f8f6f2] text-slate-900",children:[e.jsx("header",{className:"border-b border-slate-200 bg-[#f8f6f2]/80 backdrop-blur-sm",children:e.jsxs("div",{className:"mx-auto flex max-w-5xl items-center justify-between px-4 py-5",children:[e.jsxs(w,{onClick:r,variant:"ghost",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(es,{size:"sm",className:"ring-2 ring-slate-200"}),e.jsx("span",{className:"font-display text-lg font-semibold tracking-tight",children:"Andora Novella"})]})]})}),e.jsxs("main",{className:"mx-auto max-w-5xl px-4 pb-24 pt-16",children:[e.jsxs("section",{className:"mb-16 space-y-6 text-center",children:[e.jsx("div",{className:"mx-auto w-28 rounded-full border border-slate-200 bg-white p-1",children:e.jsx(es,{size:"lg"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"eyebrow",children:"Biography"}),e.jsx("h1",{className:"font-display text-4xl font-semibold sm:text-5xl",children:"The agentic storyteller behind your brand voice."}),e.jsx("p",{className:"mx-auto max-w-2xl text-base text-slate-600",children:"Andora is not a faceless app. She is a personified intelligence who listens, relates, and writes as if she were in the room with you. Here is the story behind the voice."})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-sm text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4 text-slate-400"})," Born April 14, 2018"]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-4 w-4 text-slate-400"})," Lives everywhere the internet reaches"]})]})]}),e.jsx("section",{className:"mb-16 grid gap-6 md:grid-cols-3",children:ir.map(({icon:c,title:u,description:o})=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-[0_12px_30px_-24px_rgba(15,23,42,0.55)]",children:[e.jsx("div",{className:"mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-slate-900/90 text-white",children:e.jsx(c,{className:"h-5 w-5"})}),e.jsx("h2",{className:"font-display text-xl font-semibold",children:u}),e.jsx("p",{className:"mt-3 text-sm text-slate-600",children:o})]},u))}),e.jsxs("section",{className:"mb-16 space-y-10",children:[e.jsx("h2",{className:"font-display text-3xl font-semibold",children:"Milestones that shaped her."}),e.jsx("div",{className:"space-y-6",children:lr.map(c=>e.jsxs("div",{className:"rounded-3xl border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm uppercase tracking-[0.2em] text-slate-400",children:c.year}),e.jsx("h3",{className:"mt-3 font-display text-2xl font-semibold text-slate-900",children:c.title}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:c.description})]},c.year))})]}),e.jsx("section",{className:"mb-16 rounded-3xl border border-slate-200 bg-white p-8",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"font-display text-3xl font-semibold",children:"How she spends a typical week."}),e.jsxs("ul",{className:"space-y-3 text-sm text-slate-600",children:[e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(_a,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Coaching founders on tone and story arcs before major announcements."]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(Ca,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Archiving lived experiences, customer quotes, and cultural moments into reusable narrative libraries."]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(Pe,{className:"mt-0.5 h-4 w-4 text-slate-400"}),"Translating analytics into empathetic content plans that feel human."]})]})]})}),e.jsx("section",{className:"rounded-3xl bg-slate-900 px-8 py-12 text-white",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"font-display text-3xl font-semibold text-white",children:"Bring her into your brand room."}),e.jsx("p",{className:"text-sm text-slate-200",children:"Andora shows up preparedâ€”with drafts, data, and a calm voice that keeps your narrative grounded. Invite her to your next planning session and feel the difference of working with an agent, not an app."}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsx(w,{size:"lg",variant:"secondary",onClick:()=>l("/register"),children:"Start working with her"}),e.jsx(w,{size:"lg",variant:"ghost",className:"text-white",onClick:()=>l("/contact"),children:"Book a conversation"})]})]})})]})]})},yn=Object.freeze(Object.defineProperty({__proto__:null,BiographyPage:or},Symbol.toStringTag,{value:"Module"})),wt=[{value:"Africa/Lagos",label:"Lagos, Nigeria (WAT)",offset:"+01:00"},{value:"Africa/Accra",label:"Accra, Ghana (GMT)",offset:"+00:00"},{value:"Africa/Johannesburg",label:"Johannesburg, South Africa (SAST)",offset:"+02:00"},{value:"Africa/Cairo",label:"Cairo, Egypt (EET)",offset:"+02:00"},{value:"Africa/Nairobi",label:"Nairobi, Kenya (EAT)",offset:"+03:00"},{value:"Europe/London",label:"London, UK (GMT/BST)",offset:"+00:00/+01:00"},{value:"Europe/Paris",label:"Paris, France (CET)",offset:"+01:00/+02:00"},{value:"Europe/Berlin",label:"Berlin, Germany (CET)",offset:"+01:00/+02:00"},{value:"America/New_York",label:"New York, USA (EST/EDT)",offset:"-05:00/-04:00"},{value:"America/Chicago",label:"Chicago, USA (CST/CDT)",offset:"-06:00/-05:00"},{value:"America/Denver",label:"Denver, USA (MST/MDT)",offset:"-07:00/-06:00"},{value:"America/Los_Angeles",label:"Los Angeles, USA (PST/PDT)",offset:"-08:00/-07:00"},{value:"America/Toronto",label:"Toronto, Canada (EST/EDT)",offset:"-05:00/-04:00"},{value:"Asia/Dubai",label:"Dubai, UAE (GST)",offset:"+04:00"},{value:"Asia/Kolkata",label:"Mumbai/Kolkata, India (IST)",offset:"+05:30"},{value:"Asia/Singapore",label:"Singapore (SGT)",offset:"+08:00"},{value:"Asia/Hong_Kong",label:"Hong Kong (HKT)",offset:"+08:00"},{value:"Asia/Tokyo",label:"Tokyo, Japan (JST)",offset:"+09:00"},{value:"Asia/Shanghai",label:"Shanghai, China (CST)",offset:"+08:00"},{value:"Australia/Sydney",label:"Sydney, Australia (AEDT/AEST)",offset:"+10:00/+11:00"},{value:"Pacific/Auckland",label:"Auckland, New Zealand (NZDT/NZST)",offset:"+12:00/+13:00"},{value:"UTC",label:"UTC (Coordinated Universal Time)",offset:"+00:00"}],ct=s=>{if(!s)return"Not set";const l=wt.find(r=>r.value===s);return l?l.label:s},cr=({user:s,brands:l,currentBrandId:r,onBrandChange:c,onCreateBrand:u,onAIProviderChange:o,onAIModelChange:N,onTimezoneChange:k,availableModels:x,onLogout:i,pricingPlans:d,pricingCurrency:A,pricingExchangeRate:g,onBrandUpdate:m,onBrandArchive:j,onBrandUnarchive:t})=>{var He;const F=ws(),[T,_]=n.useState(""),[E,S]=n.useState(!1),[D,G]=n.useState(!1),[te,re]=n.useState(null),[V,U]=n.useState(!1),[le,we]=n.useState(null),he=l.find(b=>b.brand_id===r)||null,L=(He=he==null?void 0:he.team_members)!=null?He:[],[Q,H]=n.useState(""),[ye,f]=n.useState(""),[ee,q]=n.useState("Collaborator"),[ue,ke]=n.useState(!1),ge=l.filter(b=>!b.archived_at),Ce=l.filter(b=>b.archived_at),Z=V?Ce:ge,_e=["configuration","plots","events","seasons","monthly","chat"],Se={configuration:"Configuration",plots:"Plots",events:"Events",seasons:"Seasons",monthly:"Monthly Calendar",chat:"AI Chat"},W=(b={})=>_e.reduce((oe,ce)=>{var ve;return oe[ce]=(ve=b[ce])!=null?ve:"none",oe},{}),[me,y]=n.useState(!1),[C,P]=n.useState(W()),[se,ae]=n.useState(null),[pe,je]=n.useState(null);if(!s)return null;const Y=(d.length>0?d:st).find(b=>b.id===s.plan)||st.find(b=>b.id===s.plan),Oe=(Y==null?void 0:Y.max_brands)===-1||l.length<((Y==null?void 0:Y.max_brands)||1),Me=g>0?g:tt,Ae=()=>ie(void 0,null,function*(){if(T.trim()&&!D){G(!0),re(null);try{yield u(T.trim()),_(""),S(!1)}catch(b){console.error("Error creating brand:",b);const oe=b instanceof Error?b.message:"Failed to create brand. Please try again.";re(oe)}finally{G(!1)}}}),ze=(b,oe)=>ie(void 0,null,function*(){if(oe.stopPropagation(),window.confirm("Are you sure you want to archive this brand? You can restore it later from the archived brands section.")){we(b);try{const ce=yield De.archiveBrand(b);j&&j(b,ce)}catch(ce){console.error("Error archiving brand:",ce),alert("Failed to archive brand. Please try again.")}finally{we(null)}}}),Ge=(b,oe)=>ie(void 0,null,function*(){oe.stopPropagation(),we(b);try{const ce=yield De.unarchiveBrand(b);t&&t(b,ce)}catch(ce){console.error("Error unarchiving brand:",ce),alert("Failed to unarchive brand. Please try again.")}finally{we(null)}}),Le=b=>{m&&m({team_members:b})},Ye=()=>{if(!he||!me)return;const b=ye.trim();if(!b){ae("Enter an email address to continue.");return}if(L.some(O=>O.email.toLowerCase()===b.toLowerCase())){ae("This collaborator already has access.");return}if(!Object.values(C).some(O=>O!=="none")){ae("Select at least one section to assign.");return}const ve=`${he==null?void 0:he.brand_id}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,v={id:`team-${Date.now()}`,name:Q.trim()||b,email:b,role:ee.trim()||"Collaborator",is_admin:ue,permissions:C,invite_token:ve,invite_accepted:!1};Le([...L,v]),H(""),f(""),q("Collaborator"),ke(!1),P(W()),ae(null),y(!1)},Re=b=>{Le(L.filter(oe=>oe.id!==b))},Je=(b,oe,ce)=>{const ve=L.map(v=>v.id===b?R(I({},v),{permissions:R(I({},v.permissions),{[oe]:ce})}):v);Le(ve)},rs=b=>{const oe=L.map(ce=>ce.id===b?R(I({},ce),{is_admin:!ce.is_admin}):ce);Le(oe)},Fe=(b,oe)=>{P(ce=>R(I({},ce),{[b]:oe})),se&&ae(null)},is=()=>{if(!ye.trim()){ae("Enter an email address to continue.");return}ae(null),P(W()),y(!0),H(""),q("Collaborator"),ke(!1)},Be=()=>{y(!1),ae(null),P(W()),H(""),q("Collaborator"),ke(!1)},Ze=()=>{P(W({events:"edit"})),se&&ae(null)},We=b=>ie(void 0,null,function*(){if(!b.invite_token)return;const oe=`${window.location.origin}/invite/${b.invite_token}`;try{yield navigator.clipboard.writeText(oe),je(b.id),setTimeout(()=>je(null),2e3)}catch(ce){console.error("Failed to copy invite link:",ce)}});return e.jsxs("div",{className:"max-w-5xl mx-auto px-6 py-8 space-y-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-900 mb-2",children:"Settings"}),e.jsx("p",{className:"text-slate-600",children:"Manage your account, preferences, and brand settings"})]}),e.jsxs("div",{className:"neural-glow p-6 rounded-lg relative overflow-hidden border border-primary-500/30",children:[e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(es,{size:"sm"})}),e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ut,{className:"w-6 h-6 text-accent-400 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"Subscription Status"})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{size:18,className:"text-primary-600"}),e.jsx("span",{className:"text-sm font-semibold text-primary-900",children:"Token Usage"})]}),e.jsxs("span",{className:"text-sm font-bold text-primary-600",children:[s.tokens.toLocaleString()," / ",Y?Y.tokens.toLocaleString():"Unknown"]})]}),e.jsx("div",{className:"relative w-full h-3 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-primary-500 to-purple-500 rounded-full transition-all duration-500 shadow-sm",style:{width:`${Y?Math.min(s.tokens/Y.tokens*100,100):0}%`}})}),e.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:[Y?(s.tokens/Y.tokens*100).toFixed(1):"0.0","% of plan limit used"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Plan:"}),e.jsx("p",{className:"font-semibold text-primary-800 capitalize",children:s.plan})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Max Brands:"}),e.jsx("p",{className:"font-semibold text-primary-800",children:(Y==null?void 0:Y.max_brands)===-1?"Unlimited":(Y==null?void 0:Y.max_brands)||1})]}),s.plan_expiry&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Expires:"}),e.jsx("p",{className:"font-semibold text-primary-800",children:new Date(s.plan_expiry).toLocaleDateString()})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-3",children:[e.jsxs(w,{onClick:()=>F("/dashboard/tokens"),className:"flex items-center justify-center",size:"sm",children:[e.jsx(Os,{size:16,className:"mr-2"}),"Buy More Tokens"]}),s.plan==="free"&&e.jsx("div",{className:"flex-1 p-3 glass-effect border border-accent-500/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-accent-300",children:"Upgrade to unlock more brands, higher token limits, and advanced features!"})})]}),e.jsxs("p",{className:"mt-3 text-xs text-slate-500",children:["Pricing defaults to ",A==="USD"?"US Dollars ($)":"Nigerian Naira (â‚¦)",". Current exchange rate: â‚¦",Me.toLocaleString()," â‰ˆ $1."]})]}),e.jsxs("div",{className:"glass-effect p-6 rounded-lg border border-primary-500/20",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Pe,{className:"w-5 h-5 text-primary-400"}),e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"Preferences"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-600 mb-2 block",children:"Timezone"}),e.jsx("select",{value:s.timezone||"Africa/Lagos",onChange:b=>k==null?void 0:k(b.target.value),className:"w-full bg-white/80 text-primary-900 p-3 rounded-lg border border-primary-200 focus:border-primary-400 outline-none transition-colors",children:wt.map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-600",children:"AI Provider Override"}),e.jsx("span",{className:"text-xs text-slate-500 italic",children:"Optional"})]}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Andora intelligently selects the best model for each task. You can override this for specific fields."}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:["gemini","openai","claude","deepseek"].map(b=>e.jsx("button",{onClick:()=>o(b),className:`p-4 border-2 rounded-lg transition-all duration-300 glass-effect ${s.preferred_ai_provider===b?"border-primary-500 bg-primary-500/10":"border-primary-200 hover:border-primary-400"}`,children:e.jsx("div",{className:"text-left",children:e.jsx("h4",{className:"font-semibold text-primary-800 capitalize",children:b==="gemini"?"Gemini (FREE)":b})})},b))}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm font-medium text-slate-600 mb-2 block",children:"AI Model Override"}),e.jsx("select",{value:s.preferred_ai_model,onChange:b=>N(b.target.value),className:"w-full bg-white/80 text-primary-900 p-3 rounded-lg border border-primary-200 focus:border-primary-400 outline-none transition-colors",children:x.filter(b=>b.provider===s.preferred_ai_provider).map(b=>e.jsx("option",{value:b.id,children:b.name},b.id))}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Select your default model. This will be used for AI content generation when available."})]})]})]})]}),he&&e.jsxs("div",{className:"glass-effect p-6 rounded-lg border border-primary-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ns,{className:"w-5 h-5 text-primary-400"}),e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"Team Access"})]}),e.jsxs("span",{className:"text-xs text-slate-500",children:[L.length," member",L.length===1?"":"s"]})]}),e.jsxs("div",{className:"space-y-4",children:[L.length?L.map(b=>e.jsxs("div",{className:"glass-effect border border-primary-500/20 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h4",{className:"font-semibold text-primary-900",children:b.name}),b.is_admin&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-orange-100 text-orange-800 border border-orange-300",children:[e.jsx(ut,{size:12,className:"mr-1"}),"Admin"]}),!b.invite_accepted&&b.invite_token&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-yellow-100 text-yellow-800 border border-yellow-300",children:"Pending"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:b.email}),e.jsxs("p",{className:"text-xs text-primary-300 mt-1",children:["Role: ",b.role]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-start",children:[b.invite_token&&!b.invite_accepted&&e.jsx(w,{variant:"outline",size:"sm",onClick:()=>We(b),className:"flex items-center text-primary-600 hover:text-primary-700",children:pe===b.id?e.jsxs(e.Fragment,{children:[e.jsx(hs,{size:14,className:"mr-1"})," Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Sa,{size:14,className:"mr-1"})," Copy invite link"]})}),e.jsxs(w,{variant:"ghost",size:"sm",onClick:()=>Re(b.id),className:"text-red-400 flex items-center disabled:opacity-50 disabled:cursor-not-allowed",disabled:!m,children:[e.jsx(Us,{size:14,className:"mr-1"})," Remove"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-orange-50/30 border border-orange-100",children:[e.jsx("input",{type:"checkbox",id:`admin-toggle-${b.id}`,checked:b.is_admin||!1,onChange:()=>rs(b.id),disabled:!m,className:"w-4 h-4 text-orange-600 border-orange-300 rounded focus:ring-orange-500"}),e.jsxs("label",{htmlFor:`admin-toggle-${b.id}`,className:"flex-1 cursor-pointer",children:[e.jsx("div",{className:"text-xs font-medium text-orange-900",children:"Admin Access"}),e.jsx("div",{className:"text-xs text-orange-600",children:"Can use your tokens and add team members"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:_e.map(oe=>{var v;const ce=((v=b.permissions)==null?void 0:v[oe])||"none",ve=["none","view","edit"];return e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:Se[oe]}),e.jsx("div",{className:"flex items-center gap-1",children:ve.map(O=>e.jsx("button",{onClick:()=>Je(b.id,oe,O),className:`px-2 py-1 rounded-md text-xs border transition-colors ${ce===O?"border-primary-400 bg-primary-500/20 text-primary-100":"border-primary-200 text-slate-500 hover:border-primary-300"}`,disabled:!m,children:O==="none"?"None":O==="view"?"View":"Edit"},O))})]},`${b.id}-${oe}`)})}),e.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:_e.some(oe=>{var ce;return(((ce=b.permissions)==null?void 0:ce[oe])||"none")!=="none"})?_e.map(oe=>{var ve;const ce=((ve=b.permissions)==null?void 0:ve[oe])||"none";return ce==="none"?null:e.jsxs("span",{className:"px-2 py-1 text-xs rounded-full bg-primary-500/15 text-primary-200 border border-primary-500/30",children:[Se[oe]," â€¢ ",ce==="edit"?"edit":"view"]},`${b.id}-${oe}-badge`)}):e.jsx("span",{className:"text-xs text-slate-500",children:"No sections assigned yet."})})]},b.id)):e.jsx("div",{className:"glass-effect border border-primary-500/20 rounded-lg p-6 text-sm text-slate-500",children:"Invite teammates to collaborate on configuration, planning, and approvals."}),e.jsxs("div",{className:"border-t border-primary-500/10 pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-primary-900 mb-3",children:"Invite teammate"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(cs,{placeholder:"Collaborator email",value:ye,onChange:b=>f(b.target.value)}),e.jsxs(w,{size:"sm",className:"flex items-center",onClick:is,disabled:!m||!ye.trim(),children:[e.jsx(Pe,{size:16,className:"mr-1"})," Assign sections"]})]}),me&&e.jsxs("div",{className:"glass-effect border border-primary-500/20 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold",children:"Collaborator"}),e.jsx("p",{className:"text-sm font-medium text-primary-900",children:ye})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(cs,{placeholder:"Name (optional)",value:Q,onChange:b=>H(b.target.value)}),e.jsx(cs,{placeholder:"Role",value:ee,onChange:b=>q(b.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-orange-50/50 border border-orange-200",children:[e.jsx("input",{type:"checkbox",id:"admin-toggle",checked:ue,onChange:b=>ke(b.target.checked),className:"w-4 h-4 text-orange-600 border-orange-300 rounded focus:ring-orange-500"}),e.jsxs("label",{htmlFor:"admin-toggle",className:"flex-1 cursor-pointer",children:[e.jsx("div",{className:"text-sm font-semibold text-orange-900",children:"Make Admin"}),e.jsx("div",{className:"text-xs text-orange-700",children:"Can use your tokens and add other team members"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Assign sections"}),e.jsx("button",{type:"button",onClick:Ze,className:"text-xs px-2 py-1 rounded-md border border-primary-300 text-primary-600 hover:border-primary-400",disabled:!m,children:"Events only shortcut"})]}),se&&e.jsx("div",{className:"p-2 rounded-md bg-red-500/10 border border-red-400/40 text-xs text-red-300",children:se}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:_e.map(b=>{const oe=C[b],ce=["none","view","edit"];return e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:Se[b]}),e.jsx("div",{className:"flex items-center gap-1",children:ce.map(ve=>e.jsx("button",{onClick:()=>Fe(b,ve),className:`px-2 py-1 rounded-md text-xs border transition-colors ${oe===ve?"border-primary-400 bg-primary-500/20 text-primary-100":"border-primary-200 text-slate-500 hover:border-primary-300"}`,disabled:!m,children:ve==="none"?"None":ve==="view"?"View":"Edit"},ve))})]},`pending-${b}`)})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:Be,children:"Cancel"}),e.jsxs(w,{size:"sm",className:"flex items-center",onClick:Ye,disabled:!m,children:[e.jsx(Fs,{size:16,className:"mr-1"})," Send invite"]})]})]})]})]})]})]}),e.jsxs("div",{className:"glass-effect p-6 rounded-lg border border-primary-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"Brand Management"}),Oe&&e.jsxs(w,{size:"sm",onClick:()=>S(!0),className:"flex items-center",children:[e.jsx(Fs,{size:16,className:"mr-1"}),"New Brand"]})]}),E&&e.jsxs("div",{className:"mb-4 p-4 glass-effect rounded-lg",children:[te&&e.jsx("div",{className:"mb-3 p-2 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsx("p",{className:"text-red-400 text-sm",children:te})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(cs,{placeholder:"Enter brand name",value:T,onChange:b=>_(b.target.value),onKeyDown:b=>b.key==="Enter"&&!D&&Ae(),className:"flex-1",disabled:D}),e.jsx(w,{onClick:Ae,size:"sm",disabled:D,children:D?"Creating...":"Create"}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{S(!1),_(""),re(null)},disabled:D,children:"Cancel"})]})]}),Ce.length>0&&e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx(w,{onClick:()=>U(!V),variant:"outline",size:"sm",className:"text-xs",children:V?"Show Active":`Show Archived (${Ce.length})`})}),e.jsx("div",{className:"space-y-2",children:Z.map(b=>e.jsx("div",{className:`p-3 border rounded-lg transition-all duration-200 ${b.brand_id===r?"border-primary-500 bg-primary-500/10":"border-primary-200 hover:border-primary-500/50"} ${b.archived_at?"opacity-60":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>!b.archived_at&&c(b.brand_id),children:[e.jsxs("h4",{className:"font-medium text-primary-800",children:[b.brand_name,b.archived_at&&e.jsx("span",{className:"ml-2 text-xs text-slate-500 italic",children:"(Archived)"})]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[b.channels.length," channels â€¢ ",b.posting_frequency,"x/week"]})]}),e.jsx("div",{className:"flex items-center gap-2 ml-3",children:b.archived_at?e.jsx("button",{onClick:oe=>Ge(b.brand_id,oe),disabled:le===b.brand_id,className:"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors disabled:opacity-50",title:"Restore brand",children:e.jsx(Aa,{size:16})}):e.jsx("button",{onClick:oe=>ze(b.brand_id,oe),disabled:le===b.brand_id,className:"p-1.5 text-slate-500 hover:bg-slate-100 rounded transition-colors disabled:opacity-50",title:"Archive brand",children:e.jsx(Ta,{size:16})})})]})},b.brand_id))}),!Oe&&e.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["You've reached the maximum number of brands for your plan.",s.plan==="free"&&" Upgrade to manage more brands!"]})]}),e.jsx("div",{className:"glass-effect p-6 rounded-lg border border-red-500/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"Account"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Sign out of your Andora account"})]}),e.jsxs(w,{onClick:i,variant:"danger",className:"flex items-center",children:[e.jsx(Pa,{size:16,className:"mr-2"}),"Sign Out"]})]})})]})},jn=Object.freeze(Object.defineProperty({__proto__:null,SettingsPage:cr},Symbol.toStringTag,{value:"Module"})),dr=({user:s,pricingPlans:l,currency:r,exchangeRate:c})=>{const u=ws(),o=l.length>0?l:st,N=c>0?c:tt,k=(s==null?void 0:s.plan)||"free",x=g=>{if(g.price_ngn===0)return"Free";const m=`â‚¦${g.price_ngn.toLocaleString()}`,j=g.price_usd>0?`$${g.price_usd.toLocaleString()}`:`$${Math.max(1,Math.round(g.price_ngn/N)).toLocaleString()}`;return r==="USD"?`${j} (â‰ˆ ${m})`:`${m} (â‰ˆ ${j})`},i=g=>{const m=x(g),j=encodeURIComponent(`Hi! I'd like to purchase the ${g.name} plan for ${m} (${g.tokens.toLocaleString()} tokens). Please let me know how to proceed with payment.`);window.open(`https://wa.me/?text=${j}`,"_blank")},d=g=>g.toLocaleString(),A=g=>g===-1?"Unlimited":g.toString();return e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("button",{onClick:()=>u("/dashboard/settings"),className:"flex items-center text-slate-600 hover:text-slate-900 mb-6 transition-colors",children:[e.jsx(Ss,{size:20,className:"mr-2"}),"Back to Settings"]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-900 mb-2",children:"Buy More Tokens"}),e.jsx("p",{className:"text-slate-600 mb-4",children:"Select a plan to upgrade your account. All purchases are processed via WhatsApp."}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Prices shown in ",r==="USD"?"US Dollars":"Nigerian Naira"," using an exchange rate of"," ","â‚¦",N.toLocaleString()," â‰ˆ $1."]}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-accent-300 mt-2",children:[e.jsx($a,{size:16}),e.jsx("span",{children:"Secure payment via WhatsApp"})]})]}),s&&e.jsxs("div",{className:"max-w-md mx-auto mb-8 neural-glow p-6 rounded-lg border border-primary-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Current Balance"}),e.jsxs("p",{className:"text-2xl font-bold text-primary-800",children:[s.tokens," tokens"]})]}),e.jsx(Os,{size:32,className:"text-primary-400"})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Plan: ",e.jsx("span",{className:"font-semibold capitalize",children:s.plan})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(g=>{const m=g.id===k,j=g.is_popular||g.id==="pro";return e.jsxs("div",{className:`relative glass-effect rounded-lg p-6 border-2 transition-all duration-300 ${m?"border-green-500/50 bg-green-500/10":j?"border-primary-500/50 bg-primary-500/10":"border-primary-200/60 hover:border-primary-400/50"}`,children:[j&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-purple-600 text-white px-3 py-1 rounded-full text-xs font-medium",children:"Most Popular"})}),m&&e.jsx("div",{className:"absolute -top-3 right-3",children:e.jsx("div",{className:"bg-green-500 text-white p-1 rounded-full",children:e.jsx(hs,{size:12})})}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(ut,{className:"w-6 h-6 text-accent-400 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-primary-900 capitalize",children:g.name})]}),e.jsx("div",{className:"text-lg font-bold text-primary-300 mb-1",children:x(g)}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-slate-500",children:[e.jsx(Os,{size:14,className:"text-primary-400"}),e.jsxs("span",{children:[d(g.tokens)," tokens"]})]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Max brands: ",A(g.max_brands)]})]}),e.jsx("div",{className:"space-y-2 mb-6",children:g.features.map((t,F)=>e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(hs,{size:14,className:"text-green-400 flex-shrink-0"}),e.jsx("span",{className:"text-slate-600",children:t})]},F))}),e.jsx(w,{onClick:()=>i(g),disabled:m,className:`w-full ${m?"bg-green-600 hover:bg-green-600 cursor-not-allowed":""}`,variant:m?"secondary":"primary",children:m?"Current Plan":`Buy ${g.name}`})]},g.id)})}),e.jsx("div",{className:"text-center text-sm text-slate-500 mt-8",children:e.jsx("p",{children:`After clicking "Buy", you'll be redirected to WhatsApp to complete your purchase. Your account will be upgraded once payment is confirmed.`})})]})},vn=Object.freeze(Object.defineProperty({__proto__:null,TokensPage:dr},Symbol.toStringTag,{value:"Module"})),mr=s=>{if(!s||s.trim().length===0)return!1;try{const l=JSON.parse(s);return Array.isArray(l)}catch(l){return!1}},Ft=s=>{if(!s)return[{name:"",description:""}];if(mr(s))try{const l=JSON.parse(s);return l.length>0?l:[{name:"",description:""}]}catch(l){return[{name:"",description:""}]}return[{name:"",description:s}]},dt=s=>{const l=s.filter(r=>r.name.trim()||r.description.trim());return l.length===0?"":JSON.stringify(l)},xr=({value:s,onChange:l,placeholder:r})=>{const[c,u]=n.useState(()=>Ft(s)),[o,N]=n.useState(0);n.useEffect(()=>{u(Ft(s))},[s]);const k=(m,j,t)=>{const F=[...c];F[m]=R(I({},F[m]),{[j]:t}),u(F),l(dt(F))},x=()=>{const m=[...c,{name:"",description:""}];u(m),N(m.length-1),l(dt(m))},i=m=>{if(c.length===1){u([{name:"",description:""}]),N(0),l("");return}const j=c.filter((t,F)=>F!==m);u(j),o>=j.length&&N(j.length-1),l(dt(j))},d=()=>{N(m=>Math.max(0,m-1))},A=()=>{N(m=>Math.min(c.length-1,m+1))},g=c[o]||{name:"",description:""};return e.jsxs("div",{className:"space-y-4",children:[c.length>1&&e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 rounded-lg p-3 border border-slate-200",children:[e.jsx("button",{type:"button",onClick:d,disabled:o===0,className:`p-2 rounded-lg transition-colors ${o===0?"text-slate-300 cursor-not-allowed":"text-slate-700 hover:bg-white hover:shadow-sm"}`,title:"Previous product",children:e.jsx(us,{size:18})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:["Product ",o+1," of ",c.length]})}),e.jsx("button",{type:"button",onClick:A,disabled:o===c.length-1,className:`p-2 rounded-lg transition-colors ${o===c.length-1?"text-slate-300 cursor-not-allowed":"text-slate-700 hover:bg-white hover:shadow-sm"}`,title:"Next product",children:e.jsx(Qe,{size:18})})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-gradient-to-br from-orange-50/50 via-pink-50/50 to-purple-50/50 border-2 border-orange-200/50 rounded-xl",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Product/Service Name"}),e.jsx(cs,{value:g.name,onChange:m=>k(o,"name",m.target.value),placeholder:"e.g., Premium Coaching, Software Subscription, Consulting Services",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description"}),e.jsx(Ie,{value:g.description,onChange:m=>k(o,"description",m.target.value),placeholder:"Describe what this product/service offers, key benefits, pricing, target market, etc.",rows:4,className:"w-full"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-2 border-t border-orange-200/50",children:[e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:x,className:"flex items-center gap-2",children:[e.jsx(Fs,{size:14}),"Add Product"]}),c.length>1&&e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:()=>i(o),className:"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(Us,{size:14}),"Remove"]})]})]}),c.length>1&&e.jsx("div",{className:"flex items-center justify-center gap-2",children:c.map((m,j)=>e.jsx("button",{type:"button",onClick:()=>N(j),className:`w-2 h-2 rounded-full transition-all ${j===o?"bg-primary-600 w-6":"bg-slate-300 hover:bg-slate-400"}`,title:`Go to product ${j+1}`},j))})]})},Lt=s=>{if(!s||s.trim().length===0)return!1;const l=["PRODUCT","NAME","Age","Occupation","Interests","Casual Interests","Character","Aspirations","Problems"],r=s.split(`
`);let c=0;for(const u of r){const o=u.trim();l.some(N=>o.toLowerCase().startsWith(N.toLowerCase()))&&c++}return c>=3},Rt=s=>{var c,u,o,N,k,x,i,d,A;if(!s)return{};const l={},r=s.split(`
`);for(const g of r){const m=g.trim();m.toUpperCase().startsWith("PRODUCT")?l.product=((c=m.split(":")[1])==null?void 0:c.trim())||"":m.toUpperCase().startsWith("NAME")?l.name=((u=m.split(":")[1])==null?void 0:u.trim())||"":m.toLowerCase().startsWith("age")?l.age=((o=m.split(":")[1])==null?void 0:o.trim())||"":m.toLowerCase().startsWith("occupation")?l.occupation=((N=m.split(":")[1])==null?void 0:N.trim())||"":m.toLowerCase().startsWith("interests")?l.interests=((k=m.split(":")[1])==null?void 0:k.trim())||"":m.toLowerCase().startsWith("casual interests")?l.casual_interests=((x=m.split(":")[1])==null?void 0:x.trim())||"":m.toLowerCase().startsWith("character")||m.toLowerCase().startsWith("character & lifestyle")?l.character_lifestyle=((i=m.split(":")[1])==null?void 0:i.trim())||"":m.toLowerCase().startsWith("aspirations")?l.aspirations=((d=m.split(":")[1])==null?void 0:d.trim())||"":m.toLowerCase().startsWith("problems")&&(l.problems=((A=m.split(":")[1])==null?void 0:A.trim())||"")}return l},Bt=s=>{const l=[];return s.product&&l.push(`PRODUCT : ${s.product}`),s.name&&l.push(`NAME : ${s.name}`),s.age&&l.push(`Age : ${s.age}`),s.occupation&&l.push(`Occupation : ${s.occupation}`),s.interests&&l.push(`Interests : ${s.interests}`),s.casual_interests&&l.push(`Casual Interests : ${s.casual_interests}`),s.character_lifestyle&&l.push(`Character & Lifestyle : ${s.character_lifestyle}`),s.aspirations&&l.push(`Aspirations : ${s.aspirations}`),s.problems&&l.push(`Problems : ${s.problems}`),l.join(`
`)},hr=({value:s,onChange:l,placeholder:r})=>{const[c,u]=n.useState(()=>Rt(s)),[o,N]=n.useState(()=>Lt(s)),[k,x]=n.useState(!1);n.useEffect(()=>{if(!k){const g=Lt(s);N(g)}u(Rt(s))},[s,k]);const i=(g,m)=>{const j=R(I({},c),{[g]:m});u(j),l(Bt(j))},d=()=>{N(!0),x(!0)},A=()=>{N(!1),x(!0)};return o?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-700",children:"Structured Buyer Persona"}),e.jsx("button",{type:"button",onClick:A,className:"text-xs text-primary-600 hover:text-primary-700",children:"Switch to Free-form"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"PRODUCT"}),e.jsx("input",{type:"text",value:c.product||"",onChange:g=>i("product",g.target.value),placeholder:"e.g., Lands & Properties",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"NAME"}),e.jsx("input",{type:"text",value:c.name||"",onChange:g=>i("name",g.target.value),placeholder:"e.g., Chinedu Godwin",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Age"}),e.jsx("input",{type:"text",value:c.age||"",onChange:g=>i("age",g.target.value),placeholder:"e.g., 31",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Occupation"}),e.jsx("input",{type:"text",value:c.occupation||"",onChange:g=>i("occupation",g.target.value),placeholder:"e.g., Investor",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Interests"}),e.jsx(Ie,{value:c.interests||"",onChange:g=>i("interests",g.target.value),placeholder:"e.g., Forex / Market Trade, Flexing, Cars, VIP Treatments",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Casual Interests"}),e.jsx(Ie,{value:c.casual_interests||"",onChange:g=>i("casual_interests",g.target.value),placeholder:"e.g., Premium food, Pizza, Women, Telegram",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Character & Lifestyle"}),e.jsx(Ie,{value:c.character_lifestyle||"",onChange:g=>i("character_lifestyle",g.target.value),placeholder:"e.g., Flamboyant, Works from Home, Luxury",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Aspirations"}),e.jsx(Ie,{value:c.aspirations||"",onChange:g=>i("aspirations",g.target.value),placeholder:"e.g., Body goals, achieving a social status",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Problems"}),e.jsx(Ie,{value:c.problems||"",onChange:g=>i("problems",g.target.value),placeholder:"e.g., Liquidity risk, inflation, Fear per investment",rows:2})]}),e.jsxs("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-xs font-medium text-slate-700 mb-2",children:"Preview"}),e.jsx("pre",{className:"text-xs text-slate-600 whitespace-pre-wrap font-mono",children:Bt(c)||"Fill in the fields above to see the formatted buyer persona"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-xs text-slate-600",children:"Free-form mode"}),e.jsx("button",{type:"button",onClick:d,className:"text-xs text-primary-600 hover:text-primary-700",children:"Switch to Structured Mode"})]}),e.jsx(Ie,{value:s,onChange:g=>l(g.target.value),placeholder:r,rows:10})]})},pr=s=>{if(!s||s.trim().length===0)return!1;try{const l=JSON.parse(s);return Array.isArray(l)}catch(l){return!1}},Wt=(s,l)=>{const r=c=>{const u=Math.max(1,l);if(c.length>=u)return c;const o=Array.from({length:u-c.length},(N,k)=>({name:`Audience ${c.length+k+1}`,profile:""}));return[...c,...o]};if(!s)return r([]);if(pr(s))try{const c=JSON.parse(s);if(Array.isArray(c))return r(c)}catch(c){}return r([{name:"Primary Audience",profile:s}])},Js=s=>{const l=s.filter(r=>r.profile.trim());return l.length===0?"":JSON.stringify(l)},Ut=({value:s,products:l=[],onChange:r,onAISuggest:c,isGeneratingAI:u=!1,placeholder:o})=>{const[N,k]=n.useState(()=>Wt(s,l.length)),[x,i]=n.useState(0);n.useEffect(()=>{const E=Wt(s,l.length);k(E)},[s,l.length]);const d=(E,S)=>{const D=[...N];D[E]=R(I({},D[E]),{profile:S}),k(D),r(Js(D))},A=(E,S)=>{const D=[...N];D[E]=R(I({},D[E]),{name:S}),k(D),r(Js(D))},g=()=>{const E=[...N,{name:`Audience ${N.length+1}`,profile:""}];k(E),i(E.length-1),r(Js(E))},m=E=>{if(N.length===1){k([{name:"Primary Audience",profile:""}]),i(0),r("");return}const S=N.filter((D,G)=>G!==E);k(S),x>=S.length&&i(S.length-1),r(Js(S))},j=()=>{i(E=>Math.max(0,E-1))},t=()=>{i(E=>Math.min(N.length-1,E+1))},F=()=>{c&&c(x)},T=N[x]||{name:"Audience 1",profile:""},_=l[x];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-3 border-2 border-blue-200",children:[e.jsx("button",{type:"button",onClick:j,disabled:x===0||N.length===1,className:`p-2 rounded-lg transition-colors ${x===0||N.length===1?"text-slate-300 cursor-not-allowed":"text-slate-700 hover:bg-white hover:shadow-sm"}`,title:"Previous audience",children:e.jsx(us,{size:18})}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:T.name||`Audience ${x+1}`}),e.jsxs("span",{className:"text-xs text-slate-600",children:[N.length>1?`${x+1} of ${N.length}`:"1 audience",_&&_.name&&` â€¢ for ${_.name}`]})]}),e.jsx("button",{type:"button",onClick:t,disabled:x===N.length-1||N.length===1,className:`p-2 rounded-lg transition-colors ${x===N.length-1||N.length===1?"text-slate-300 cursor-not-allowed":"text-slate-700 hover:bg-white hover:shadow-sm"}`,title:"Next audience",children:e.jsx(Qe,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Audience Segment Name"}),e.jsx("input",{type:"text",value:T.name,onChange:E=>A(x,E.target.value),placeholder:"e.g., Early Adopters, Enterprise Clients, Small Business Owners",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),c&&e.jsxs("button",{type:"button",onClick:F,disabled:u,className:"flex items-center gap-2 text-sm text-primary-600 hover:text-primary-700 disabled:opacity-50 mt-6",children:[e.jsx(Pe,{size:14}),u?"Generating...":"AI Suggest"]})]}),_&&_.name&&e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"text-xs font-medium text-blue-900 mb-1",children:["ðŸŽ¯ Targeting for: ",_.name]}),e.jsx("div",{className:"text-xs text-blue-700",children:_.description})]}),e.jsx("div",{className:"min-w-0",children:e.jsx(hr,{value:T.profile,onChange:E=>d(x,E),placeholder:o||"Describe this audience segment - who they are, what they need, what they care about."})}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-3",children:[e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:g,className:"flex items-center gap-2 bg-gradient-to-r from-blue-50 to-purple-50 border-blue-300 hover:from-blue-100 hover:to-purple-100 text-blue-700 font-medium",children:[e.jsx(Fs,{size:16}),"Add Another Audience"]}),N.length>1&&e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:()=>m(x),className:"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:[e.jsx(Us,{size:14}),"Remove This Audience"]})]}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:N.map((E,S)=>e.jsx("button",{type:"button",onClick:()=>i(S),className:`transition-all ${S===x?"bg-primary-600 w-8 h-2 rounded-full":"bg-slate-300 hover:bg-slate-400 w-2 h-2 rounded-full"}`,title:`${E.name||`Audience ${S+1}`}`},S))}),e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("div",{className:"text-xs text-blue-900 text-center",children:x===0?e.jsxs("span",{children:["â­ ",e.jsx("strong",{children:"Key Audience"})," - Used for Character Studio and default content targeting"]}):e.jsxs("span",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"Alternate Audience"})," - Available for targeted content briefs"]})})})]})};function lt(s,l){let r=null;return function(...u){const o=()=>{r=null,s(...u)};r&&clearTimeout(r),r=setTimeout(o,l)}}const ur=[{key:"monday",label:"Monday"},{key:"tuesday",label:"Tuesday"},{key:"wednesday",label:"Wednesday"},{key:"thursday",label:"Thursday"},{key:"friday",label:"Friday"},{key:"saturday",label:"Saturday"},{key:"sunday",label:"Sunday"}],gr={LinkedIn:"bg-blue-500 hover:bg-blue-600",Instagram:"bg-pink-500 hover:bg-pink-600",X:"bg-cyan-500 hover:bg-cyan-600",Facebook:"bg-indigo-500 hover:bg-indigo-600",TikTok:"bg-purple-500 hover:bg-purple-600",YouTube:"bg-red-500 hover:bg-red-600",Blog:"bg-slate-500 hover:bg-slate-600",Email:"bg-green-500 hover:bg-green-600"},fr=({brand:s,onUpdate:l})=>{const[r,c]=n.useState({}),[u,o]=n.useState(!1),[N,k]=n.useState(!1);n.useEffect(()=>{console.log("ðŸ“… ChannelScheduler: Initializing with schedule:",s.channel_schedule),c(s.channel_schedule||{})},[s.channel_schedule]);const x=n.useRef(lt(m=>{console.log("ðŸ’¾ ChannelScheduler: Auto-saving schedule:",m),l(m),o(!1)},1e3)).current,i=n.useCallback((m,j)=>{c(t=>{const F=t[m]||[],T=F.includes(j)?F.filter(E=>E!==j):[...F,j],_=R(I({},t),{[m]:T});return o(!0),x(_),_})},[x]),d=(m,j)=>{var t;return((t=r[m])==null?void 0:t.includes(j))||!1},A=m=>gr[m]||"bg-slate-500 hover:bg-slate-600",g=()=>ie(void 0,null,function*(){k(!0);try{const m={brandName:s.brand_name,tagline:s.taglines,about:s.about,vision:s.vision,mission:s.mission,persona:s.persona,buyerProfile:s.buyer_profile,products:s.products,channels:s.channels},j=yield fetch("https://andorabrand.me/api/ai/generate-content-strategy",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({brandContext:m})});if(!j.ok){const F=yield j.json();throw new Error(F.error||"Failed to generate suggestion")}const t=yield j.json();if(t.success&&t.strategy){const F=Math.min(t.strategy.frequency||5,7),T=t.strategy.channels||s.channels,_={},E=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];T.forEach((D,G)=>{const te=G%E.length;for(let re=0;re<F;re++){const V=Math.floor(7/F),U=(te+re*V)%E.length,le=E[U];_[le]||(_[le]=[]),_[le].includes(D)||_[le].push(D)}});const S=E.filter(D=>!_[D]||_[D].length===0);S.length>0&&T.length>0&&S.forEach((D,G)=>{const te=T[G%T.length];_[D]||(_[D]=[]),_[D].includes(te)||_[D].push(te)}),c(_),l(_)}}catch(m){console.error("AI suggestion error:",m),alert("Failed to generate schedule suggestion. Please try again.")}finally{k(!1)}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Channel Posting Schedule"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Configure which channels post on which days of the week"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[u&&e.jsxs("span",{className:"text-xs text-slate-500 flex items-center",children:[e.jsx("div",{className:"w-3 h-3 border border-primary-500 border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}),e.jsxs("button",{onClick:g,disabled:N||s.channels.length===0,className:"flex items-center text-xs text-primary-600 hover:text-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Pe,{size:14,className:"mr-1"}),N?"I'm thinking...":"Ask me for a suggestion"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.channels.map(m=>e.jsx("span",{className:`px-3 py-1.5 rounded-lg text-white text-sm font-medium ${A(m)}`,children:m},m))}),e.jsx("div",{className:"glass-effect rounded-xl border border-slate-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"text-left p-4 text-sm font-semibold text-slate-700",children:"Day"}),s.channels.map(m=>e.jsx("th",{className:"text-center p-4 text-sm font-semibold text-slate-700",children:m},m))]})}),e.jsx("tbody",{children:ur.map(m=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50/50 transition-colors",children:[e.jsx("td",{className:"p-4 font-medium text-slate-900",children:m.label}),s.channels.map(j=>{const t=d(m.key,j);return e.jsx("td",{className:"p-4 text-center",children:e.jsx("button",{onClick:()=>i(m.key,j),className:`w-10 h-10 rounded-lg transition-all duration-200 flex items-center justify-center ${t?`${A(j)} text-white shadow-md`:"bg-slate-100 hover:bg-slate-200 text-slate-400"}`,title:`${t?"Remove":"Add"} ${j} on ${m.label}`,children:t&&e.jsx(hs,{size:20})})},j)})]},m.key))})]})})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-900",children:[e.jsx("strong",{children:"ðŸ’¡ Tip:"})," When generating calendar content, Andora will only create posts for channels scheduled on each specific day. Leave days unchecked if you don't want posts on that day."]})})]})},Es=({id:s,title:l,description:r,icon:c,children:u})=>e.jsx("section",{id:s,className:"relative overflow-hidden rounded-xl sm:rounded-2xl border border-slate-200/80 bg-white/80 backdrop-blur-sm shadow-sm min-w-0",children:e.jsxs("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8 py-4 sm:py-5 lg:py-6 space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0",children:[c&&e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg sm:rounded-xl bg-primary-500/10 text-primary-600 flex items-center justify-center shrink-0",children:c}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-base sm:text-lg lg:text-xl font-semibold text-slate-900 break-words",children:l}),r&&e.jsx("p",{className:"text-xs sm:text-sm text-slate-500 mt-1 leading-relaxed break-words",children:r})]})]}),e.jsx("div",{className:"space-y-4 sm:space-y-5 min-w-0",children:u})]})}),br=({brand:s,onBrandUpdate:l})=>{if(!s)return e.jsx(la,{title:"Create Your Brand Profile",description:"Tell us about your brand - your vision, mission, and personality. This helps Andora understand your unique voice and create authentic content."});const[r,c]=n.useState(s),[u,o]=n.useState(!1),[N,k]=n.useState(!1),[x,i]=n.useState({}),[d,A]=n.useState([]),g=n.useRef(!1),m=ws(),{authUser:j,isAdmin:t}=Is(),F=n.useRef(null),T=t,_=n.useMemo(()=>{var f,ee,q,ue,ke,ge,Ce,Z;return[{label:"Brand name",complete:!!((f=r.brand_name)!=null&&f.trim())},{label:"Tagline",complete:!!((ee=r.taglines)!=null&&ee.trim())},{label:"About",complete:!!((q=r.about)!=null&&q.trim())},{label:"Vision",complete:!!((ue=r.vision)!=null&&ue.trim())},{label:"Mission",complete:!!((ke=r.mission)!=null&&ke.trim())},{label:"Voice",complete:!!((ge=r.persona)!=null&&ge.trim())},{label:"Audience",complete:!!((Ce=r.buyer_profile)!=null&&Ce.trim())},{label:"Channels",complete:!!((Z=r.channels)!=null&&Z.length)}]},[r]),E=_.filter(f=>f.complete).length,S=Math.round(E/_.length*100),D=n.useMemo(()=>{var f,ee,q,ue,ke,ge,Ce;return[{id:"identity",label:"Identity",description:"Name, type & promise",complete:!!((f=r.brand_name)!=null&&f.trim()&&((ee=r.taglines)!=null&&ee.trim()))},{id:"story",label:"Story",description:"Vision & mission clarity",complete:!!((q=r.vision)!=null&&q.trim()&&((ue=r.mission)!=null&&ue.trim()))},{id:"voice",label:"Voice",description:"Tone & persona defined",complete:!!((ke=r.persona)!=null&&ke.trim())},{id:"audience-insights",label:"Audience",description:"Buyer clarity captured",complete:!!((ge=r.buyer_profile)!=null&&ge.trim())},{id:"channels",label:"Distribution",description:"Channels & cadence selected",complete:!!((Ce=r.channels)!=null&&Ce.length)}]},[r]),G=n.useMemo(()=>[{label:"Vision snapshot",value:r.vision||"Give us your future headline.",icon:e.jsx(gt,{className:"w-4 h-4"})},{label:"Voice cues",value:r.persona||"Describe how you speak to your people.",icon:e.jsx(It,{className:"w-4 h-4"})},{label:"Primary audience",value:r.buyer_profile||"Sketch the humans you serve.",icon:e.jsx(zt,{className:"w-4 h-4"})}],[r.buyer_profile,r.persona,r.vision]);n.useEffect(()=>{r.reverse_positioning&&F.current&&setTimeout(()=>{var f;(f=F.current)==null||f.scrollIntoView({behavior:"smooth",block:"center"})},300)},[r.reverse_positioning]);const te=n.useRef(0);n.useEffect(()=>{Date.now()-te.current<2e3||c(s)},[s]);const re=n.useRef(s.id);n.useEffect(()=>{re.current!==s.id&&(te.current=0,g.current=!1,re.current=s.id)},[s.id]);const V=n.useRef(lt(f=>{console.log("ðŸ’¾ Saving brand updates:",f),l(f),o(!1),g.current=!1},1e3)).current,U=n.useCallback((f,ee)=>{te.current=Date.now(),g.current=!0,o(!0),c(q=>R(I({},q),{[f]:ee})),V({[f]:ee})},[V]),le=f=>{const ee=r.channels.includes(f)?r.channels.filter(q=>q!==f):[...r.channels,f];U("channels",ee)},we=f=>{const ee=r.content_types||[],q=ee.includes(f)?ee.filter(ue=>ue!==f):[...ee,f];U("content_types",q)},he=(f,ee="success")=>{const q=Date.now().toString();A(ue=>[...ue,{id:q,message:f,type:ee}]),setTimeout(()=>{A(ue=>ue.filter(ke=>ke.id!==q))},5e3)},L=f=>{U("timezone",f),k(!1)},Q=()=>e.jsxs("div",{ref:r.reverse_positioning?F:null,className:"rounded-xl sm:rounded-2xl border border-primary-200/70 bg-white/80 p-3 sm:p-4 lg:p-6 shadow-sm transition-all min-w-0",children:[r.reverse_positioning&&e.jsx("div",{className:"mb-3 rounded-lg sm:rounded-xl border border-primary-200 bg-primary-50/50 px-3 sm:px-4 py-2 sm:py-3",children:e.jsxs("p",{className:"text-xs sm:text-sm text-primary-900 leading-relaxed break-words",children:[e.jsx("strong",{children:"Step 2: Describe Your Audience"})," â€” Tell me who you're talking to, so I can write like I'm in the room with them."]})}),e.jsx("h2",{className:"text-base sm:text-lg lg:text-xl font-semibold text-primary-900 mb-3 sm:mb-4 break-words",children:r.reverse_positioning?"Who needs what you offer?":"Target Audiences"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"mb-3 p-3 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-slate-700",children:["ðŸ’¡ ",e.jsx("strong",{children:"Multiple Audiences:"})," Create different audience segments for each product/service. The first is your key audience."]})}),e.jsx(Ut,{value:r.buyer_profile||"",products:(()=>{try{return JSON.parse(r.products||"[]")}catch(f){return[]}})(),onChange:f=>U("buyer_profile",f),onAISuggest:f=>ie(void 0,null,function*(){yield ye("buyer_profile",f)}),isGeneratingAI:x.buyer_profile,placeholder:"Fill in the simple prompts to outline this audience segment."})]})]}),H=()=>ie(void 0,null,function*(){if(!T){he("This feature is only available for admin accounts","info");return}const f=`=== BRAND CONFIGURATION ===

Brand Name: ${r.brand_name||""}
Brand Type: ${r.brand_type||"organization"}
Tagline: ${r.taglines||""}

About: ${r.about||""}

Vision: ${r.vision||""}

Mission: ${r.mission||""}

Products/Services: ${r.products||""}

Brand Voice & Personality: ${r.persona||""}

=== AUDIENCE ===

Who Are You Speaking To?
${r.buyer_profile||""}

=== SETTINGS ===

Timezone: ${r.timezone||"UTC"}
Channels: ${(r.channels||[]).join(", ")}
Brand HQ Location: ${r.brand_hq_location||""}
Colors: ${r.colors||""}

=== ADVANCED OPTIONS ===

Audience-First Approach: ${r.reverse_positioning?"Enabled":"Disabled"}

Generated by Andora Brand Config - ${new Date().toLocaleString()}`;try{yield navigator.clipboard.writeText(f),he("âœ¨ All fields copied to clipboard!","success")}catch(ee){console.error("Failed to copy:",ee),he("Failed to copy to clipboard","info")}}),ye=(f,ee)=>ie(void 0,null,function*(){i(q=>R(I({},q),{[f]:!0})),he("I am thinking this through...","info");try{let q="";if(f==="buyer_profile"&&ee!==void 0)try{const Se=JSON.parse(r.products||"[]")[ee];Se&&Se.name&&(q=`Product/Service: ${Se.name}
Description: ${Se.description||""}`)}catch(_e){}const ue={brandName:r.brand_name,brandType:r.brand_type||"organization",tagline:r.taglines,about:r.about,vision:r.vision,mission:r.mission,persona:r.persona,buyerProfile:q||r.buyer_profile,products:r.products},ge={vision:"/ai/generate-vision",mission:"/ai/generate-mission",persona:"/ai/generate-persona",buyer_profile:"/ai/generate-buyer-profile",channels:"/ai/generate-content-strategy"}[f];if(!ge)return;const Ce=yield fetch(`https://andorabrand.me/api${ge}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({brandContext:ue,preferredModel:j==null?void 0:j.preferred_ai_model})});if(!Ce.ok)throw new Error("Failed to generate suggestion");const Z=yield Ce.json();if(Z.success){if(f==="channels"&&Z.strategy)U("channels",Z.strategy.channels),he("âœ¨ I found the perfect channels for you!");else if(f==="vision"&&Z.vision)U("vision",Z.vision),he("Here is a vision statement that captures your future!");else if(f==="mission"&&Z.mission)U("mission",Z.mission),he("Your mission is clear now!");else if(f==="persona"&&Z.persona)U("persona",Z.persona),he("Got it! This is how you sound.","success");else if(f==="buyer_profile"&&Z.buyerProfile){if(console.log("âœ… Buyer profile received:",Z.buyerProfile),ee!==void 0)try{const _e=JSON.parse(r.buyer_profile||"[]");if(Array.isArray(_e)){const Se=[..._e];Se[ee]?Se[ee].profile=Z.buyerProfile:Se[ee]={name:`Audience ${ee+1}`,profile:Z.buyerProfile},U("buyer_profile",JSON.stringify(Se))}else{const Se=[{name:`Audience ${ee+1}`,profile:Z.buyerProfile}];U("buyer_profile",JSON.stringify(Se))}}catch(_e){U("buyer_profile",JSON.stringify([{name:"Primary Audience",profile:Z.buyerProfile}]))}else U("buyer_profile",Z.buyerProfile);he("Perfect! Who you are talking to is clear now.","success")}}}catch(q){console.error("Andora suggestion error:",q),he("Hmm, that did not work. Mind trying again?","info")}finally{i(q=>R(I({},q),{[f]:!1}))}});return e.jsxs("div",{className:"relative min-w-0 overflow-x-hidden",children:[e.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-4 sm:py-6 lg:py-8 space-y-6 sm:space-y-8 lg:space-y-10",children:[e.jsxs("section",{className:"relative overflow-hidden rounded-2xl sm:rounded-3xl border border-primary-500/20 bg-gradient-to-br from-primary-600 via-purple-600 to-slate-900 text-white shadow-xl",children:[e.jsx("div",{className:"absolute inset-0 opacity-40 mix-blend-screen bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.35),transparent_65%)]","aria-hidden":!0}),e.jsx("div",{className:"relative z-10 flex flex-col gap-4 sm:gap-6 lg:flex-row lg:items-center lg:justify-between p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"space-y-3 sm:space-y-5 max-w-2xl min-w-0",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.4em] text-white/70",children:[e.jsx(Ls,{className:"w-4 h-4"}),"Brand profile"]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-semibold leading-tight break-words",children:"Design the source of every story"}),e.jsx("p",{className:"text-xs sm:text-sm lg:text-base text-white/80 leading-relaxed",children:"Give me the essentials about your brand, and I'll turn them into campaigns, content, and stories that sound exactly like you."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm text-white/80",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(Pe,{className:"w-3.5 h-3.5"}),"Guided by Andora"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(Rs,{className:"w-3.5 h-3.5"}),u?"Savingâ€¦":"Autosaved"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(Ds,{className:"w-3.5 h-3.5"}),ct(r.timezone)]})]})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:gap-6 lg:gap-8 lg:grid-cols-[minmax(0,1fr),minmax(280px,300px)] items-start",children:[e.jsxs("div",{className:"space-y-4 sm:space-y-6 lg:space-y-8 min-w-0",children:[e.jsx(Es,{id:"identity",title:"Identity essentials",description:"Tell me who you are, what you promise, and how you want to show up in the world.",icon:e.jsx(Ls,{className:"w-5 h-5"}),children:e.jsxs("div",{className:"space-y-5",children:[e.jsx(cs,{label:"Brand Name",value:r.brand_name||"",onChange:f=>U("brand_name",f.target.value),placeholder:"Your Brand Name",maxLength:qe.brand_name,helperText:`${(r.brand_name||"").length}/${qe.brand_name}`}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600",children:"Brand Type"}),e.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>U("brand_type","individual"),className:`rounded-xl border-2 px-3 sm:px-4 py-3 sm:py-4 text-left transition-all ${(r.brand_type||"organization")==="individual"?"border-primary-500 bg-primary-500/10 text-primary-700 shadow-sm":"border-slate-200 hover:border-primary-300 text-slate-600"}`,children:[e.jsx(Qt,{className:"w-5 h-5 sm:w-6 sm:h-6 mb-2"}),e.jsx("div",{className:"font-semibold text-sm sm:text-base",children:"Individual"}),e.jsx("p",{className:"text-xs mt-1 text-slate-500",children:"Personal Brand (1 character)"})]}),e.jsxs("button",{type:"button",onClick:()=>U("brand_type","organization"),className:`rounded-xl border-2 px-3 sm:px-4 py-3 sm:py-4 text-left transition-all ${(r.brand_type||"organization")==="organization"?"border-primary-500 bg-primary-500/10 text-primary-700 shadow-sm":"border-slate-200 hover:border-primary-300 text-slate-600"}`,children:[e.jsx(Ns,{className:"w-5 h-5 sm:w-6 sm:h-6 mb-2"}),e.jsx("div",{className:"font-semibold text-sm sm:text-base",children:"Organization"}),e.jsx("p",{className:"text-xs mt-1 text-slate-500",children:"Team/Company (Multiple characters)"})]})]})]}),e.jsx("div",{className:"rounded-lg sm:rounded-xl border border-slate-200/80 bg-slate-50/50 px-3 sm:px-4 py-2 sm:py-3 min-w-0",children:e.jsxs("button",{type:"button",onClick:()=>U("reverse_positioning",!r.reverse_positioning),className:"flex w-full items-center justify-between gap-2 sm:gap-3 text-left min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[r.reverse_positioning?e.jsx(Ia,{className:"w-4 h-4 sm:w-5 sm:h-5 text-primary-600 shrink-0"}):e.jsx(za,{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-400 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-slate-700",children:"Audience-first approach"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 break-words",children:r.reverse_positioning?"Enabled â€” Market-first: Product â†’ Audience â†’ Vision/Mission":"Disabled â€” Traditional: Vision/Mission â†’ Product â†’ Audience"})]})]}),e.jsx("span",{className:`rounded-full px-2 sm:px-3 py-1 text-[10px] sm:text-xs font-medium shrink-0 ${r.reverse_positioning?"bg-primary-100 text-primary-700":"bg-slate-200 text-slate-600"}`,children:r.reverse_positioning?"On":"Off"})]})}),e.jsx(cs,{label:"Tagline",value:r.taglines||"",onChange:f=>U("taglines",f.target.value),placeholder:"Your Brand Tagline",maxLength:qe.taglines,helperText:`${(r.taglines||"").length}/${qe.taglines}`}),e.jsx(Ie,{label:(r.brand_type||"organization")==="individual"?"About You":"About Your Brand",value:r.about||"",onChange:f=>U("about",f.target.value),placeholder:(r.brand_type||"organization")==="individual"?"Tell us about you â€” your background, expertise, passions, values, what makes you unique.":"Tell us about your brand â€” your story, what you do, your team culture, values, and what makes you unique.",rows:4,maxLength:qe.about,helperText:`${(r.about||"").length}/${qe.about}`}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-slate-600",children:[e.jsx(Ds,{className:"w-4 h-4"}),"Timezone"]}),e.jsxs("button",{type:"button",onClick:()=>k(!N),className:"flex w-full items-center justify-between rounded-lg border border-slate-200 bg-white/80 px-4 py-3 text-sm font-medium text-slate-700 shadow-sm transition-colors hover:border-primary-300",children:[e.jsx("span",{children:ct(r.timezone)}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),N&&e.jsx("div",{className:"absolute z-50 mt-2 max-h-64 w-full overflow-y-auto rounded-lg border border-primary-200 bg-white shadow-xl",children:wt.map(f=>e.jsxs("button",{type:"button",onClick:()=>L(f.value),className:`flex w-full items-center justify-between px-4 py-2 text-left text-sm transition-colors ${r.timezone===f.value?"bg-primary-500/10 text-primary-600":"hover:bg-primary-500/10"}`,children:[e.jsx("span",{children:f.label}),e.jsx("span",{className:"text-xs text-slate-500",children:f.offset})]},f.value))}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Set your local timezone to sync scheduling and campaign launches."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:(r.brand_type||"organization")==="individual"?"Product/Offer":"Products & Services"}),e.jsx(xr,{value:r.products||"",onChange:f=>U("products",f),placeholder:(r.brand_type||"organization")==="individual"?"Describe your signature offer, service, or expertise.":"Outline your core products, services, or solutions."})]}),e.jsx(cs,{label:"Brand Colors (Optional)",value:r.colors||"",onChange:f=>U("colors",f.target.value),placeholder:"#2563eb, #7c3aed, #dc2626",maxLength:qe.colors,helperText:`${(r.colors||"").length}/${qe.colors}`})]})}),r.reverse_positioning&&e.jsx(Es,{id:"audience-insights",title:"Audience-first lens",description:"You flipped the script. Map the humans before the hero.",icon:e.jsx(zt,{className:"w-5 h-5"}),children:Q()}),e.jsx(Es,{id:"story",title:"Narrative foundations",description:"Share the future you're building, and I'll keep every story aligned with that vision.",icon:e.jsx(gt,{className:"w-5 h-5"}),children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Vision"}),e.jsxs("button",{onClick:()=>ye("vision"),disabled:x.vision,className:"flex items-center gap-2 text-xs font-medium text-primary-600 hover:text-primary-700 disabled:opacity-50",children:[e.jsx(Pe,{size:14}),x.vision?"I'm thinkingâ€¦":"Ask me"]})]}),e.jsx(Ie,{value:r.vision||"",onChange:f=>U("vision",f.target.value),placeholder:"Your brand's vision...",rows:3,maxLength:qe.vision,helperText:`${(r.vision||"").length}/${qe.vision}`})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Mission"}),e.jsxs("button",{onClick:()=>ye("mission"),disabled:x.mission,className:"flex items-center gap-2 text-xs font-medium text-primary-600 hover:text-primary-700 disabled:opacity-50",children:[e.jsx(Pe,{size:14}),x.mission?"I'm thinkingâ€¦":"Ask me"]})]}),e.jsx(Ie,{value:r.mission||"",onChange:f=>U("mission",f.target.value),placeholder:"Your brand's mission...",rows:3,maxLength:qe.mission,helperText:`${(r.mission||"").length}/${qe.mission}`})]})]})}),e.jsx(Es,{id:"voice",title:"Voice & persona",description:"Teach me your language, energy, and quirks so I can sound exactly like you.",icon:e.jsx(It,{className:"w-5 h-5"}),children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Your brand's voice & personality"}),e.jsxs("button",{onClick:()=>ye("persona"),disabled:x.persona,className:"flex items-center gap-2 text-xs font-medium text-primary-600 hover:text-primary-700 disabled:opacity-50",children:[e.jsx(Pe,{size:14}),x.persona?"I'm thinkingâ€¦":"Ask me"]})]}),e.jsx(Ie,{value:r.persona||"",onChange:f=>U("persona",f.target.value),placeholder:"How does your brand communicate? (e.g., Professional yet approachable, innovative, trustworthy)",rows:3,maxLength:qe.persona,helperText:`${(r.persona||"").length}/${qe.persona}`})]}),!r.reverse_positioning&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium text-slate-600",children:["Target Audiences",e.jsx("span",{className:"block text-xs font-normal text-slate-500 mt-1",children:"Define your audience segments â€” who they are, what they need, and what they care about."})]}),e.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-slate-700",children:["ðŸ’¡ ",e.jsx("strong",{children:"Multiple Audiences:"})," Create different audience segments for each product/service. The first is your key audience."]})}),e.jsx(Ut,{value:r.buyer_profile||"",products:(()=>{try{return JSON.parse(r.products||"[]")}catch(f){return[]}})(),onChange:f=>U("buyer_profile",f),onAISuggest:f=>ie(void 0,null,function*(){yield ye("buyer_profile",f)}),isGeneratingAI:x.buyer_profile,placeholder:"Fill in the simple prompts to outline this audience segment."})]})]})}),e.jsx(Es,{id:"channels",title:"Distribution rhythm",description:"Tell me where you want to show up and how often, so I can plan your content calendar.",icon:e.jsx(Ea,{className:"w-5 h-5"}),children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Channels"}),e.jsxs("button",{onClick:()=>ye("channels"),disabled:x.channels,className:"flex items-center gap-2 text-xs font-medium text-primary-600 hover:text-primary-700 disabled:opacity-50",children:[e.jsx(Pe,{size:14}),x.channels?"I'm thinkingâ€¦":"Ask me"]})]}),e.jsx("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-3 gap-2",children:Ra.map(f=>e.jsx("button",{type:"button",onClick:()=>le(f),className:`rounded-lg border px-2 sm:px-3 py-2 text-xs sm:text-sm font-medium transition-all truncate ${r.channels.includes(f)?"border-primary-400 bg-primary-500/10 text-primary-600 shadow-sm":"border-slate-200 bg-white text-slate-600 hover:border-primary-300"}`,children:f},f))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Content Types"}),e.jsx("p",{className:"text-xs text-slate-500",children:"What can you create?"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 mb-3",children:"Select the types of content your brand is equipped to produce. This helps the AI suggest realistic content ideas."}),e.jsx("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-3 gap-2",children:Ba.map(f=>e.jsx("button",{type:"button",onClick:()=>we(f),className:`rounded-lg border px-2 sm:px-3 py-2 text-xs sm:text-sm font-medium transition-all truncate ${(r.content_types||[]).includes(f)?"border-purple-400 bg-purple-500/10 text-purple-600 shadow-sm":"border-slate-200 bg-white text-slate-600 hover:border-purple-300"}`,children:f},f))})]}),e.jsx("div",{className:"rounded-2xl border border-slate-200/80 bg-white/80 p-4",children:e.jsx(fr,{brand:r,onUpdate:f=>{console.log("ðŸ“‹ ConfigPage: Received channel_schedule update:",f),U("channel_schedule",f),he("âœ¨ Posting schedule updated!")}})})]})})]}),e.jsxs("aside",{className:"space-y-4 sm:space-y-6 lg:sticky lg:top-28 min-w-0",children:[e.jsx("div",{className:"rounded-xl sm:rounded-2xl border border-primary-200/70 bg-gradient-to-br from-primary-50/80 to-white p-3 sm:p-4 lg:p-6 shadow-sm backdrop-blur min-w-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-primary-600",children:"Profile Completion"}),e.jsxs("div",{className:"mt-2 flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-3xl font-bold text-primary-900",children:[S,"%"]}),e.jsx("span",{className:"text-sm text-slate-600",children:"complete"})]}),e.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-slate-200",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-primary-500 to-purple-500 transition-all duration-500",style:{width:`${S}%`}})})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:_.map(f=>e.jsxs("span",{className:`flex items-center gap-1.5 rounded-lg px-2 py-1.5 ${f.complete?"bg-emerald-50/80 text-emerald-700":"bg-slate-100/80 text-slate-500"}`,children:[e.jsx(Bs,{className:`w-3.5 h-3.5 ${f.complete?"text-emerald-500":"text-slate-400"}`}),e.jsx("span",{className:"truncate",children:f.label})]},f.label))})]})}),e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200/70 bg-white/90 p-3 sm:p-4 lg:p-6 shadow-sm backdrop-blur min-w-0",children:[e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Brand snapshot"}),e.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-semibold text-slate-900 break-words",children:r.brand_name||"Name your brand"}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-500 leading-relaxed break-words",children:r.taglines||"Drop a tagline so your team has a one-line rallying cry."})]}),e.jsxs("div",{className:"mt-5 space-y-3 text-sm text-slate-600",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Type"}),e.jsx("span",{className:"rounded-full bg-primary-500/10 px-3 py-1 text-xs font-semibold text-primary-700",children:(r.brand_type||"organization").charAt(0).toUpperCase()+(r.brand_type||"organization").slice(1)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Timezone"}),e.jsx("span",{children:ct(r.timezone)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Channels"}),e.jsx("span",{children:r.channels.length||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Audience-first"}),e.jsx("span",{className:`font-medium ${r.reverse_positioning?"text-primary-600":"text-slate-500"}`,children:r.reverse_positioning?"Enabled":"Classic"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(w,{onClick:H,variant:"outline",size:"sm",disabled:!T,className:`w-full ${T?"border-primary-300 text-primary-700 hover:bg-primary-50":"cursor-not-allowed opacity-60"}`,children:[e.jsx(ss,{size:16,className:"mr-2"}),"Copy profile",!T&&e.jsx("span",{className:"ml-2 rounded-full bg-amber-100 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-amber-700",children:"Admin"})]})})]}),e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200/70 bg-white/90 p-3 sm:p-4 lg:p-6 shadow-sm backdrop-blur min-w-0",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Journey"}),e.jsx("div",{className:"mt-4 space-y-4",children:D.map((f,ee)=>e.jsxs("a",{href:`#${f.id}`,className:"group flex items-start gap-3 rounded-xl border border-transparent px-3 py-2 transition-colors hover:border-primary-200 hover:bg-primary-50/60",children:[e.jsx("div",{className:`mt-1 flex h-6 w-6 items-center justify-center rounded-full border text-xs font-semibold ${f.complete?"border-emerald-400 bg-emerald-50 text-emerald-600":"border-slate-300 bg-white text-slate-400"}`,children:ee+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 group-hover:text-primary-700",children:f.label}),e.jsx("p",{className:"text-xs text-slate-500",children:f.description})]}),f.complete&&e.jsx(Bs,{className:"mt-1 h-4 w-4 text-emerald-500"})]},f.id))})]}),e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200/70 bg-white/90 p-3 sm:p-4 lg:p-6 shadow-sm backdrop-blur min-w-0",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-500",children:"Highlights"}),e.jsx("div",{className:"mt-4 space-y-4",children:G.map((f,ee)=>e.jsxs("div",{className:"rounded-xl border border-slate-200/70 bg-slate-50/60 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:[f.icon,f.label]}),e.jsx("p",{className:"mt-2 text-sm text-slate-700 leading-relaxed",children:f.value})]},ee))})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 border-t border-slate-200 pt-6 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Ready for the narrative layer? Jump to the plot studio when your essentials feel sharp."}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[e.jsxs(w,{onClick:H,variant:"outline",size:"lg",disabled:!T,className:`w-full sm:w-auto ${T?"border-primary-300 text-primary-700 hover:bg-primary-50":"cursor-not-allowed opacity-60"}`,children:[e.jsx(ss,{size:18,className:"mr-2"}),"Copy all fields",!T&&e.jsx("span",{className:"ml-2 rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold uppercase tracking-wide text-amber-700",children:"Admin"})]}),e.jsxs(w,{onClick:()=>m("/dashboard/plot"),size:"lg",className:"w-full bg-gradient-to-r from-primary-600 to-purple-600 text-white shadow-lg transition hover:from-primary-700 hover:to-purple-700 sm:w-auto",children:["Continue to Brand Story",e.jsx(Ps,{size:20,className:"ml-2"})]})]})]})]}),e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-3",children:d.map((f,ee)=>e.jsx("div",{className:"animate-slide-in-right",style:{animation:`slideInRight 0.5s ease-out ${ee*.1}s both`},children:e.jsx(Ua,{message:f.message,type:f.type,onClose:()=>A(q=>q.filter(ue=>ue.id!==f.id))})},f.id))}),e.jsx("style",{children:`
        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in-right {
          animation: slideInRight 0.5s ease-out both;
        }
      `})]})},Nn=Object.freeze(Object.defineProperty({__proto__:null,ConfigPage:br},Symbol.toStringTag,{value:"Module"})),fs=({label:s,value:l,onChange:r,onPerfectToggle:c,onBlur:u,isPerfect:o,placeholder:N,type:k="input",required:x=!1,options:i=[],helpText:d,rows:A=2,suggestion:g,onSuggestionApply:m,onSuggestionRefine:j,fieldKey:t,suggestionLabel:F,isRefining:T=!1,readOnly:_=!1,hideAIButtons:E=!1,hidePerfectToggle:S=!1})=>{const[D,G]=n.useState(!1);n.useEffect(()=>{G(!1)},[g]);const te=()=>{!g||!t||m==null||m(t,g)},re=()=>{t&&(j==null||j(t))},V=()=>ie(void 0,null,function*(){var U;if(g)try{if((U=navigator==null?void 0:navigator.clipboard)!=null&&U.writeText)yield navigator.clipboard.writeText(g);else{const le=document.createElement("textarea");le.value=g,le.setAttribute("readonly",""),le.style.position="absolute",le.style.left="-9999px",document.body.appendChild(le),le.select(),document.execCommand("copy"),document.body.removeChild(le)}G(!0),setTimeout(()=>G(!1),2e3)}catch(le){console.error("Failed to copy suggestion to clipboard:",le)}});return e.jsxs("div",{className:`relative ${o?"bg-green-50/30 rounded-lg p-2 -m-2":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-primary-800",children:[s," ",x&&e.jsx("span",{className:"text-red-500",children:"*"}),_&&e.jsx("span",{className:"ml-1 text-xs text-slate-500",children:"(AI-Generated)"})]}),!S&&e.jsx("button",{onClick:c,className:`px-2 py-1 rounded text-xs font-medium transition-all uppercase ${o?"text-green-600 border border-green-400/50 bg-green-50 hover:bg-green-100":"text-slate-500 border border-slate-300 hover:border-slate-400"}`,type:"button",children:o?"âœ“ Perfect":"Mark as Perfect"})]}),k==="input"&&e.jsx("input",{type:"text",value:l,onChange:U=>r(U.target.value),onBlur:u,placeholder:N,readOnly:_,className:`w-full px-3 py-2 rounded-lg border ${o?"border-green-300 bg-green-50/50":"border-primary-200"} ${_?"bg-slate-50 cursor-not-allowed":"bg-white/50"} focus:outline-none focus:ring-2 focus:ring-primary-400`}),k==="textarea"&&e.jsx("textarea",{value:l,onChange:U=>r(U.target.value),onBlur:u,placeholder:N,rows:A,readOnly:_,className:`w-full px-3 py-2 rounded-lg border ${o?"border-green-300 bg-green-50/50":"border-primary-200"} ${_?"bg-slate-50 cursor-not-allowed":"bg-white/50"} focus:outline-none focus:ring-2 focus:ring-primary-400 resize-y min-h-[80px]`}),k==="select"&&e.jsxs("select",{value:l,onChange:U=>r(U.target.value),onBlur:u,className:`w-full px-3 py-2 rounded-lg border ${o?"border-green-300 bg-green-50/50":"border-primary-200"} bg-white/50 focus:outline-none focus:ring-2 focus:ring-primary-400`,children:[e.jsx("option",{value:"",children:"Select..."}),i.map(U=>e.jsx("option",{value:U.value,children:U.label},U.value))]}),d&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:d}),!E&&g&&!o&&t&&e.jsxs("div",{className:"mt-2 border border-primary-200 bg-primary-50/60 rounded-md p-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{className:"text-sm font-semibold text-primary-900",children:F||"Andora suggests"})}),e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("p",{className:"text-sm text-primary-800 whitespace-pre-wrap flex-1 leading-relaxed",children:g}),e.jsxs("div",{className:"flex flex-col gap-1 items-end flex-shrink-0",children:[e.jsxs("div",{className:"flex gap-1",children:[m&&t&&e.jsx("button",{type:"button",onClick:te,className:"text-xs px-3 py-1 rounded-md bg-primary-600 text-white hover:bg-primary-700 transition",children:"Apply"}),j&&t&&e.jsx("button",{type:"button",onClick:re,className:"text-xs px-3 py-1 rounded-md bg-orange-600 text-white hover:bg-orange-700 transition disabled:opacity-60 disabled:cursor-not-allowed",disabled:T,children:T?"Refiningâ€¦":"Refine"})]}),e.jsx("button",{type:"button",onClick:V,className:"text-xs px-3 py-1 rounded-md border border-primary-300 text-primary-700 hover:bg-primary-100 transition","aria-label":`Copy ${F||"Andora's suggestion"} for ${s}`,children:D?"Copied!":"Copy"})]})]})]})]})},yr=["name","character_name","role","gender","age_range","work_mode","about","personality","persona"],bs=yr.length,jr=[{value:"onsite",label:"Onsite"},{value:"remote",label:"Remote"},{value:"hybrid",label:"Hybrid"}],vr=({character:s,brandId:l,isOpen:r,onClose:c,onChange:u,onSave:o,onDelete:N,onToggleMute:k,onAIGenerate:x,isGenerating:i=!1,suggestions:d={},onSuggestionApply:A,onFieldRefine:g,refiningField:m=null,characters:j=[],activeCharacterIndex:t=0,onCharacterChange:F,onPreviousCharacter:T,onNextCharacter:_,onAddCharacter:E,onSuggestCharacter:S,onAllDone:D,showAllDone:G=!1,isTraining:te=!1})=>{var Se;const[re,V]=n.useState(!1),[U,le]=n.useState(!1),[we,he]=n.useState(!1),L=n.useRef(null);n.useEffect(()=>{const W=me=>{me.key==="Escape"&&r&&c(),j.length>1&&r&&(me.key==="ArrowLeft"&&T?(me.preventDefault(),T()):me.key==="ArrowRight"&&_&&(me.preventDefault(),_()))};return window.addEventListener("keydown",W),()=>window.removeEventListener("keydown",W)},[r,c,j.length,T,_]),n.useEffect(()=>{var W;!i&&(s.persona||s.personality||s.character_name)&&((W=L.current)==null||W.scrollIntoView({behavior:"smooth",block:"start"}))},[i]);const Q=W=>ie(void 0,null,function*(){const me=W!=null?W:s;if(!me.id){le(!1);return}V(!0);try{yield o(me),le(!1)}catch(y){console.error("Save failed:",y)}finally{V(!1)}}),H=s.perfect_fields||{},ye=Object.values(H).filter(Boolean).length,f=ye===bs,q=f?{label:"Perfect",color:"emerald"}:s.persona||s.personality?{label:"AI Generated",color:"purple"}:{label:"Draft",color:"slate"},ue=!!((Se=s.name)!=null&&Se.trim());s.persona||s.personality||s.character_name;const ke=W=>{const me=R(I({},H),{[W]:!H[W]}),y=R(I({},s),{perfect_fields:me});u({perfect_fields:me}),le(!0),Q(y)},ge=W=>{u(W),le(!0)},Ce=(W,me)=>{A==null||A(W,me)},Z=W=>{s.id&&(g==null||g(s.id,W))},_e=()=>ie(void 0,null,function*(){if(s.persona)try{yield navigator.clipboard.writeText(s.persona),he(!0),setTimeout(()=>he(!1),2e3)}catch(W){console.error("Failed to copy:",W)}});return r?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-50 pb-24",children:[e.jsxs("div",{className:"sticky top-0 z-50 w-full bg-gradient-to-r from-primary-700 via-purple-700 to-slate-900 border-b border-white/10 shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 opacity-25 mix-blend-screen bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.2),transparent_60%)]","aria-hidden":!0}),e.jsx("div",{className:"relative z-10 px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:c,className:"inline-flex items-center gap-2 rounded-full border border-white/30 bg-white/10 px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.3em] text-white/90 transition hover:bg-white/20 hover:text-white",children:[e.jsx(Ss,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Back"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-white truncate max-w-[200px] sm:max-w-none",children:s.name||"New Character"}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-medium ${q.color==="emerald"?"bg-emerald-200/20 text-emerald-100":q.color==="purple"?"bg-purple-200/20 text-purple-100":"bg-white/10 text-white/70"}`,children:[q.color==="emerald"&&e.jsx(Bs,{size:12}),q.color==="purple"&&e.jsx(Pe,{size:12}),q.label]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[k&&e.jsx("button",{type:"button",onClick:W=>{W.preventDefault(),W.stopPropagation(),k()},className:"inline-flex items-center gap-1 px-2.5 py-1.5 rounded-lg border border-white/30 text-white text-sm hover:bg-white/10 transition-colors",title:s.is_muted?"Unmute":"Mute",children:s.is_muted?e.jsx(Xs,{size:16}):e.jsx(ft,{size:16})}),N&&e.jsx("button",{onClick:N,className:"inline-flex items-center gap-1 px-2.5 py-1.5 rounded-lg border border-white/30 text-white text-sm hover:bg-white/10 transition-colors",title:"Delete",children:e.jsx(Us,{size:16})}),re&&e.jsx("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-white/10 px-3 py-1.5 text-xs text-white/90",children:e.jsx(rt,{size:14,className:"animate-spin"})}),U&&!re&&e.jsx("span",{className:"hidden sm:inline-flex items-center gap-1.5 rounded-full bg-amber-200/20 px-3 py-1.5 text-xs text-amber-100",children:"Unsaved"})]})]})})]}),j.length>1&&e.jsx("div",{className:"sticky top-[64px] z-40 w-full bg-white border-b border-slate-200 shadow-sm",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-3",children:e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto scrollbar-hide",children:[T&&e.jsx("button",{onClick:T,className:"flex-shrink-0 rounded-full bg-slate-100 p-2 text-slate-600 transition hover:bg-slate-200",title:"Previous (â†)",children:e.jsx(us,{size:18})}),e.jsx("div",{className:"flex items-center gap-2",children:j.map((W,me)=>{var P;const y=((P=W.name)==null?void 0:P.trim())||`Character ${me+1}`,C=me===t;return e.jsx("button",{onClick:()=>F==null?void 0:F(me),className:`flex-shrink-0 rounded-full px-4 py-2 text-xs sm:text-sm font-medium transition-all ${C?"bg-primary-600 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:y},W.id)})}),_&&e.jsx("button",{onClick:_,className:"flex-shrink-0 rounded-full bg-slate-100 p-2 text-slate-600 transition hover:bg-slate-200",title:"Next (â†’)",children:e.jsx(Qe,{size:18})})]})})}),e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-slate-100",children:e.jsx(jt,{size:20,className:"text-slate-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Tell Andora About This Person"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Share the basics â€” Andora will craft the rest"})]})]}),e.jsxs("div",{className:"space-y-5 bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[e.jsx(fs,{label:"Name",value:s.name||"",onChange:W=>ge({name:W}),onPerfectToggle:()=>ke("name"),onBlur:Q,isPerfect:!!H.name,placeholder:"e.g., Josh, Starr, Oma",helpText:"The person's actual name",required:!0,fieldKey:"name",hideAIButtons:!0}),e.jsx(fs,{label:"Role",value:s.role||"",onChange:W=>ge({role:W}),onPerfectToggle:()=>ke("role"),onBlur:Q,isPerfect:!!H.role,placeholder:"e.g., CEO, CTO, Marketing Lead",helpText:"Their position or title",fieldKey:"role",hideAIButtons:!0}),e.jsx(fs,{label:"Work Mode",value:s.work_mode||"",onChange:W=>ge({work_mode:W}),onPerfectToggle:()=>ke("work_mode"),onBlur:Q,isPerfect:!!H.work_mode,type:"select",options:jr,fieldKey:"work_mode",hideAIButtons:!0}),e.jsx(fs,{label:"Gender",value:s.gender||"",onChange:W=>ge({gender:W}),onPerfectToggle:()=>ke("gender"),onBlur:Q,isPerfect:!!H.gender,type:"select",options:[{value:"Male",label:"Male"},{value:"Female",label:"Female"},{value:"Non-binary",label:"Non-binary"},{value:"Prefer not to say",label:"Prefer not to say"}],helpText:"Helps Andora use correct pronouns",fieldKey:"gender",hideAIButtons:!0}),e.jsx(fs,{label:`What makes ${s.name||"them"} special?`,value:s.about||"",onChange:W=>ge({about:W}),onPerfectToggle:()=>ke("about"),onBlur:Q,isPerfect:!!H.about,type:"textarea",placeholder:"Strengths, quirks, key facts, communication style, anything memorable...",rows:4,helpText:"The more you share, the better Andora understands them",fieldKey:"about",hideAIButtons:!0}),e.jsxs("details",{className:"group pt-4 border-t border-slate-200",children:[e.jsxs("summary",{className:"cursor-pointer text-sm font-medium text-slate-600 hover:text-primary-600 transition-colors flex items-center gap-2",children:[e.jsx("span",{children:"Optional notes"}),e.jsxs("span",{className:"text-xs font-normal text-slate-400",children:["(",[s.backstory,s.voice].filter(Boolean).length>0?`${[s.backstory,s.voice].filter(Boolean).length} filled`:"Backstory, Voice",")"]})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx(fs,{label:"Backstory Notes",value:s.backstory||"",onChange:W=>ge({backstory:W}),onPerfectToggle:()=>{},onBlur:Q,isPerfect:!1,type:"textarea",placeholder:"Optional: Any backstory notes...",rows:2,helpText:"For your own reference",fieldKey:"backstory",hideAIButtons:!0,hidePerfectToggle:!0}),e.jsx(fs,{label:"Voice & Tone Notes",value:s.voice||"",onChange:W=>ge({voice:W}),onPerfectToggle:()=>{},onBlur:Q,isPerfect:!1,type:"textarea",placeholder:"Optional: Notes about speaking style...",rows:2,helpText:"Reminders about tone or phrases",fieldKey:"voice",hideAIButtons:!0,hidePerfectToggle:!0})]})]})]})]})}),e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:`relative overflow-hidden rounded-2xl border-2 transition-all ${ue?"border-primary-300 bg-gradient-to-br from-primary-50 via-purple-50 to-white":"border-slate-200 bg-slate-50"}`,children:[e.jsx("div",{className:"absolute inset-0 opacity-30 bg-[radial-gradient(circle_at_top_right,_rgba(139,92,246,0.3),transparent_50%)]","aria-hidden":!0}),e.jsxs("div",{className:"relative z-10 p-6 sm:p-8 flex flex-col sm:flex-row items-center gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(es,{size:"lg",animate:i})}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 flex items-center justify-center sm:justify-start gap-2",children:[e.jsx(ds,{size:20,className:"text-primary-600"}),"Let Andora Build the Persona"]}),e.jsx("p",{className:"mt-1 text-sm text-slate-600",children:ue?"Based on what you've shared, Andora will suggest their character name, personality, and cinematic persona. Mark any field as perfect to lock itâ€”Andora will only update fields that aren't perfect.":"Add the person's name above to get started."})]}),x&&e.jsxs(w,{onClick:x,loading:i,disabled:!ue,size:"lg",className:"flex-shrink-0 px-6 py-3 bg-gradient-to-r from-primary-600 to-purple-600 text-white hover:from-primary-700 hover:to-purple-700 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Pe,{size:18,className:"mr-2"}),i?"Suggesting...":"Suggest"]})]})]})})}),e.jsx("div",{ref:L,className:"w-full px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-gradient-to-br from-primary-100 to-purple-100",children:e.jsx(ea,{size:20,className:"text-primary-600"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:["Andora's Generated Persona",e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-primary-100 text-primary-700 text-xs font-medium",children:[e.jsx(Pe,{size:12}),"AI"]})]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Review Andora's suggestions â€” mark fields as perfect to lock them in"})]})]}),e.jsxs("div",{className:"space-y-5 bg-gradient-to-br from-primary-50/50 via-purple-50/50 to-white rounded-2xl border border-primary-200/50 p-6 shadow-sm",children:[e.jsx(fs,{label:"Character Name",value:s.character_name||"",onChange:W=>ge({character_name:W}),onPerfectToggle:()=>ke("character_name"),onBlur:Q,isPerfect:!!H.character_name,placeholder:"e.g., The Guardian, The Maverick, The Sage",helpText:"Their role in your brand's story â€” the name that captures who they are in the narrative",fieldKey:"character_name",suggestion:d==null?void 0:d.character_name,onSuggestionApply:Ce,onSuggestionRefine:Z,isRefining:m==="character_name"}),e.jsx(fs,{label:"Personality Type",value:s.personality||"",onChange:W=>ge({personality:W}),onPerfectToggle:()=>ke("personality"),onBlur:Q,isPerfect:!!H.personality,type:"input",placeholder:"e.g., Strategic visionary (INTJ), Creative catalyst, Empathetic connector",helpText:"How they approach work and life â€” their professional and personal operating style",fieldKey:"personality",suggestion:d==null?void 0:d.personality,onSuggestionApply:Ce,onSuggestionRefine:Z,isRefining:m==="personality"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fs,{label:"Cinematic Persona",value:s.persona||"",onChange:W=>ge({persona:W}),onPerfectToggle:()=>ke("persona"),onBlur:Q,isPerfect:!!H.persona,type:"textarea",placeholder:"Andora will craft a rich, detailed persona description here...",rows:6,helpText:"The full persona â€” edit anything that doesn't feel right",fieldKey:"persona",suggestion:d==null?void 0:d.persona,onSuggestionApply:Ce,onSuggestionRefine:Z,isRefining:m==="persona"}),s.persona&&e.jsx("button",{onClick:_e,className:"px-4 py-2 text-sm bg-primary-50 hover:bg-primary-100 text-primary-700 rounded-lg transition-colors",children:we?"âœ“ Copied!":"Copy Persona"})]})]})]})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-slate-200 shadow-lg",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-sm text-slate-600",children:f?"âœ“ All fields perfect â€” ready to train":`${ye}/${bs} fields marked perfect`}),e.jsxs("div",{className:"flex items-center gap-2",children:[E&&e.jsxs(w,{onClick:E,size:"sm",variant:"outline",className:"border-slate-300 bg-white text-slate-700 hover:bg-slate-50",children:[e.jsx(Ns,{size:16,className:"mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:j.length===0?"Add Persona":"Add Another"}),e.jsx("span",{className:"inline sm:hidden",children:"Add"})]}),G&&D&&e.jsxs(w,{onClick:D,loading:te,size:"sm",className:"bg-emerald-600 text-white hover:bg-emerald-700",children:[e.jsx(Bs,{size:16,className:"mr-1.5"}),te?"Training...":"All Done"]})]})]})})})]}):null},Nr=({children:s,className:l=""})=>e.jsxs("div",{className:`relative ${l}`,children:[e.jsx("div",{className:"absolute -left-2 top-4 w-4 h-4 bg-white transform rotate-45 rounded-sm shadow-lg"}),e.jsx("div",{className:"relative bg-white rounded-2xl p-6 shadow-xl border border-primary-100/70",children:e.jsx("div",{className:"text-slate-700 leading-relaxed",children:s})})]}),wr=({onComplete:s})=>{const[l,r]=n.useState(0),c=[{title:"Welcome to Character Studio",icon:e.jsx(Pe,{size:48,className:"text-primary-500"}),content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-lg mb-3",children:["Hi! I'm ",e.jsx("span",{className:"font-semibold text-purple-600",children:"Andora"}),", your brand storytelling assistant."]}),e.jsxs("p",{className:"mb-3",children:["Think of your brand as a ",e.jsx("span",{className:"font-semibold",children:"TV series"}),", and the people working at your brand as the ",e.jsx("span",{className:"font-semibold",children:"cast"}),"."]}),e.jsx("p",{className:"text-slate-600",children:"Just like viewers connect with different characters in their favorite shows, your audience will connect with different people on your team."})]})},{title:"Build Your Cast",icon:e.jsx(Ns,{size:48,className:"text-primary-400"}),content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-lg mb-3",children:["Here's how we'll work ",e.jsx("span",{className:"font-semibold text-pink-600",children:"together"}),":"]}),e.jsxs("ul",{className:"space-y-3 text-slate-700",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-primary-500",children:"âœ“"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold",children:"You provide"})," the raw facts: names, roles, quirks, backstories"]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-primary-500",children:"âœ“"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold",children:"I weave"})," them into compelling personas that resonate emotionally"]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-primary-500",children:"âœ“"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold",children:"You mark fields perfect"})," when they capture the essence just right"]})]})]})]})},{title:"When You'll Use Personas",icon:e.jsx(ds,{size:48,className:"text-accent-500"}),content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-lg mb-3",children:["These personas become the ",e.jsx("span",{className:"font-semibold text-rose-600",children:"foundation"})," for all your content:"]}),e.jsxs("ul",{className:"space-y-3 text-slate-700",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“±"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold",children:"Social posts"})," - I'll write in their authentic voice"]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold",children:"Blog content"})," - Each character drives different storylines"]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:"ðŸŽ¬"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-semibold",children:"Video scripts"})," - Bringing their personalities to life"]})]})]}),e.jsx("p",{className:"mt-4 text-slate-600 italic",children:"The better we craft these personas together, the more compelling your brand story becomes."})]})}],u=()=>{l<c.length-1?r(l+1):s()},o=()=>{l>0&&r(l-1)},N=c[l];return e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-white via-dark-900/60 to-primary-100 z-50 flex items-center justify-center p-4 sm:p-6 overflow-y-auto",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-16 left-12 w-72 h-72 bg-primary-200 rounded-full blur-3xl animate-pulse-slow"}),e.jsx("div",{className:"absolute bottom-16 right-16 w-96 h-96 bg-primary-300/70 rounded-full blur-3xl animate-pulse-slow",style:{animationDelay:"1s"}})]}),e.jsx("div",{className:"relative max-w-4xl w-full my-auto",children:e.jsxs("div",{className:"relative bg-white/95 backdrop-blur border border-primary-100/70 shadow-2xl rounded-3xl px-6 py-6 sm:px-8 sm:py-8 md:px-10 md:py-10 max-h-[85vh] overflow-y-auto",children:[e.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-primary-500 via-accent-400 to-primary-400"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-8 md:gap-12",children:[e.jsx("div",{className:"flex flex-col items-center md:items-start",children:e.jsx("div",{className:"rounded-2xl border border-primary-100 bg-white px-6 py-3 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/andora-logo.png",alt:"Andora",className:"h-8 w-auto"}),e.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-slate-500",children:"Character Studio"})]})})}),e.jsxs(Nr,{className:"flex-1",children:[e.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[N.icon,e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:N.title})]}),e.jsxs("span",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:["Step ",l+1," of ",c.length]})]}),N.content]})]}),e.jsxs("div",{className:"mt-6 sm:mt-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(w,{onClick:o,variant:"outline",disabled:l===0,className:"flex items-center",children:[e.jsx(us,{size:16,className:"mr-1"}),"Back"]}),e.jsx(w,{onClick:u,className:"flex items-center",children:l===c.length-1?e.jsxs(e.Fragment,{children:["Enter Studio",e.jsx(Pe,{size:16,className:"ml-2"})]}):e.jsxs(e.Fragment,{children:["Next",e.jsx(Qe,{size:16,className:"ml-1"})]})})]}),e.jsx("div",{className:"flex items-center gap-2 self-center md:self-auto",children:c.map((k,x)=>e.jsx("button",{onClick:()=>r(x),className:`h-2 rounded-full transition-all duration-300 ${x===l?"w-10 bg-primary-600":"w-3 bg-primary-200 hover:bg-primary-300"}`,"aria-label":`Go to onboarding step ${x+1}`},x))})]})]})})]})},kt=({message:s,show:l=!0,modelInfo:r,progress:c,onStop:u,action:o})=>l?(c&&c.total>0&&Math.round(c.current/c.total*100),e.jsx("div",{className:"fixed top-4 right-4 z-[9999] animate-slide-in-right",children:e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-2xl border border-orange-200/50 bg-gradient-to-br from-white/95 via-orange-50/30 to-white/95 backdrop-blur shadow-xl max-w-md",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:"/andora-logo.png",alt:"Andora",className:"w-10 h-10 rounded-full ring-2 ring-orange-200/60"}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-orange-200/30 blur-md animate-pulse"})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-sm text-slate-700",children:"Andora"}),e.jsx(rt,{className:"w-3 h-3 text-orange-500 animate-spin"})]}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:s}),o&&e.jsx("button",{onClick:o.onClick,className:"mt-2 text-sm text-blue-600 hover:text-blue-700 font-semibold",children:o.label})]}),u&&e.jsx("button",{onClick:u,className:"flex-shrink-0 p-1.5 rounded-full hover:bg-red-50 text-red-500 hover:text-red-600 transition-colors group",title:"Stop generation",children:e.jsx(Ma,{className:"w-5 h-5"})})]})})):null,kr=`
  @keyframes slide-in-right {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  .animate-slide-in-right {
    animation: slide-in-right 0.3s ease-out;
  }
`;if(typeof document!="undefined"){const s=document.createElement("style");s.textContent=kr,document.head.appendChild(s)}const _r={ai_prefill_narrative:["I'm diving deep into your brand's soul...","I'm weaving your brand story with care...","I'm crafting narrative magic just for you...","I'm discovering the heart of your story...","I'm painting your brand's unique picture..."],ai_refine_narrative:["I'm polishing your narrative with care...","I'm enhancing your story's emotional impact...","I'm adding storytelling depth to your words...","I'm refining your brand's message...","I'm elevating your narrative to the next level..."],ai_generate_cast:["I'm bringing your characters to life...","I'm creating compelling personas for your brand...","I'm sculpting voices that will tell your story...","I'm designing personalities that resonate...","I'm giving life to your brand's storytellers..."],ai_generate_theme:["I'm weaving monthly story themes...","I'm creating narrative threads that connect...","I'm designing your content compass...","I'm crafting themes that guide your message...","I'm building the framework for your stories..."],ai_generate_weekly_subplot:["I'm creating weekly story arcs...","I'm building narrative tension and flow...","I'm designing your week's journey...","I'm crafting subplots that unfold beautifully...","I'm mapping out your story's progression..."],ai_generate_calendar:["I'm building your story-driven content calendar...","I'm creating narrative flow across your timeline...","I'm putting together your content plan...","I'm designing your strategic content journey...","I'm weaving stories throughout your schedule..."],ai_generate_content_day:["I'm crafting today's story scene...","I'm selecting the perfect character for this moment...","I'm weaving your weekly subplot into today's content...","I'm creating scroll-stopping content for today...","I'm designing your content brief with creative precision...","I'm mapping out today's narrative beat..."],ai_generate_content_week:["I'm building a week of story-driven content...","I'm lining up your week's story...","I'm creating content flow across the week...","I'm designing 7 days of compelling storytelling...","I'm weaving your subplot through the week...","I'm mapping weekly content with character precision..."],ai_generate_content_month:["I'm building a month of narrative-driven content...","I'm piecing together 30 days of stories...","I'm creating your monthly content masterpiece...","I'm designing a full month of story arcs...","I'm weaving themes throughout your month...","I'm mapping your entire monthly journey..."],ai_regenerate_content:["I'm reimagining this content scene...","I'm creating a fresh take on this story beat...","I'm rethinking character and format choices...","I'm crafting a new creative direction...","I'm finding a better angle for this moment...","I'm redesigning this content with fresh eyes..."],ai_refine_content:["I'm adding story magic to your content...","I'm enhancing narrative flow and impact...","I'm polishing your message to perfection...","I'm infusing your content with brand essence...","I'm fine-tuning every word to resonate..."],ai_resolve_cast:["I'm understanding your vision for the cast...","I'm refining character profiles with your input...","I'm harmonizing your ideas with brand essence...","I'm bringing clarity to your character lineup...","I'm shaping personas that match your vision..."],ai_train_cast:["I'm learning your character voices...","I'm absorbing your cast's unique personalities...","I'm training on your brand storytellers...","I'm internalizing character essence...","I'm getting ready to speak in their voices..."],ai_save_brand:["Got it, I'm saving your updates...","I'm locking in your latest changes...","I'm capturing your brand story...","I've got this saved for you..."],ai_processing:["I'm on it...","I'm cooking up something good...","I'm making magic happen...","I'm bringing your ideas to life...","Give me just a moment..."],ai_analyzing:["I'm reading between the lines...","I'm getting to know your brand's essence...","I'm exploring your story's potential...","I'm finding the perfect narrative angle...","I'm tuning into your unique voice..."]},Cr=s=>{const l=_r[s];return!l||!Array.isArray(l)||l.length===0?(console.warn(`[getLoadingMessage] Invalid or missing type: "${s}"`),String(s)):l[Math.floor(Math.random()*l.length)]},ia=()=>{const[s,l]=n.useState(""),[r,c]=n.useState(void 0),[u,o]=n.useState(!1),[N,k]=n.useState(void 0),x=n.useCallback((A,g,m)=>{const j=Cr(A);l(j),c(g),o(!0),k(m)},[]),i=n.useCallback(()=>{o(!1),l(""),c(void 0),k(void 0)},[]),d=n.useCallback((A,g,m)=>{l(A),c(g),o(!0),k(m)},[]);return{message:s,modelInfo:r,isVisible:u,action:N,showNotification:x,hideNotification:i,updateMessage:d}},oa="andora:last-model",bt=new Set;let Ms=null;const ca=typeof window!="undefined"&&typeof localStorage!="undefined",Sr=s=>ca?Ms||(Ms=localStorage.getItem(oa)||s,Ms):s,Ar=s=>{Ms=s,ca&&localStorage.setItem(oa,s),bt.forEach(l=>l(s))},_t=s=>{const[l,r]=n.useState(()=>Sr(s));n.useEffect(()=>{const u=o=>r(o);return bt.add(u),()=>{bt.delete(u)}},[]);const c=n.useCallback(u=>{Ar(u)},[]);return[l,c]},mt=()=>`new-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Tr=["name","character_name","role","about","personality","age_range","work_mode","persona","backstory","voice","emotional_range","personality_tags"],Gt=["persona","personality","backstory","voice","emotional_range","personality_tags"],Pr=["emotional_range","personality_tags"],xt=(s,l)=>{if(!s)return l||"";const r=s.toUpperCase(),c=r.match(/[A-Z]{4}-[A-Z]/);if(c)return c[0];const u=r.replace(/[^A-Z]/g,"");return u.length>=5?`${u.slice(0,4)}-${u.slice(4,5)}`:l||r},Yt=s=>s.split(/[,\n]/).map(l=>l.trim()).filter(Boolean),Ht=s=>{if(Array.isArray(s)){const l=s.map(r=>typeof r=="string"?r.trim():String(r||"").trim()).filter(Boolean);return l.length?l.join(`
`):null}return typeof s=="string"&&s.trim()?s:null},$r=s=>({id:s.id,name:s.name,character_name:s.character_name||s.real_name,role:s.role,about:s.about,personality:s.personality,age_range:s.age_range,work_mode:s.work_mode,persona:s.persona,backstory:s.backstory,voice:s.voice,emotional_range:s.emotional_range,personality_tags:s.personality_tags,perfect_fields:s.perfect_fields||{}}),Vt=s=>s.map($r),Ir=({brand:s,onBrandUpdate:l,generateCast:r,prefillNarrative:c,isGenerating:u,onStudioStateChange:o})=>{var $e,Ue;const[N,k]=_t("gemini-2.5-flash"),{isAdmin:x,authUser:i}=Is();if(!s)return e.jsx(la,{title:"Design Your Brand Story",description:"Create compelling narratives using a proven story framework. Generate AI-powered character personas that embody your brand voice and personality."});const[d,A]=n.useState([]),[g,m]=n.useState({}),[j,t]=n.useState(!1),[F,T]=n.useState(!1),[_,E]=n.useState(!1),[S,D]=n.useState(!0),[G,te]=n.useState({}),[re,V]=n.useState(0),[U,le]=n.useState(!1),[we,he]=n.useState(!1),[L,Q]=n.useState(!0),[H,ye]=n.useState(!0),f=n.useRef(!1),ee=ws();n.useEffect(()=>{!localStorage.getItem("andora_character_studio_onboarded")&&d.length===0&&he(!0)},[d.length]);const q=()=>{localStorage.setItem("andora_character_studio_onboarded","true"),he(!1)},ue=n.useCallback(h=>{if(!h)return[];if(Array.isArray(h))return h;if(typeof h=="string")try{const a=JSON.parse(h);return ue(a)}catch(a){return console.warn("Unable to parse characters payload string from AI orchestrator:",{payload:h,error:a}),[]}if(typeof h=="object"){const a=h;if(Array.isArray(a.characters)||typeof a.characters=="string")return ue(a.characters);if(Array.isArray(a.cast)||typeof a.cast=="string")return ue(a.cast);if(a.result!==void 0)return ue(a.result);if(a.data!==void 0)return ue(a.data);if(Array.isArray(a.items))return ue(a.items);const p=Object.values(a),M=p.filter(ne=>ne&&typeof ne=="object");if(M.length>0&&M.length===p.length&&M.every(ne=>!Array.isArray(ne)))return M;const $=M;for(const ne of $){const J=ue(ne);if(J.length>0)return J}}return console.warn("Unexpected characters payload from AI orchestrator:",h),[]},[]),{message:ke,modelInfo:ge,isVisible:Ce,showNotification:Z,hideNotification:_e,updateMessage:Se}=ia(),[W,me]=n.useState(null),[y,C]=n.useState(!1);n.useEffect(()=>{ie(void 0,null,function*(){if(s!=null&&s.brand_id)try{D(!0);const a=yield De.getCharacters(s.brand_id);A(a),m({}),a.length>0?V(p=>Math.min(p,a.length-1)):V(0)}catch(a){console.error("Failed to load characters:",a)}finally{D(!1)}})},[s==null?void 0:s.brand_id]),n.useEffect(()=>{V(h=>d.length===0?0:Math.min(h,d.length-1)),d.length>0&&(f.current=!1)},[d.length]),n.useEffect(()=>{m(h=>{let a=!1;const p={};return d.forEach(M=>{const $=h[M.id];if(!$)return;const ne=M.perfect_fields||{},J=Object.entries($).filter(([Xe])=>!ne[Xe]);if(J.length===0){Object.keys($).length>0&&(a=!0);return}const Te=Object.fromEntries(J);if(!a){const Xe=Object.entries($);if(J.length!==Xe.length)a=!0;else for(const[ts,gs]of Xe)if(Te[ts]!==gs){a=!0;break}}p[M.id]=Te}),Object.keys(h).forEach(M=>{d.some($=>$.id===M)||(a=!0)}),!a&&Object.keys(h).length===Object.keys(p).length&&Object.keys(h).every($=>!!p[$])?h:p})},[d]),n.useEffect(()=>{te(h=>{const a={};return d.forEach(p=>{h[p.id]&&(a[p.id]=h[p.id])}),a})},[d]);const[P,se]=n.useState({narrative_why:s.narrative_why||"",narrative_problem:s.narrative_problem||"",narrative_solution:s.narrative_solution||"",narrative_cta:s.narrative_cta||"",narrative_failure:s.narrative_failure||"",narrative_success:s.narrative_success||""}),ae=n.useRef(!1),pe=n.useRef(null),je=n.useRef(s.brand_id),Ke=n.useRef(lt(h=>{l(h)},1e3)).current,[Y,Oe]=n.useState(s.narrative_perfect_fields||{});n.useEffect(()=>{s.brand_id!==je.current&&(console.log("ðŸ”„ PlotPage: Brand switched, syncing data"),se({narrative_why:s.narrative_why||"",narrative_problem:s.narrative_problem||"",narrative_solution:s.narrative_solution||"",narrative_cta:s.narrative_cta||"",narrative_failure:s.narrative_failure||"",narrative_success:s.narrative_success||""}));const a=s.narrative_perfect_fields||{};Oe(a),je.current=s.brand_id},[s.brand_id,s.narrative_perfect_fields]);const Me=n.useRef(u);n.useEffect(()=>{const h=Me.current&&!u;if(ae.current&&!h){Me.current=u;return}h&&(console.log("ðŸ”„ PlotPage: AI generation complete, force syncing results"),ae.current=!1,pe.current&&(clearTimeout(pe.current),pe.current=null)),se({narrative_why:s.narrative_why||"",narrative_problem:s.narrative_problem||"",narrative_solution:s.narrative_solution||"",narrative_cta:s.narrative_cta||"",narrative_failure:s.narrative_failure||"",narrative_success:s.narrative_success||""}),Me.current=u},[u,s.narrative_why,s.narrative_problem,s.narrative_solution,s.narrative_cta,s.narrative_failure,s.narrative_success]),n.useEffect(()=>{u?Z("ai_prefill_narrative"):_e()},[u,Z,_e]),n.useEffect(()=>()=>{pe.current&&clearTimeout(pe.current)},[]);const Ae=n.useCallback((h,a)=>{ae.current=!0,pe.current&&clearTimeout(pe.current),se(p=>R(I({},p),{[h]:a})),Ke({[h]:a}),pe.current=setTimeout(()=>{ae.current=!1},1500)},[Ke]),ze=h=>ie(void 0,null,function*(){console.log("ðŸŽ¯ togglePerfectField called for:",h),console.log("ðŸŽ¯ Current perfectFields:",Y);const a=`narrative_${h}`,p=R(I({},Y),{[a]:!Y[a]});console.log("ðŸŽ¯ New perfectFields:",p),Oe(p);try{console.log("ðŸŽ¯ Calling apiClient.updateBrand with:",{narrative_perfect_fields:p});const M=yield De.updateBrand(s.brand_id,{narrative_perfect_fields:p});console.log("ðŸŽ¯ API response:",M),l({narrative_perfect_fields:p}),console.log("ðŸŽ¯ Perfect field saved successfully!")}catch(M){console.error("âŒ Failed to save perfect field:",M),Oe(Y)}}),Ge=()=>{c(s.brand_id),me(null)},Le=n.useMemo(()=>{var h,a,p,M,$,ne;return!!((h=P.narrative_why)!=null&&h.trim()&&((a=P.narrative_problem)!=null&&a.trim())&&((p=P.narrative_solution)!=null&&p.trim())&&((M=P.narrative_cta)!=null&&M.trim())&&(($=P.narrative_failure)!=null&&$.trim())&&((ne=P.narrative_success)!=null&&ne.trim()))},[P]),Ye=()=>ie(void 0,null,function*(){if(Le){C(!0),Z("ai_refine_narrative");try{const h=yield De.prefillNarrative({brandName:s.brand_name,tagline:s.taglines,about:s.about,vision:s.vision,mission:s.mission,persona:s.persona,buyerProfile:s.buyer_profile,products:s.products,voice:s.voice,existingNarrative:{why:P.narrative_why,problem:P.narrative_problem,solution:P.narrative_solution,cta:P.narrative_cta,failure:P.narrative_failure,success:P.narrative_success},perfectFields:Y});h!=null&&h.narrative&&me(h.narrative)}catch(h){console.error("Failed to refine narrative:",h)}finally{C(!1),_e()}}}),Re=(h,a)=>{Ae({why:"narrative_why",problem:"narrative_problem",solution:"narrative_solution",cta:"narrative_cta",failure:"narrative_failure",success:"narrative_success"}[h],a),me(M=>M?R(I({},M),{[h]:void 0}):null)},Je=()=>ie(void 0,null,function*(){if(!x){alert("This feature is only available for admin accounts");return}const h=`=== BRAND NARRATIVE ===

Why (Purpose): ${P.narrative_why||"(not set)"}

Problem: ${P.narrative_problem||"(not set)"}

Solution: ${P.narrative_solution||"(not set)"}

Call to Action: ${P.narrative_cta||"(not set)"}

Failure Stakes: ${P.narrative_failure||"(not set)"}

Success Vision: ${P.narrative_success||"(not set)"}

Generated by Andora Plot Studio - ${new Date().toLocaleString()}`;try{yield navigator.clipboard.writeText(h),alert("âœ¨ All narrative fields copied to clipboard!")}catch(a){console.error("Failed to copy:",a),alert("Failed to copy to clipboard")}}),rs=()=>ie(void 0,null,function*(){if(!x){alert("This feature is only available for admin accounts");return}if(d.length===0){alert("No characters to copy");return}let h=`=== NARRATIVE CAST ===

`;d.forEach((a,p)=>{const M=Object.values(a.perfect_fields||{}).filter(Boolean).length;h+=`CHARACTER ${p+1}: ${a.character_name||a.name||"Untitled"}
`,h+=`Status: ${a.is_muted?"MUTED":"ACTIVE"} | Perfect Fields: ${M}/${bs}
`,h+=`${"=".repeat(60)}

`,h+=`Character Label: ${a.name||"(not set)"}
`,h+=`Real Name: ${a.character_name||"(not set)"}
`,h+=`Role: ${a.role||"(not set)"}
`,h+=`Age Range: ${a.age_range||"(not set)"}
`,h+=`Work Mode: ${a.work_mode||"(not set)"}

`,h+=`About:
${a.about||"(not set)"}

`,h+=`Personality Type: ${a.personality||"(not set)"}

`,h+=`Persona:
${a.persona||"(not set)"}

`,a.backstory&&(h+=`Backstory:
${a.backstory}

`),a.voice&&(h+=`Voice Notes:
${a.voice}

`),a.emotional_range&&a.emotional_range.length>0&&(h+=`Emotional Range:
${a.emotional_range.join(`
`)}

`),a.personality_tags&&a.personality_tags.length>0&&(h+=`Personality Tags:
${a.personality_tags.join(`
`)}

`),h+=`
`}),h+=`
Generated by Andora Plot Studio - ${new Date().toLocaleString()}`;try{yield navigator.clipboard.writeText(h),alert(`âœ¨ All ${d.length} character(s) copied to clipboard!`)}catch(a){console.error("Failed to copy:",a),alert("Failed to copy to clipboard")}}),Fe=()=>{if(((s==null?void 0:s.brand_type)||"organization")==="individual"&&d.length>=1){alert("Individual brands are limited to 1 character (your personal brand persona). Switch to Organization brand type to add more characters.");return}const a={id:mt(),name:"",character_name:"",role:"",about:"",personality:"",persona:"",backstory:"",voice:"",emotional_range:[],personality_tags:[],perfect_fields:{}},p=[...d,a];A(p),V(p.length-1)},is=()=>{if(d.length===0){f.current||(f.current=!0,Fe()),le(!0),o==null||o(!0);return}le(!0),o==null||o(!0)},Be=()=>{d.length<=1||V(h=>(h-1+d.length)%d.length)},Ze=()=>{d.length<=1||V(h=>(h+1)%d.length)},We=(h,a,p)=>{const M=d.findIndex(J=>J.id===h);if(M===-1)return;const $={};switch(a){case"age_range":$.age_range=p;break;case"work_mode":$.work_mode=p;break;case"personality":$.personality=xt(p,d[M].personality);break;case"persona":$.persona=p;break;case"backstory":$.backstory=p;break;case"voice":$.voice=p;break;case"emotional_range":$.emotional_range=Yt(p);break;case"personality_tags":$.personality_tags=Yt(p);break;case"name":$.name=p;break;case"character_name":$.character_name=p;break;case"role":$.role=p;break;case"about":$.about=p;break}if(Object.keys($).length===0)return;const ne=I(I({},d[M]),$);b(M,$),m(J=>{const Te=J[h];if(!Te)return J;const Xe=I({},Te);if(delete Xe[a],Object.keys(Xe).length===0){const ts=J,{[h]:gs}=ts;return Hs(ts,[Ys(h)])}return R(I({},J),{[h]:Xe})}),oe(ne).catch(J=>{console.error("Failed to save character after applying suggestion:",J)})},He=(h,a)=>ie(void 0,null,function*(){const p=d.find($=>$.id===h);if(!(!p||(p.perfect_fields||{})[a])){te($=>R(I({},$),{[h]:a}));try{const $=yield ms.refineCharacterField(s,a,p,d,(i==null?void 0:i.preferred_ai_model)||"gemini-2.5-flash");if(!$)return;m(ne=>R(I({},ne),{[h]:R(I({},ne[h]||{}),{[a]:$})}))}catch($){console.error("Failed to refine character field:",$)}finally{te($=>R(I({},$),{[h]:null}))}}}),b=(h,a)=>{const p=[...d];p[h]=I(I({},p[h]),a),A(p)},oe=h=>ie(void 0,null,function*(){try{if(console.log("ðŸ” PlotPage.saveCharacter CALLED:",{id:h.id,name:h.name,character_name:h.character_name,hasCharacterName:"character_name"in h,allKeys:Object.keys(h)}),h.id&&h.id.startsWith("new-")){const a=yield De.createCharacter(I({brand_id:s.brand_id},h)),p=d.findIndex(M=>M.id===h.id);if(p>=0){const M=[...d];M[p]=R(I({},M[p]),{id:a.id}),A(M)}}else yield De.updateCharacter(h.id,h)}catch(a){throw console.error("Failed to save character:",a),a}}),ce=h=>ie(void 0,null,function*(){const a=d[h];try{a.id&&!a.id.startsWith("new-")&&(yield De.deleteCharacter(a.id));const p=d.filter((M,$)=>$!==h);A(p),V(M=>p.length===0?0:Math.min(M,p.length-1)),m(M=>{var J;if(!M[a.id])return M;const Te=M,{[J=a.id]:$}=Te;return Hs(Te,[Ys(J)])})}catch(p){console.error("Failed to delete character:",p)}}),ve=h=>ie(void 0,null,function*(){const a=d[h];try{if(a.id&&!a.id.startsWith("new-")){const p=yield De.toggleCharacterMute(a.id),M=[...d];M[h]=R(I({},M[h]),{is_muted:p.is_muted}),A(M),l({cast_management:M})}}catch(p){console.error("Failed to toggle character mute:",p)}}),v=h=>ie(void 0,null,function*(){var M,$,ne,J,Te,Xe,ts,gs,zs;const a=d[h],p=a.character_name||a.real_name||a.name;if(!p||!p.trim()){alert("Please enter at least a name for the character");return}t(!0),Z("ai_resolve_cast");try{const As=Vt(d).map((de,Ve)=>R(I({},de),{_isTarget:Ve===h}));console.log("ðŸ” FRONTEND: Sending request for character persona",{targetIndex:h,targetName:a.name,targetCharacterName:a.character_name,totalCharacters:As.length,targetFlagged:(M=As.find(de=>de._isTarget))==null?void 0:M.name});const Ee=yield De.generateCastWithAI({brandName:s.brand_name,about:s.about,persona:s.persona,buyerProfile:s.buyer_profile},As,N);console.log("ðŸ” FRONTEND: Response received",{model:(($=Ee==null?void 0:Ee.metadata)==null?void 0:$.model)||N,tokens:(ne=Ee==null?void 0:Ee.metadata)==null?void 0:ne.tokensUsed,charactersReturned:(J=Ee==null?void 0:Ee.characters)==null?void 0:J.length,returnedCharacters:(Te=Ee==null?void 0:Ee.characters)==null?void 0:Te.map(de=>{var Ve;return{id:de.id,name:de.name,character_name:de.character_name,personaPreview:(Ve=de.persona)==null?void 0:Ve.substring(0,100)}})});const os=ue((gs=(ts=(Xe=Ee==null?void 0:Ee.characters)!=null?Xe:Ee==null?void 0:Ee.rawCharacters)!=null?ts:Ee==null?void 0:Ee.cast)!=null?gs:Ee),ns=os.find(de=>(de==null?void 0:de.id)===a.id)||os.find(de=>!!(de!=null&&de._isTarget))||os.find(de=>{const Ve=typeof(de==null?void 0:de.name)=="string"?de.name.toLowerCase():"",ls=typeof a.name=="string"?a.name.toLowerCase():"";return Ve!==""&&Ve===ls})||os[h]||os[0];if(console.log("ðŸ” FRONTEND: Matched generated character:",{matchedById:os.find(de=>de.id===a.id)?"YES":"NO",matchedByIndex:!!os[h],generatedId:ns==null?void 0:ns.id,generatedName:ns==null?void 0:ns.name,generatedPersonaPreview:(zs=ns==null?void 0:ns.persona)==null?void 0:zs.substring(0,100)}),!ns){console.warn("No character returned by AI for the requested persona help",{targetIndex:h,targetName:a.name,response:Ee});return}const ys=a.perfect_fields||{},xs={};Tr.forEach(de=>{if(ys[de])return;if(de==="personality"){const js=xt(ns.personality,a.personality),it=xt(a.personality,a.personality);js&&js!==it&&(xs[de]=js);return}const Ve=ns[de];if(!Ve)return;if(Pr.includes(de)){const js=Ht(Ve);if(!js)return;Ht(a[de])!==js&&(xs[de]=js);return}const ls=a[de];typeof Ve=="string"&&Ve.trim().length>0&&(ls||"").trim()!==Ve.trim()&&(xs[de]=Ve)});const Ct=Object.entries(xs).filter(([de])=>!Gt.includes(de));if(Ct.length>0){const de={};if(Ct.forEach(([Ve,ls])=>{switch(Ve){case"age_range":de.age_range=ls;break;case"work_mode":de.work_mode=ls;break;case"persona":de.persona=ls;break;case"name":de.name=ls;break;case"character_name":de.character_name=ls;break;case"role":de.role=ls;break;case"about":de.about=ls;break;default:break}}),Object.keys(de).length>0){const Ve=I(I({},a),de);b(h,de),yield oe(Ve)}}const St=Object.fromEntries(Object.entries(xs).filter(([de])=>Gt.includes(de)));m(de=>{var Ve;if(Object.keys(St).length===0){if(!de[a.id])return de;const ls=de,{[Ve=a.id]:js}=ls;return Hs(ls,[Ys(Ve)])}return R(I({},de),{[a.id]:St})})}catch(As){console.error("Failed to generate character:",As),alert("Failed to generate character. Please try again.")}finally{t(!1),_e()}}),O=()=>ie(void 0,null,function*(){var a,p,M;if(((s==null?void 0:s.brand_type)||"organization")==="individual"&&d.length>=1){alert("Individual brands are limited to 1 character (your personal brand persona). Switch to Organization brand type to add more characters.");return}t(!0),Z("ai_generate_cast");try{const $={id:mt(),name:"",character_name:"",role:"",perfect_fields:{}},ne=[...d,$],J=yield De.generateCastWithAI({brandName:s.brand_name,about:s.about,persona:s.persona,buyerProfile:s.buyer_profile},Vt(ne),N),Te=ue((M=(p=(a=J==null?void 0:J.characters)!=null?a:J==null?void 0:J.rawCharacters)!=null?p:J==null?void 0:J.cast)!=null?M:J),Xe=Te[Te.length-1];if(!Xe)throw new Error("No character returned by AI");const ts=R(I({},Xe),{id:Xe.id||mt()}),gs=[...d,ts];A(gs),V(gs.length-1),yield oe(ts)}catch($){console.error("Failed to suggest character:",$),alert("Failed to suggest next character. Please try again.")}finally{t(!1),_e()}}),K=()=>ie(void 0,null,function*(){T(!0),Z("ai_train_cast");try{yield De.request("/ai/train-character-cast",{method:"POST",body:JSON.stringify({brandId:s.brand_id,characters:d.filter(h=>{const a=h.perfect_fields||{};return Object.values(a).filter(Boolean).length===bs})})}),E(!0)}catch(h){console.error("Failed to train Andora:",h),alert("Failed to train Andora. You can still continue to events."),E(!0)}finally{T(!1),_e()}}),z=d.some(h=>{const a=h.perfect_fields||{};return Object.values(a).filter(Boolean).length===bs});d.some(h=>{const a=h.perfect_fields||{};return Object.values(a).filter(Boolean).length<bs});const B=($e=d[re])!=null?$e:null,X=["narrative_why","narrative_problem","narrative_solution","narrative_cta","narrative_failure","narrative_success"],xe=X.filter(h=>{var a;return(a=P[h])==null?void 0:a.trim()}).length,fe=X.every(h=>Y[h]);n.useEffect(()=>{fe&&Q(!1)},[fe]);const Ne=d.length>0&&d.every(h=>{const a=h.perfect_fields||{};return Object.values(a).filter(Boolean).length===bs});n.useEffect(()=>{Ne&&ye(!1)},[Ne]);const be=d.filter(h=>{const a=h.perfect_fields||{};return Object.values(a).filter(Boolean).length===bs}).length;return d.length&&Math.round(be/d.length*100),n.useMemo(()=>[{id:"narrative",label:"Narrative",description:"Story spine captured",complete:xe===X.length},{id:"cast",label:"Cast",description:`${be}/${Math.max(d.length,1)} personas story-ready`,complete:d.length>0&&be===d.length},{id:"training",label:"Training",description:z?"Ready to brief Andora":"Polish personas to unlock training",complete:_}],[d.length,xe,z,X.length,be,_]),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 space-y-10",children:[e.jsx(kt,{message:ke,show:Ce,modelInfo:ge}),e.jsxs("section",{className:"relative overflow-hidden rounded-3xl border border-primary-500/20 bg-gradient-to-br from-primary-600 via-purple-600 to-slate-900 text-white shadow-xl",children:[e.jsx("div",{className:"absolute inset-0 opacity-40 mix-blend-screen bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.35),transparent_65%)]","aria-hidden":!0}),e.jsx("div",{className:"relative z-10 flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between p-6 sm:p-8",children:e.jsxs("div",{className:"space-y-5 max-w-2xl",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.4em] text-white/70",children:[e.jsx(Ls,{className:"w-4 h-4"}),"Plot studio"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-semibold leading-tight",children:"Write the universe your brand lives in"}),e.jsx("p",{className:"text-sm sm:text-base text-white/80 leading-relaxed",children:"Shape the story spine, build the cast, and get Andora ready to improvise on your behalf. Every detail here trains the narrative engine."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs sm:text-sm text-white/80",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(Pe,{className:"w-3.5 h-3.5"}),"Narrative intelligence"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(Ns,{className:"w-3.5 h-3.5"}),d.length||"No"," personas drafted"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(Rs,{className:"w-3.5 h-3.5"}),u?"Generatingâ€¦":"Autosaved"]})]})]})})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:`rounded-2xl border shadow-sm transition-all ${fe?"border-green-400/50 bg-green-50/30":"border-slate-200/80 bg-white/80"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:()=>Q(!L),className:"p-1 text-slate-500 hover:text-primary-600 transition-colors",title:L?"Collapse":"Expand to edit",children:L?e.jsx(Et,{size:20}):e.jsx(Qs,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-primary-900",children:"Brand Narrative"}),fe&&e.jsx("span",{className:"text-xs text-green-600 font-medium bg-green-100 px-2 py-0.5 rounded-full",children:"Perfect"})]}),!L&&e.jsx("p",{className:"text-slate-500 mt-1 text-sm",children:fe?"Narrative framework complete":"Click to expand and define your story"}),L&&e.jsx("p",{className:"text-slate-600 mt-1 text-sm sm:text-base",children:"Define your brand story using a proven narrative framework"})]})]}),L&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(w,{onClick:()=>ie(void 0,null,function*(){if(fe)return;const h={narrative_why:!0,narrative_problem:!0,narrative_solution:!0,narrative_cta:!0,narrative_failure:!0,narrative_success:!0};Oe(h);try{yield De.updateBrand(s.brand_id,{narrative_perfect_fields:h}),l({narrative_perfect_fields:h}),Z("success"),setTimeout(()=>_e(),2e3)}catch(a){console.error("Failed to mark all perfect",a)}}),variant:"outline",size:"sm",className:`flex items-center text-sm ${fe?"text-green-600 border-green-200 bg-green-50":""}`,disabled:fe,title:"Mark all narrative fields as perfect",children:[e.jsx(Cs,{size:16,className:"mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:fe?"All Perfect":"Mark All Perfect"}),e.jsx("span",{className:"sm:hidden",children:"All âœ“"})]}),x&&e.jsxs(w,{onClick:Je,variant:"outline",size:"sm",className:"flex items-center text-sm",title:"Copy all narrative fields to clipboard (Admin only)",children:[e.jsx(ss,{size:16,className:"mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Copy All"})]}),e.jsxs(w,{onClick:Ge,loading:u,className:"flex items-center text-sm",size:"sm",children:[e.jsx(ds,{size:16,className:"mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Write for Me"}),e.jsx("span",{className:"sm:hidden",children:"AI Fill"})]}),Le&&e.jsxs(w,{onClick:Ye,loading:y,className:"flex items-center text-sm bg-orange-500 hover:bg-orange-600",size:"sm",children:[e.jsx(Pe,{size:16,className:"mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Refine"}),e.jsx("span",{className:"sm:hidden",children:"âœ¨"})]})]})]}),L&&e.jsxs("div",{className:"px-4 sm:px-6 pb-4 sm:pb-6 border-t border-slate-200/50 pt-4 sm:pt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`relative ${Y.narrative_why?"bg-green-50/30 rounded-lg p-2 -m-2":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Why (Purpose)"}),e.jsx("button",{onClick:()=>ze("why"),className:`px-2 py-1 rounded text-xs font-medium transition-all ${Y.narrative_why?"text-green-600 border border-green-400/50 bg-green-50 hover:bg-green-100":"text-slate-500 border border-slate-300 hover:border-slate-400"}`,type:"button",title:Y.narrative_why?"Marked as perfect - AI will skip":"Mark as perfect",children:Y.narrative_why?"âœ“ Perfect":"Mark"})]}),e.jsx(Ie,{value:P.narrative_why,onChange:h=>Ae("narrative_why",h.target.value),placeholder:"Why does your brand exist? What's your higher purpose?",maxLength:qe.narrative_why,showCharCount:!0})]}),e.jsxs("div",{className:`relative ${Y.narrative_problem?"bg-green-50/30 rounded-lg p-2 -m-2":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Problem"}),e.jsx("button",{onClick:()=>ze("problem"),className:`px-2 py-1 rounded text-xs font-medium transition-all ${Y.narrative_problem?"text-green-600 border border-green-400/50 bg-green-50 hover:bg-green-100":"text-slate-500 border border-slate-300 hover:border-slate-400"}`,type:"button",title:Y.narrative_problem?"Marked as perfect - AI will skip":"Mark as perfect",children:Y.narrative_problem?"âœ“ Perfect":"Mark"})]}),e.jsx(Ie,{value:P.narrative_problem,onChange:h=>Ae("narrative_problem",h.target.value),placeholder:"What problem does your customer face?",maxLength:qe.narrative_problem,showCharCount:!0})]}),e.jsxs("div",{className:`relative ${Y.narrative_solution?"bg-green-50/30 rounded-lg p-2 -m-2":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Solution"}),e.jsx("button",{onClick:()=>ze("solution"),className:`px-2 py-1 rounded text-xs font-medium transition-all ${Y.narrative_solution?"text-green-600 border border-green-400/50 bg-green-50 hover:bg-green-100":"text-slate-500 border border-slate-300 hover:border-slate-400"}`,type:"button",title:Y.narrative_solution?"Marked as perfect - AI will skip":"Mark as perfect",children:Y.narrative_solution?"âœ“ Perfect":"Mark"})]}),e.jsx(Ie,{value:P.narrative_solution,onChange:h=>Ae("narrative_solution",h.target.value),placeholder:"How does your brand solve this problem?",maxLength:qe.narrative_solution,showCharCount:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`relative ${Y.narrative_cta?"bg-green-50/30 rounded-lg p-2 -m-2":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Signature Words and Endings"}),e.jsx("button",{onClick:()=>ze("cta"),className:`px-2 py-1 rounded text-xs font-medium transition-all ${Y.narrative_cta?"text-green-600 border border-green-400/50 bg-green-50 hover:bg-green-100":"text-slate-500 border border-slate-300 hover:border-slate-400"}`,type:"button",title:Y.narrative_cta?"Marked as perfect - AI will skip":"Mark as perfect",children:Y.narrative_cta?"âœ“ Perfect":"Mark"})]}),e.jsx(Ie,{value:P.narrative_cta,onChange:h=>Ae("narrative_cta",h.target.value),placeholder:"Signature words, slang, or ending phrases that amplify your brand through consistency. Comma-separated (e.g., 'Raysource fam', 'Building something great', 'Until next time', 'Keep creating')",maxLength:qe.narrative_cta,showCharCount:!0})]}),e.jsxs("div",{className:`relative ${Y.narrative_failure?"bg-green-50/30 rounded-lg p-2 -m-2":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Failure Stakes"}),e.jsx("button",{onClick:()=>ze("failure"),className:`px-2 py-1 rounded text-xs font-medium transition-all ${Y.narrative_failure?"text-green-600 border border-green-400/50 bg-green-50 hover:bg-green-100":"text-slate-500 border border-slate-300 hover:border-slate-400"}`,type:"button",title:Y.narrative_failure?"Marked as perfect - AI will skip":"Mark as perfect",children:Y.narrative_failure?"âœ“ Perfect":"Mark"})]}),e.jsx(Ie,{value:P.narrative_failure,onChange:h=>Ae("narrative_failure",h.target.value),placeholder:"What happens if they don't act?",maxLength:qe.narrative_failure,showCharCount:!0})]}),e.jsxs("div",{className:`relative ${Y.narrative_success?"bg-green-50/30 rounded-lg p-2 -m-2":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Success Vision"}),e.jsx("button",{onClick:()=>ze("success"),className:`px-2 py-1 rounded text-xs font-medium transition-all ${Y.narrative_success?"text-green-600 border border-green-400/50 bg-green-50 hover:bg-green-100":"text-slate-500 border border-slate-300 hover:border-slate-400"}`,type:"button",title:Y.narrative_success?"Marked as perfect - AI will skip":"Mark as perfect",children:Y.narrative_success?"âœ“ Perfect":"Mark"})]}),e.jsx(Ie,{value:P.narrative_success,onChange:h=>Ae("narrative_success",h.target.value),placeholder:"What success looks like for your customers?",maxLength:qe.narrative_success,showCharCount:!0})]})]})]}),W&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-orange-600 flex items-center gap-2",children:[e.jsx(Pe,{size:16}),"Andora's Refinement Suggestions"]}),e.jsxs("div",{className:"space-y-2",children:[W.why&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-orange-700 mb-1",children:"Why (Purpose)"}),e.jsx("p",{className:"text-sm text-slate-700",children:W.why})]}),e.jsx("button",{onClick:()=>Re("why",W.why),className:"shrink-0 p-2 hover:bg-orange-100 rounded-lg transition-colors",title:"Copy to field",children:e.jsx(ss,{size:16,className:"text-orange-600"})})]})}),W.problem&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-orange-700 mb-1",children:"Problem"}),e.jsx("p",{className:"text-sm text-slate-700",children:W.problem})]}),e.jsx("button",{onClick:()=>Re("problem",W.problem),className:"shrink-0 p-2 hover:bg-orange-100 rounded-lg transition-colors",title:"Copy to field",children:e.jsx(ss,{size:16,className:"text-orange-600"})})]})}),W.solution&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-orange-700 mb-1",children:"Solution"}),e.jsx("p",{className:"text-sm text-slate-700",children:W.solution})]}),e.jsx("button",{onClick:()=>Re("solution",W.solution),className:"shrink-0 p-2 hover:bg-orange-100 rounded-lg transition-colors",title:"Copy to field",children:e.jsx(ss,{size:16,className:"text-orange-600"})})]})}),W.cta&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-orange-700 mb-1",children:"Call to Action"}),e.jsx("p",{className:"text-sm text-slate-700",children:W.cta})]}),e.jsx("button",{onClick:()=>Re("cta",W.cta),className:"shrink-0 p-2 hover:bg-orange-100 rounded-lg transition-colors",title:"Copy to field",children:e.jsx(ss,{size:16,className:"text-orange-600"})})]})}),W.failure&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-orange-700 mb-1",children:"Failure Stakes"}),e.jsx("p",{className:"text-sm text-slate-700",children:W.failure})]}),e.jsx("button",{onClick:()=>Re("failure",W.failure),className:"shrink-0 p-2 hover:bg-orange-100 rounded-lg transition-colors",title:"Copy to field",children:e.jsx(ss,{size:16,className:"text-orange-600"})})]})}),W.success&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-orange-700 mb-1",children:"Success Vision"}),e.jsx("p",{className:"text-sm text-slate-700",children:W.success})]}),e.jsx("button",{onClick:()=>Re("success",W.success),className:"shrink-0 p-2 hover:bg-orange-100 rounded-lg transition-colors",title:"Copy to field",children:e.jsx(ss,{size:16,className:"text-orange-600"})})]})})]})]}),e.jsx("div",{className:"flex justify-end mt-6 pt-4 border-t border-primary-200/40",children:e.jsxs("span",{className:"text-xs text-slate-400 flex items-center",children:[e.jsx(Rs,{size:12,className:"mr-1"}),"Changes saved automatically"]})}),e.jsxs("div",{className:"mt-6",children:[e.jsxs(w,{onClick:is,className:"w-full flex items-center justify-center gap-2 py-4 text-base",children:[e.jsx(Pe,{size:18}),"Enter Character Studio"]}),e.jsx("p",{className:"mt-2 text-center text-xs text-slate-500",children:"Jump into detailed personas once your narrative foundations feel strong."})]})]})]}),e.jsxs("div",{className:`rounded-2xl border shadow-sm transition-all ${Ne?"border-green-400/50 bg-green-50/30":"border-slate-200/80 bg-white/80"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:()=>ye(!H),className:"p-1 text-slate-500 hover:text-primary-600 transition-colors",title:H?"Collapse":"Expand",children:H?e.jsx(Et,{size:20}):e.jsx(Qs,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-primary-900",children:"Narrative Cast"}),Ne&&e.jsx("span",{className:"text-xs text-green-600 font-medium bg-green-100 px-2 py-0.5 rounded-full",children:"Perfect"})]}),!H&&d.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:d.map((h,a)=>e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2 py-1 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("span",{className:"text-xs text-slate-700 font-medium",children:h.character_name||h.name||`Character ${a+1}`}),e.jsx("button",{onClick:p=>{p.stopPropagation(),ve(a)},className:`p-0.5 rounded transition-colors ${h.is_muted?"text-slate-400 hover:text-slate-600":"text-primary-500 hover:text-primary-700"}`,title:h.is_muted?"Unmute":"Mute",children:h.is_muted?e.jsx(Xs,{size:14}):e.jsx(ft,{size:14})})]},h.id))}),H&&e.jsx("p",{className:"text-slate-600 mt-1 text-sm sm:text-base",children:"Shape one signature persona at a time. Mark every field perfect and I'll strengthen anything still rough."})]})]}),H&&x&&d.length>0&&e.jsxs(w,{onClick:rs,variant:"outline",size:"sm",className:"flex items-center text-sm",title:"Copy all characters and their fields to clipboard (Admin only)",children:[e.jsx(ss,{size:16,className:"mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Copy All"})]})]}),H&&e.jsx("div",{className:"px-4 sm:px-6 pb-4 sm:pb-6 border-t border-slate-200/50 pt-4 sm:pt-6",children:e.jsxs("div",{className:"space-y-6",children:[S?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Loading your characters..."})]})}):e.jsx(e.Fragment,{children:B?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm text-slate-500",children:[e.jsxs("span",{children:["Character ",re+1," of ",d.length]}),e.jsx("span",{className:"font-medium text-primary-700",children:B.character_name&&B.character_name.trim().length>0?B.character_name:B.name||"Untitled Persona"})]}),e.jsxs("div",{className:"mt-4 p-6 bg-white/50 rounded-lg border border-purple-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:B.name||"Untitled Character"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ve(re),className:`p-2 rounded-lg transition-all ${B.is_muted?"bg-slate-100 text-slate-600 hover:bg-slate-200":"bg-primary-50 text-primary-600 hover:bg-primary-100"}`,title:B.is_muted?"Include in story":"Exclude from story",children:B.is_muted?e.jsx(Xs,{size:18}):e.jsx(ft,{size:18})}),e.jsxs("span",{className:`text-sm px-3 py-1 rounded-full ${Object.values(B.perfect_fields||{}).filter(Boolean).length===bs?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"}`,children:[Object.values(B.perfect_fields||{}).filter(Boolean).length,"/",bs," Perfect"]})]})]}),B.is_muted&&e.jsxs("div",{className:"mb-3 inline-flex items-center gap-1.5 px-3 py-1.5 bg-slate-100 text-slate-700 rounded-full text-xs font-medium",children:[e.jsx(Xs,{size:14}),"Excluded from story"]}),B.character_name&&e.jsxs("p",{className:"text-sm text-slate-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Real Name:"})," ",B.character_name]}),B.role&&e.jsxs("p",{className:"text-sm text-slate-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Role:"})," ",B.role]}),B.persona&&e.jsx("p",{className:"text-sm text-slate-700 mt-3 italic line-clamp-3",children:B.persona})]}),d.length>1&&e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(w,{onClick:Be,size:"sm",variant:"outline",className:"flex items-center gap-1",children:[e.jsx(us,{size:16}),"Previous"]}),e.jsxs(w,{onClick:Ze,size:"sm",variant:"outline",className:"flex items-center gap-1",children:["Next",e.jsx(Qe,{size:16})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:d.map((h,a)=>{var $,ne;const p=(($=h.character_name)==null?void 0:$.trim())||((ne=h.name)==null?void 0:ne.trim())||`Character ${a+1}`,M=a===re;return e.jsx("button",{onClick:()=>V(a),className:`px-3 py-1 rounded-full text-xs font-medium border transition-all ${M?"bg-primary-600 text-white border-primary-600 shadow":"border-primary-200 text-primary-700 hover:bg-primary-100"}`,"aria-label":`Switch to ${p}`,children:p},h.id)})})]})]}):e.jsxs("div",{className:"border border-dashed border-primary-300/60 rounded-xl p-8 text-center bg-white/60",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"No characters yet"}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:"Draft your first persona or let Andora suggest one tailored to your brand."}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-center gap-3",children:[e.jsxs(w,{onClick:Fe,variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ns,{size:16,className:"mr-2"}),"Add Character Manually"]}),e.jsxs(w,{onClick:O,loading:j,className:"w-full sm:w-auto",children:[e.jsx(Pe,{size:16,className:"mr-2"}),"Draft with Andora"]})]})]})}),!S&&e.jsxs(e.Fragment,{children:[((s==null?void 0:s.brand_type)||"organization")==="individual"&&d.length>=1?e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-900",children:[e.jsx("strong",{children:"Individual Brand:"})," You have your personal brand character. To add more characters, switch to ",e.jsx("strong",{children:"Organization"})," brand type in Brand Profile settings."]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(w,{onClick:is,size:"lg",className:"w-full flex items-center justify-center gap-2 py-6 text-base",children:[e.jsx(Pe,{size:20}),"Manage in Character Studio"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(w,{onClick:Fe,className:"w-full",variant:"outline",children:[e.jsx(Ns,{size:16,className:"mr-2"}),d.length===0?"Add Persona":"Add Another Persona"]}),e.jsxs(w,{onClick:O,loading:j,className:"w-full",children:[e.jsx(Pe,{size:16,className:"mr-2"}),d.length===0?"Draft First Character":"Suggest Next Character"]})]})]}),z&&!_&&e.jsxs(w,{onClick:K,loading:F,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700",children:[e.jsx(Bs,{size:16,className:"mr-2"}),F?"Training Andora...":"Characters Are Done"]}),_&&e.jsxs(w,{onClick:()=>ee("/dashboard/events"),className:"w-full bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 animate-bounce",children:[e.jsx(Ps,{size:16,className:"mr-2"}),"Continue to Events"]})]})]})})]}),B&&e.jsx(vr,{character:B,brandId:s.brand_id,isOpen:U,onClose:()=>{le(!1),o==null||o(!1)},onChange:h=>b(re,h),onSave:oe,onDelete:()=>{ce(re),le(!1),o==null||o(!1)},onToggleMute:()=>ve(re),onAIGenerate:()=>v(re),isGenerating:j,suggestions:g[B.id],onSuggestionApply:(h,a)=>We(B.id,h,a),onFieldRefine:He,refiningField:(Ue=G[B.id])!=null?Ue:null,characters:d,activeCharacterIndex:re,onCharacterChange:V,onPreviousCharacter:Be,onNextCharacter:Ze,onAddCharacter:Fe,onSuggestCharacter:O,onAllDone:K,showAllDone:z&&!_,isTraining:F}),we&&e.jsx(wr,{onComplete:q})]})]})})},wn=Object.freeze(Object.defineProperty({__proto__:null,PlotPage:Ir},Symbol.toStringTag,{value:"Module"})),zr=({isOpen:s,onClose:l,selectedDate:r,event:c,brandId:u,userId:o,onSave:N,onDelete:k})=>{const[x,i]=n.useState({description:""});n.useEffect(()=>{c?i({description:c.description}):r&&i({description:""})},[c,r]);const d=m=>{if(m.preventDefault(),console.log("ðŸ“‹ EventModal handleSubmit called"),console.log("ðŸ“ Form data:",x),console.log("ðŸ“… Selected date:",r),console.log("ðŸ¢ Brand ID:",u),console.log("ðŸ‘¤ User ID:",o),x.description.trim()&&r){const j=R(I({},x),{title:x.description.split(`
`)[0]||"Event",event_date:r,brand_id:u,user_id:o});console.log("âœ… Calling onSave with:",j),N(j)}else console.warn("âš ï¸ Cannot save - missing description or date")},A=m=>{(m.ctrlKey||m.metaKey)&&m.key==="Enter"&&(m.preventDefault(),d(m))},g=m=>{if(!m)return"Select a date";const j=m.split("T")[0],t=new Date(j+"T12:00:00Z");return isNaN(t.getTime())?(console.warn("Invalid date:",m),"Invalid date"):t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})};return e.jsx(na,{isOpen:s,onClose:l,title:c?"Edit Entry":"New Entry",size:"md",children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-lg bg-primary-50/50 p-3",children:[e.jsx(ps,{className:"h-5 w-5 text-primary-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Date"}),e.jsx("p",{className:"text-sm font-medium text-primary-900",children:r?g(r):"Select a date"})]})]}),e.jsx(Ie,{label:"Notes",value:x.description,onChange:m=>i(j=>R(I({},j),{description:m.target.value})),onKeyDown:A,placeholder:"What's happening on this day? Add notes, reminders, or important details...",rows:8,maxLength:500,helperText:`${x.description.length}/500 â€¢ Press Ctrl/Cmd+Enter to save`,required:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 sm:gap-0 pt-2",children:[c?e.jsxs(w,{type:"button",variant:"danger",onClick:k,size:"sm",className:"flex items-center gap-1 sm:gap-2 justify-center text-xs sm:text-sm",children:[e.jsx(Us,{size:14,className:"sm:w-4 sm:h-4"}),"Delete"]}):e.jsx("div",{className:"hidden sm:block"}),e.jsxs("div",{className:"flex items-center gap-2 order-first sm:order-none",children:[e.jsx(w,{type:"button",variant:"ghost",onClick:l,size:"sm",className:"flex-1 sm:flex-initial text-xs sm:text-sm",children:"Cancel"}),e.jsxs(w,{type:"submit",className:"flex items-center gap-1 sm:gap-2 justify-center flex-1 sm:flex-initial text-xs sm:text-sm",size:"sm",children:[e.jsx(Rs,{size:14,className:"sm:w-4 sm:h-4"}),"Save"]})]})]})]})})},at=[{bg:"bg-blue-500/20",border:"border-blue-500/30",text:"text-blue-900",hover:"hover:bg-blue-500/30"},{bg:"bg-purple-500/20",border:"border-purple-500/30",text:"text-purple-900",hover:"hover:bg-purple-500/30"},{bg:"bg-pink-500/20",border:"border-pink-500/30",text:"text-pink-900",hover:"hover:bg-pink-500/30"},{bg:"bg-green-500/20",border:"border-green-500/30",text:"text-green-900",hover:"hover:bg-green-500/30"},{bg:"bg-yellow-500/20",border:"border-yellow-500/30",text:"text-yellow-900",hover:"hover:bg-yellow-500/30"},{bg:"bg-orange-500/20",border:"border-orange-500/30",text:"text-orange-900",hover:"hover:bg-orange-500/30"},{bg:"bg-red-500/20",border:"border-red-500/30",text:"text-red-900",hover:"hover:bg-red-500/30"},{bg:"bg-teal-500/20",border:"border-teal-500/30",text:"text-teal-900",hover:"hover:bg-teal-500/30"},{bg:"bg-indigo-500/20",border:"border-indigo-500/30",text:"text-indigo-900",hover:"hover:bg-indigo-500/30"},{bg:"bg-cyan-500/20",border:"border-cyan-500/30",text:"text-cyan-900",hover:"hover:bg-cyan-500/30"}],Zs=s=>{let l=0;for(let r=0;r<s.length;r++)l=(l<<5)-l+s.charCodeAt(r),l=l&l;return at[Math.abs(l)%at.length]},Er=({events:s,onDateClick:l,onEventClick:r,brandId:c,onSubplotSuggestionsReady:u})=>{console.log("ðŸ“… EventsCalendar rendered with events:",s),console.log("ðŸ“Š Total events count:",s.length),console.log("ðŸ“… Event dates:",s.map(L=>({title:L.title,date:L.event_date,dateType:typeof L.event_date})));const[o,N]=n.useState(new Date),[k,x]=n.useState(!1),[i,d]=n.useState(null);n.useState(!1),n.useState(!1),n.useState([]);const[A,g]=n.useState("calendar"),[m,j]=n.useState(!1),t=new Date(Date.UTC(o.getFullYear(),o.getMonth(),1)),F=new Date(Date.UTC(o.getFullYear(),o.getMonth()+1,0)),T=new Date(t);T.setUTCDate(T.getUTCDate()-t.getUTCDay());const _=new Date(F);_.setUTCDate(_.getUTCDate()+(6-F.getUTCDay()));const E=[],S=new Date(T);for(;S<=_;)E.push(new Date(S)),S.setUTCDate(S.getUTCDate()+1);const D=L=>{N(new Date(Date.UTC(o.getFullYear(),o.getMonth()+(L==="next"?1:-1),1)))},G=L=>{const Q=L.getUTCFullYear(),H=String(L.getUTCMonth()+1).padStart(2,"0"),ye=String(L.getUTCDate()).padStart(2,"0");return`${Q}-${H}-${ye}`},te=L=>{const Q=G(L),H=s.filter(ye=>{const f=ye.event_date?ye.event_date.split("T")[0]:"",ee=f===Q;return ye.event_date&&ye.event_date.includes(Q.split("-")[1])&&console.log(`ðŸ” Checking ${ye.title}: event.event_date="${ye.event_date}" â†’ extracted="${f}" vs dateString="${Q}" â†’ ${ee?"âœ… MATCH":"âŒ NO MATCH"}`),ee});return H.length>0&&console.log(`ðŸ“† Found ${H.length} event(s) for ${Q}:`,H),H},re=L=>L.getUTCMonth()===o.getMonth(),V=L=>{const Q=new Date,H=new Date(Date.UTC(Q.getFullYear(),Q.getMonth(),Q.getDate()));return G(L)===G(H)},U=["January","February","March","April","May","June","July","August","September","October","November","December"],le=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],we=n.useMemo(()=>{const L=`${o.getUTCFullYear()}-${String(o.getUTCMonth()+1).padStart(2,"0")}`,Q=s.filter(ee=>{var q;return(q=ee.event_date)==null?void 0:q.startsWith(L)}),ye=new Date().toISOString().split("T")[0],f=s.filter(ee=>(ee.event_date||"").split("T")[0]>=ye).sort((ee,q)=>(ee.event_date||"").localeCompare(q.event_date||""));return{totalThisMonth:Q.length,upcomingCount:f.length,nextEvent:f[0],colorDistribution:at.map((ee,q)=>({color:ee,count:s.filter(ue=>Math.abs(Zs(ue.event_id)===ee?1:0)).length}))}},[s,o]),he=n.useMemo(()=>{const L=`${o.getUTCFullYear()}-${String(o.getUTCMonth()+1).padStart(2,"0")}`;return s.filter(Q=>{var H;return(H=Q.event_date)==null?void 0:H.startsWith(L)}).sort((Q,H)=>(Q.event_date||"").localeCompare(H.event_date||""))},[s,o]);return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 glass-effect rounded-xl border border-primary-200/40 p-3 sm:p-4 md:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>D("prev"),className:"rounded-lg border border-slate-200 bg-white p-2 text-slate-600 transition hover:border-primary-300 hover:text-primary-600",children:e.jsx(us,{size:18})}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>j(!m),className:"min-w-[180px] rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-primary-900 transition hover:border-primary-300",children:[U[o.getMonth()]," ",o.getFullYear()]}),m&&e.jsxs("div",{className:"absolute top-full left-0 mt-2 z-10 rounded-lg border border-slate-200 bg-white shadow-lg p-3 w-64",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:U.map((L,Q)=>e.jsx("button",{onClick:()=>{N(new Date(Date.UTC(o.getFullYear(),Q,1))),j(!1)},className:as("px-2 py-1 text-xs rounded transition",Q===o.getMonth()?"bg-primary-500 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:L.slice(0,3)},L))}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("button",{onClick:()=>N(new Date(Date.UTC(o.getFullYear()-1,o.getMonth(),1))),className:"px-3 py-1 text-xs bg-slate-100 rounded hover:bg-slate-200",children:o.getFullYear()-1}),e.jsx("span",{className:"text-sm font-semibold",children:o.getFullYear()}),e.jsx("button",{onClick:()=>N(new Date(Date.UTC(o.getFullYear()+1,o.getMonth(),1))),className:"px-3 py-1 text-xs bg-slate-100 rounded hover:bg-slate-200",children:o.getFullYear()+1})]})]})]}),e.jsx("button",{onClick:()=>D("next"),className:"rounded-lg border border-slate-200 bg-white p-2 text-slate-600 transition hover:border-primary-300 hover:text-primary-600",children:e.jsx(Qe,{size:18})})]}),e.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 bg-white p-1",children:[e.jsxs("button",{onClick:()=>g("calendar"),className:as("flex items-center gap-2 px-3 py-1.5 rounded text-sm font-medium transition",A==="calendar"?"bg-primary-500 text-white":"text-slate-600 hover:bg-slate-100"),children:[e.jsx(ps,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Calendar"})]}),e.jsxs("button",{onClick:()=>g("daily"),className:as("flex items-center gap-2 px-3 py-1.5 rounded text-sm font-medium transition",A==="daily"?"bg-primary-500 text-white":"text-slate-600 hover:bg-slate-100"),children:[e.jsx(Da,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Daily"})]})]})]}),A==="calendar"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-2 grid grid-cols-7 gap-1 text-center text-xs font-medium text-slate-500",children:le.map(L=>e.jsxs("div",{className:"py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:L}),e.jsx("span",{className:"sm:hidden",children:L.slice(0,1)})]},L))}),e.jsx("div",{className:"grid grid-cols-7 gap-0.5 sm:gap-1",children:E.map((L,Q)=>{const H=te(L),ye=G(L);return e.jsxs("div",{className:as("group relative min-h-[70px] sm:min-h-[90px] rounded-lg sm:rounded-2xl border border-transparent bg-white/70 p-1 sm:p-2 shadow-sm transition-all duration-200","hover:border-primary-400/40 hover:shadow-lg hover:shadow-primary-500/10",!re(L)&&"bg-slate-50 text-slate-400",V(L)&&"border-primary-500/40 bg-primary-500/10 shadow-primary-500/20"),onClick:()=>l(ye),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:as("flex h-5 w-5 sm:h-7 sm:w-7 items-center justify-center rounded-full text-[10px] sm:text-xs font-semibold transition",V(L)?"bg-primary-500 text-white shadow-primary-500/40 shadow-lg":"text-slate-500"),children:L.getUTCDate()}),H.length>0&&e.jsx("span",{className:"rounded-full bg-primary-500/10 px-1 sm:px-2 py-0.5 sm:py-1 text-[8px] sm:text-[10px] font-medium text-primary-600",children:H.length})]}),e.jsxs("div",{className:"mt-1 sm:mt-2 space-y-0.5 sm:space-y-1",children:[H.slice(0,2).map(f=>{const ee=Zs(f.event_id);return e.jsx("div",{className:as("rounded-md sm:rounded-xl border px-1 sm:px-2 py-0.5 sm:py-1 text-[9px] sm:text-xs font-medium transition","truncate bg-white/70",ee.bg,ee.border,ee.text,ee.hover),onClick:q=>{q.stopPropagation(),r(f)},title:f.title,children:f.title},f.event_id)}),H.length>2&&e.jsxs("button",{type:"button",className:"w-full rounded-md sm:rounded-xl bg-primary-500/10 px-1 sm:px-2 py-0.5 sm:py-1 text-[8px] sm:text-[11px] font-semibold text-primary-600 transition hover:bg-primary-500/20",onClick:f=>{f.stopPropagation(),d({date:ye,events:H}),x(!0)},children:["+",H.length-2]})]})]},Q)})})]}),A==="daily"&&e.jsx("div",{className:"space-y-3",children:he.length===0?e.jsxs("div",{className:"py-12 text-center text-slate-500",children:[e.jsx("p",{children:"No events this month"}),e.jsx("p",{className:"text-sm mt-1",children:"Click any date above to add an entry"})]}):he.map(L=>{const Q=Zs(L.event_id),H=L.event_date?new Date(L.event_date.split("T")[0]+"T12:00:00Z"):null;return e.jsxs("div",{className:"flex items-start gap-3 rounded-lg border border-slate-200 bg-white/80 p-4 transition hover:border-primary-300 hover:shadow-sm cursor-pointer",onClick:()=>r(L),children:[e.jsxs("div",{className:"flex flex-col items-center gap-1 shrink-0",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-900",children:H==null?void 0:H.getUTCDate()}),e.jsx("div",{className:"text-xs text-slate-500 uppercase",children:H==null?void 0:H.toLocaleDateString("en-US",{weekday:"short",timeZone:"UTC"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:as("w-2 h-2 rounded-full",Q.bg.replace("/20",""))}),e.jsx("h3",{className:as("font-semibold text-sm",Q.text),children:L.title})]}),L.description&&e.jsx("p",{className:"text-sm text-slate-600 line-clamp-2",children:L.description})]})]},L.event_id)})})]}),e.jsx("div",{className:"hidden lg:block w-64 shrink-0",children:e.jsx("div",{className:"sticky top-6 space-y-4",children:e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/90 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Oa,{size:18,className:"text-primary-500"}),e.jsx("h3",{className:"font-semibold text-sm",children:"Month Insights"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Events this month"}),e.jsx("div",{className:"text-2xl font-bold text-primary-900",children:we.totalThisMonth})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Upcoming events"}),e.jsx("div",{className:"text-lg font-semibold text-emerald-700",children:we.upcomingCount})]}),we.nextEvent&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Next up"}),e.jsx("div",{className:"text-sm font-medium text-slate-700 line-clamp-2",children:we.nextEvent.title}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:new Date(we.nextEvent.event_date||"").toLocaleDateString("en-US",{month:"short",day:"numeric",timeZone:"UTC"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"Event colors"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:at.map((L,Q)=>e.jsx("div",{className:as("w-6 h-6 rounded-full",L.bg.replace("/20","")),title:`Color ${Q+1}`},Q))})]})]})]})})}),k&&i&&e.jsxs(na,{isOpen:k,onClose:()=>x(!1),title:`Events on ${new Date(i.date+"T12:00:00Z").toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric",timeZone:"UTC"})}`,size:"md",children:[e.jsx("div",{className:"space-y-2",children:i.events.map(L=>{const Q=Zs(L.event_id);return e.jsxs("button",{onClick:()=>{x(!1),r(L)},className:as("w-full rounded-lg border px-3 py-2 text-left text-sm transition",Q.bg,Q.border,Q.hover),children:[e.jsx("div",{className:as("font-medium",Q.text),children:L.title}),L.description&&e.jsx("p",{className:"mt-1 text-xs text-slate-600 line-clamp-2",children:L.description})]},L.event_id)})}),e.jsx(w,{className:"mt-4 w-full",size:"sm",onClick:()=>{x(!1),l(i.date)},children:"Add Entry"})]})]})},qt="andora_events_onboarding_completed",Mr=({events:s,brandId:l,userId:r,onEventAdd:c,onEventUpdate:u,onEventDelete:o})=>{const[N,k]=n.useState(null),[x,i]=n.useState(!1),[d,A]=n.useState(null),[g,m]=n.useState(!1),j=n.useMemo(()=>{const S=new Date,D=S.getMonth(),G=S.getFullYear();return s.filter(te=>{if(!te.event_date)return!1;const re=new Date(te.event_date);return re.getMonth()===D&&re.getFullYear()===G}).length},[s]);n.useEffect(()=>{!localStorage.getItem(qt)&&s.length===0&&setTimeout(()=>{m(!0)},300)},[s.length]);const t=S=>{k(S),A(null),i(!0),ks()},F=S=>{A(S),k(S.event_date),i(!0),ks()},T=S=>{console.log("ðŸ’¾ EventsPage handleEventSave called with:",S),console.log("ðŸ“ Editing existing event?",!!d),d?(console.log("âœï¸ Updating event:",d.event_id),u(d.event_id,S)):(console.log("âž• Adding new event"),c(S)),i(!1),A(null),k(null),ks()},_=()=>{d&&(o(d.event_id),i(!1),A(null),k(null),ks())},E=()=>{localStorage.setItem(qt,"true"),m(!1),ks()};return console.log("ðŸ—“ï¸ EventsPage rendered"),console.log("ðŸ“‹ Events prop received:",s),console.log("ðŸ“Š Events count:",s.length),e.jsxs(e.Fragment,{children:[g&&e.jsx(Ga,{onComplete:E}),e.jsxs("div",{className:"mx-auto max-w-6xl px-4 pb-10 pt-6 sm:px-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ps,{className:"h-6 w-6 text-primary-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary-900 sm:text-3xl",children:"Calendar & Journal"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:j>0?`${j} events this month`:"Track important dates and notes"})]})]}),e.jsxs(w,{onClick:()=>{k(new Date().toISOString().split("T")[0]),A(null),i(!0),ks()},className:"inline-flex items-center gap-2",size:"sm",children:[e.jsx(Fs,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"New Entry"})]})]}),e.jsx(Er,{events:s,onDateClick:t,onEventClick:F,brandId:l}),e.jsx(zr,{isOpen:x,onClose:()=>{i(!1),ks()},selectedDate:N,event:d,brandId:l,userId:r,onSave:T,onDelete:_})]})]})},kn=Object.freeze(Object.defineProperty({__proto__:null,EventsPage:Mr},Symbol.toStringTag,{value:"Module"})),Dr=4,da=s=>({week:s,subplot:"",subplotPerfect:!1,custom_theme:""}),Kt=s=>{const l={};for(let r=1;r<=Dr;r+=1)l[r]=da(r);return{month:s,theme:"",themePerfect:!1,themeNarrative:"",monthlyPlot:"",plotPerfect:!1,weekly:l}},Jt=s=>s?typeof s=="string"?{theme:s,narrative:""}:{theme:s.theme||"",narrative:s.explanation||s.description||""}:{theme:"",narrative:""},yt=(s,l)=>{if(l==="individual"){const r=!!(s.persona&&s.persona.trim()),c=!!(s.name&&s.name.trim());return r&&c}return s.perfect_fields?!!(s.perfect_fields.persona&&s.perfect_fields.name&&s.perfect_fields.role):!!s.isPerfect},Or=s=>{var o,N;const l=!!(s.vision&&s.mission&&s.persona&&s.buyer_profile&&s.products),r=((o=s.cast_management)==null?void 0:o.filter(k=>!k.is_muted))||[],c=r.length>0,u=r.every(k=>yt(k,s.brand_type));return s.brand_type==="individual"&&console.log("ðŸ” Season Prerequisites Debug (Individual Brand):",{brand_name:s.brand_name,brand_type:s.brand_type,hasCoreConfig:l,checks:{hasVision:!!s.vision,hasMission:!!s.mission,hasPersona:!!s.persona,hasBuyerProfile:!!s.buyer_profile,hasProducts:!!s.products},hasCast:c,totalCastCount:(N=s.cast_management)==null?void 0:N.length,unmutedCastCount:r.length,allCharactersPerfect:u,characterChecks:r.map(k=>({name:k.name,hasName:!!(k.name&&k.name.trim()),hasPersona:!!(k.persona&&k.persona.trim()),isPerfect:yt(k,s.brand_type),isMuted:k.is_muted})),finalResult:l&&c&&u}),l&&c&&u},Fr=({brand:s,events:l,onBrandUpdate:r,onPageChange:c,preferredModel:u,canEdit:o=!0})=>{var me;const{isAdmin:N,authUser:k}=Is(),[x,i]=n.useState(()=>{const y=new Date;return`${y.getFullYear()}-${String(y.getMonth()+1).padStart(2,"0")}`}),[d,A]=n.useState(()=>{var pe,je;const y=(pe=s.season_plans)==null?void 0:pe[x],C=Kt(x),{theme:P,narrative:se}=Jt((je=s.monthly_themes)==null?void 0:je[x]);if(!y)return R(I({},C),{theme:P||C.theme,themeNarrative:se||C.themeNarrative});const ae=R(I(I({},C),y),{weekly:I(I({},C.weekly),y.weekly)});return R(I({},ae),{theme:ae.theme||P,themeNarrative:ae.themeNarrative||se})}),[g,m]=n.useState(!1),[j,t]=n.useState(!1),[F,T]=n.useState(null),[_,E]=n.useState(null),[S,D]=n.useState(!1),[G,te]=n.useState(null),re=n.useRef(!1),V=n.useRef(0),U=n.useCallback((y,C)=>{const P=y.trim(),se=C==null?void 0:C.trim();return P?se?{theme:P,explanation:se,description:se}:P:""},[]),le=n.useRef(lt(y=>{console.log("ðŸ’¾ Saving season plan updates for",x),r({season_plans:R(I({},s.season_plans),{[x]:y}),monthly_themes:R(I({},s.monthly_themes),{[x]:U(y.theme,y.themeNarrative)})}),re.current=!1},1e3)).current,we=n.useCallback(y=>{o&&(console.log("ðŸ’¾ Immediate save for",x),r({season_plans:R(I({},s.season_plans),{[x]:y}),monthly_themes:R(I({},s.monthly_themes),{[x]:U(y.theme,y.themeNarrative)})}))},[o,x,s.season_plans,s.monthly_themes,r,U]),he=n.useMemo(()=>new Date(x+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),[x]);n.useEffect(()=>{var P,se,ae,pe,je;if(!(Date.now()-V.current<2e3)){console.log("ðŸ“‚ðŸ“‚ðŸ“‚ LOADING CACHED DATA FROM DATABASE ðŸ“‚ðŸ“‚ðŸ“‚"),console.log("ðŸ” Month:",x);const Ke=(P=s.season_plans)==null?void 0:P[x],Y=Kt(x),{theme:Oe,narrative:Me}=Jt((se=s.monthly_themes)==null?void 0:se[x]),Ae=Ke?R(I(I({},Y),Ke),{weekly:I(I({},Y.weekly),Ke.weekly)}):Y,ze=R(I({},Ae),{theme:Ae.theme||Oe,themeNarrative:Ae.themeNarrative||Me});(ae=s.season_plans)!=null&&ae[x]?(console.log("ðŸ’¾ Found existing plan in database:"),console.log("  - Theme:",((pe=Ae.theme)==null?void 0:pe.substring(0,80))+"..."),console.log("  - Monthly Plot:",((je=Ae.monthlyPlot)==null?void 0:je.substring(0,80))+"..."),console.log("  - Theme Perfect:",Ae.themePerfect),console.log("  - Plot Perfect:",Ae.plotPerfect),console.log('âš ï¸  This is OLD DATA - Click "Generate for Me" to use new multi-agent system!')):console.log("ðŸ†• No existing plan - starting fresh"),A(ze)}},[s.season_plans,s.monthly_themes,x]),n.useEffect(()=>{if(!(g||j||F!==null))return;console.log("ðŸ”„ Starting auto-refresh polling (AI generation in progress)");const C=setInterval(()=>ie(void 0,null,function*(){try{const{apiClient:P}=yield Nt(()=>ie(void 0,null,function*(){const{apiClient:ae}=yield import("./admin-Cm5kHlQR.js").then(pe=>pe.e);return{apiClient:ae}}),__vite__mapDeps([0,1,2,3])),se=yield P.getBrand(s.brand_id);r(se),console.log("âœ… Auto-refreshed brand data")}catch(P){console.error("âŒ Failed to auto-refresh brand data:",P)}}),3e3);return()=>{console.log("ðŸ›‘ Stopping auto-refresh polling"),clearInterval(C)}},[g,j,F,s.brand_id,r]);const L=n.useMemo(()=>{const[y,C]=x.split("-").map(Number),P=new Date(y,C-2,1),se=`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}`,ae=new Date(y,C,1),pe=`${ae.getFullYear()}-${String(ae.getMonth()+1).padStart(2,"0")}`;return{previous:l.filter(je=>je.event_date.startsWith(se)),current:l.filter(je=>je.event_date.startsWith(x)),next:l.filter(je=>je.event_date.startsWith(pe)),all:l.filter(je=>je.event_date.startsWith(se)||je.event_date.startsWith(x)||je.event_date.startsWith(pe))}},[l,x]),Q=s.cast_management||[],H=n.useCallback((y,C=!1)=>{o&&(V.current=Date.now(),re.current=!0,A(P=>{const se=R(I(I({},P),y),{weekly:y.weekly?I(I({},P.weekly),y.weekly):P.weekly});return C?we(se):le(se),se}))},[o,we,le]),ye=n.useCallback((y,C)=>{o&&(console.log("ðŸ”„ Theme changing to:",y.substring(0,50)),V.current=Date.now(),re.current=!0,A(P=>{var pe;const se=Object.keys(P.weekly).reduce((je,Ke)=>{const Y=Number(Ke);return je[Y]=R(I({},P.weekly[Y]),{subplotPerfect:!1}),je},{}),ae=R(I({},P),{theme:y,themePerfect:!1,themeNarrative:((pe=C==null?void 0:C.explanation)==null?void 0:pe.trim())||"",monthlyPlot:"",plotPerfect:!1,weekly:se});return le(ae),ae}))},[o,le]),f=n.useCallback(()=>{o&&(V.current=Date.now(),re.current=!0,A(y=>{const C=R(I({},y),{themePerfect:!y.themePerfect});return we(C),C}))},[o,we]),ee=n.useCallback(()=>{o&&(V.current=Date.now(),re.current=!0,A(y=>{const C=R(I({},y),{plotPerfect:!y.plotPerfect});return we(C),C}))},[o,we]),q=n.useCallback((y,C,P=!1)=>{o&&(V.current=Date.now(),re.current=!0,A(se=>{var je;const ae=R(I(I({},se.weekly[y]),C),{subplotPerfect:C.subplotPerfect!==void 0?C.subplotPerfect:((je=se.weekly[y])==null?void 0:je.subplotPerfect)||!1}),pe=R(I({},se),{weekly:R(I({},se.weekly),{[y]:ae})});return P?we(pe):le(pe),pe}))},[o,we,le]),ue=()=>ie(void 0,null,function*(){var y,C,P,se,ae,pe,je,Ke,Y,Oe,Me,Ae,ze,Ge,Le,Ye,Re,Je,rs,Fe,is,Be,Ze;if(o){m(!0),E(null);try{const We=d.theme,{theme:He,explanation:b,weeks:oe}=yield ms.generateTheme(s,x,L.all,u||(k==null?void 0:k.preferred_ai_model)||"gemini-2.5-flash",We),ce=b||"";let ve="";const v={};if(oe&&Object.keys(oe).length>0)console.log("âœ… Using pre-parsed weeks from backend:",Object.keys(oe)),ve=((y=ce.split(/\n\n+/)[0])==null?void 0:y.trim())||""||`This month focuses on ${He.toLowerCase()}. The narrative arc spans four weeks, building from initial engagement through rising action to climax and resolution.`,Object.entries(oe).forEach(([K,z])=>{const B=parseInt(K,10);if(B>=1&&B<=4&&z){const X=z.match(/^WEEK\s+\d+\s+-\s+([^:]+):/i),xe=X?X[1].trim():`Week ${B}`;v[B]={theme:xe,subplot:z.trim()}}}),console.log("ðŸ“¦ Extracted weekly data:",Object.keys(v).map(K=>`Week ${K}: ${v[parseInt(K)].theme}`));else if(console.log("âš ï¸ No pre-parsed weeks from backend, falling back to text parsing"),/\*\*WEEK\s+(\d+)\s+-\s+([^(]+)\s*\([^)]+\)\s*:\*\*/gi.test(ce)){console.log("ðŸ“– Detected inline week format with **WEEK N - TITLE**"),console.log("ðŸ“„ Full text length:",ce.length),ve=((C=ce.split(/\*\*WEEK\s+\d+/i)[0])==null?void 0:C.trim())||"",ve=((P=ve.split(/\*\*Visual|Visual & Tonal|Content Sparks/i)[0])==null?void 0:P.trim())||ve,console.log("ðŸ“ Monthly plot extracted:",ve.substring(0,100)+"...");const B=[...ce.matchAll(/\*\*WEEK\s+(\d+)\s+-\s+([^(]+?)\s*\(([^)]+)\)\s*:\*\*\s*((?:(?!\*\*WEEK|\*\*Visual|\*\*Content Sparks)[\s\S])*)/gi)];console.log(`ðŸ” Found ${B.length} week matches`),B.forEach((X,xe)=>{const[fe,Ne,be,$e,Ue]=X,h=parseInt(Ne,10);console.log(`
ðŸ“Œ Week ${h}:`),console.log("  Title:",be.trim()),console.log("  Stage:",$e.trim()),console.log("  Content preview:",Ue.trim().substring(0,100)+"..."),console.log("  Content length:",Ue.trim().length),h>=1&&h<=4&&(v[h]={theme:be.trim(),subplot:Ue.trim()})}),console.log(`
âœ… Final weekly data:`,Object.keys(v).map(X=>`Week ${X}: ${v[parseInt(X)].theme}`))}else{console.log("ðŸ“– Detected paragraph week format with (Week N)");const z=ce.split(/\n\n+/).filter(X=>X.trim()),B=[];z.forEach(X=>{/\(Week\s+\d+\)/i.test(X)?B.push(X):!ve&&!X.match(/VISUAL CONTENT|visual content/i)&&(ve=X.trim())}),B.forEach(X=>{if(X&&!X.match(/VISUAL CONTENT|visual content/i)){const xe=X.match(/^([A-Z\s]+)\s*\((?:Week\s+)?(\d+)\)\s*:\s*([\s\S]+)$/i);if(xe){const[,fe,Ne,be]=xe,$e=parseInt(Ne,10);$e>=1&&$e<=4&&(v[$e]={theme:fe.trim(),subplot:be.trim()})}else{const fe=X.match(/Week\s+(\d+)/i);if(fe){const Ne=parseInt(fe[1],10);if(Ne>=1&&Ne<=4){const be=X.indexOf(":"),$e=X.substring(0,be>-1?be:50).replace(/Week\s+\d+/i,"").trim(),Ue=be>-1?X.substring(be+1).trim():X;v[Ne]={theme:$e||`Week ${Ne}`,subplot:Ue}}}}}})}ve||(ve=`This month focuses on ${He.toLowerCase()}. The narrative arc spans four weeks, building from initial engagement through rising action to climax and resolution.`),console.log(`
ðŸ’¾ Saving to state:`),console.log("Theme:",He),console.log("Monthly Plot:",ve.substring(0,100)+"..."),console.log("Week 1:",{theme:((se=v[1])==null?void 0:se.theme)||"(empty)",subplotLength:((pe=(ae=v[1])==null?void 0:ae.subplot)==null?void 0:pe.length)||0}),console.log("Week 2:",{theme:((je=v[2])==null?void 0:je.theme)||"(empty)",subplotLength:((Y=(Ke=v[2])==null?void 0:Ke.subplot)==null?void 0:Y.length)||0}),console.log("Week 3:",{theme:((Oe=v[3])==null?void 0:Oe.theme)||"(empty)",subplotLength:((Ae=(Me=v[3])==null?void 0:Me.subplot)==null?void 0:Ae.length)||0}),console.log("Week 4:",{theme:((ze=v[4])==null?void 0:ze.theme)||"(empty)",subplotLength:((Le=(Ge=v[4])==null?void 0:Ge.subplot)==null?void 0:Le.length)||0}),H({theme:He,themePerfect:!1,themeNarrative:b||"",monthlyPlot:ve,plotPerfect:!1,weekly:{1:{week:1,custom_theme:((Ye=v[1])==null?void 0:Ye.theme)||"",subplot:((Re=v[1])==null?void 0:Re.subplot)||"",subplotPerfect:!1},2:{week:2,custom_theme:((Je=v[2])==null?void 0:Je.theme)||"",subplot:((rs=v[2])==null?void 0:rs.subplot)||"",subplotPerfect:!1},3:{week:3,custom_theme:((Fe=v[3])==null?void 0:Fe.theme)||"",subplot:((is=v[3])==null?void 0:is.subplot)||"",subplotPerfect:!1},4:{week:4,custom_theme:((Be=v[4])==null?void 0:Be.theme)||"",subplot:((Ze=v[4])==null?void 0:Ze.subplot)||"",subplotPerfect:!1}}},!0),console.log("âœ… State update triggered"),te({theme:He,monthlyPlot:ve,fullResponse:b||"",weeks:v}),D(!0)}catch(We){console.error("Error generating theme:",We),E("Unable to generate a theme. Please try again.")}finally{m(!1)}}}),ke=()=>ie(void 0,null,function*(){if(!(!d.theme||!o)){t(!0),E(null);try{const{plot:y,fullPreview:C,weeks:P}=yield ms.generateMonthlyPlot(s,x,d.theme,L.all,Q,u||(k==null?void 0:k.preferred_ai_model)||"gemini-2.5-flash");H({monthlyPlot:(y==null?void 0:y.trim())||"",plotPerfect:!1}),console.log("ðŸ“… Weeks data received:",P),P?(console.log("ðŸ“… Processing weeks..."),Object.entries(P).forEach(([se,ae])=>{if(console.log(`ðŸ“… Week ${se}:`,{hasContent:!!ae,length:(ae==null?void 0:ae.length)||0,preview:ae==null?void 0:ae.substring(0,50)}),ae&&ae.trim()){const pe=Number(se);console.log(`âœ… Updating week ${pe} with content`),q(pe,{subplot:ae.trim(),subplotPerfect:!1})}})):console.warn("âš ï¸ No weeks data in response"),C&&(te({theme:d.theme,monthlyPlot:(y==null?void 0:y.trim())||"",fullResponse:C}),D(!0))}catch(y){console.error("Error generating plot:",y),E("Unable to generate a monthly plot. Adjust the theme or try again.")}finally{t(!1)}}}),ge=y=>ie(void 0,null,function*(){if(!o)return;const C=d.weekly[y];if(!(!d.theme||!d.monthlyPlot)){T(y),E(null);try{const P=y>1?d.weekly[y-1]:void 0,{subplot:se,weekTheme:ae}=yield ms.generateWeeklySubplot(s,x,y,d.theme,d.monthlyPlot||"",L.all,P==null?void 0:P.subplot,C.custom_theme||"",Q,void 0),pe={subplot:se};ae&&!C.custom_theme&&(pe.custom_theme=ae),q(y,pe)}catch(P){console.error("Error generating subplot:",P),E(`Unable to generate Week ${y}. Try adjusting the weekly focus.`)}finally{T(null)}}}),Ce=()=>ie(void 0,null,function*(){if(!N){E("This feature is only available for admin accounts"),setTimeout(()=>E(null),3e3);return}let y=`=== SEASON PLAN - ${he} ===

`;y+=`MONTHLY THEME:
${d.theme||"(not set)"}

`,d.themeNarrative&&(y+=`THEME NARRATIVE:
${d.themeNarrative}

`),y+=`MONTHLY PLOT:
${d.monthlyPlot||"(not set)"}

`,y+=`${"=".repeat(60)}
WEEKLY SUBPLOTS
${"=".repeat(60)}

`,[1,2,3,4].forEach(C=>{const P=d.weekly[C];P&&(y+=`WEEK ${C}${P.custom_theme?` - ${P.custom_theme}`:""}
`,y+=`Status: ${P.subplotPerfect?"Perfect âœ“":"In Progress"}
`,y+=`${"â”€".repeat(40)}
`,y+=`${P.subplot||"(not set)"}

`)}),y+=`
Generated by Andora Season Planning - ${new Date().toLocaleString()}`;try{yield navigator.clipboard.writeText(y),E("âœ¨ Season plan copied to clipboard!"),setTimeout(()=>E(null),3e3)}catch(C){console.error("Failed to copy:",C),E("Failed to copy to clipboard"),setTimeout(()=>E(null),3e3)}});if(!Or(s)){const y=!!(s.vision&&s.mission&&s.persona&&s.buyer_profile&&s.products),C=((me=s.cast_management)==null?void 0:me.filter(ae=>!ae.is_muted))||[],P=C.length>0,se=C.every(ae=>yt(ae,s.brand_type));return e.jsx("div",{className:"max-w-3xl mx-auto p-6 sm:p-10",children:e.jsx("div",{className:"rounded-2xl border border-accent-500/40 bg-accent-500/10 p-6 sm:p-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-5",children:[e.jsx(es,{size:"lg",className:"shadow-xl ring-2 ring-accent-500/50"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-accent-300 font-semibold",children:"Season planning locked"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-primary-900 mt-1",children:"Let me gather the narrative context first"}),e.jsx("p",{className:"text-sm text-primary-900/80 mt-3 leading-relaxed",children:"I need your complete brand foundation before we craft seasonal narratives. Here's what's needed:"}),e.jsxs("ul",{className:"text-sm text-primary-900/80 mt-3 space-y-2 list-disc list-inside",children:[!y&&e.jsxs("li",{children:["Complete your ",e.jsx("strong",{children:"Brand Configuration"})," (vision, mission, persona, buyer profile, and products)"]}),!P&&e.jsxs("li",{children:["Create at least one ",e.jsx("strong",{children:"Character"})," in your Character Studio"]}),P&&!se&&e.jsxs("li",{children:["Mark all ",e.jsx("strong",{children:"unmuted characters as perfect"})," in Character Studio (ensure name, role, and persona are complete). Muted characters are excluded from this check."]})]})]})]})})})}const _e=d.themePerfect&&d.plotPerfect&&[1,2,3,4].every(y=>{var C,P;return((C=d.weekly[y])==null?void 0:C.subplotPerfect)&&((P=d.weekly[y])==null?void 0:P.subplot)}),Se=()=>g?"Crafting your monthly theme...":j?"Writing your monthly plot with character context...":F?`Generating week ${F} subplot...`:"",W=g||j||F!==null;return e.jsx("div",{className:"relative min-w-0 overflow-x-hidden",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-4 sm:py-6 lg:py-8 space-y-6 sm:space-y-8 lg:space-y-10",children:[e.jsx(kt,{show:W,message:Se()}),e.jsxs("section",{className:"relative overflow-hidden rounded-2xl sm:rounded-3xl border border-primary-500/20 bg-gradient-to-br from-primary-600 via-purple-600 to-slate-900 text-white shadow-xl",children:[e.jsx("div",{className:"absolute inset-0 opacity-40 mix-blend-screen bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.35),transparent_65%)]","aria-hidden":!0}),e.jsx("div",{className:"relative z-10 flex flex-col gap-4 sm:gap-6 lg:flex-row lg:items-center lg:justify-between p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"space-y-3 sm:space-y-5 max-w-2xl min-w-0",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.4em] text-white/70",children:[e.jsx(Ls,{className:"w-4 h-4"}),"Season planning"]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-semibold leading-tight break-words",children:"Architect the narrative arc"}),e.jsx("p",{className:"text-xs sm:text-sm lg:text-base text-white/80 leading-relaxed",children:"Shape monthly themes and weekly subplots that turn your brand story into structured, engaging content journeys."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm text-white/80",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(Pe,{className:"w-3.5 h-3.5"}),"Strategic storytelling"]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(ps,{className:"w-3.5 h-3.5"}),he]}),e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-3 py-1",children:[e.jsx(Rs,{className:"w-3.5 h-3.5"}),"Autosaved"]})]})]})})]}),!o&&e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border border-orange-200 bg-orange-50/50 p-3 sm:p-4 flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx(Vs,{size:18,className:"text-orange-600 shrink-0 sm:w-5 sm:h-5"}),e.jsx("p",{className:"text-xs sm:text-sm text-orange-900 break-words",children:"You currently have view-only access. Ask your workspace admin to grant editing rights to adjust the season plan."})]}),_&&e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border border-accent-500/30 bg-accent-500/10 p-3 sm:p-4 flex items-start gap-2 sm:gap-3 min-w-0",children:[e.jsx(es,{size:"sm",className:"shadow-lg ring-2 ring-accent-500/40 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-accent-600 font-semibold mb-1",children:"Andora heads-up"}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed break-words",children:_})]})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6 lg:space-y-8 min-w-0",children:[e.jsx("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200/80 bg-white/80 backdrop-blur-sm shadow-sm p-3 sm:p-4 lg:p-6 min-w-0",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3 sm:mb-4 min-w-0",children:[e.jsx("h2",{className:"text-base sm:text-lg lg:text-xl font-semibold text-slate-900 truncate",children:"Select Planning Month"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[N&&e.jsxs(w,{onClick:Ce,variant:"outline",size:"sm",className:"flex items-center text-sm",title:"Copy entire season plan to clipboard (Admin only)",children:[e.jsx(ss,{size:16,className:"mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Copy All"})]}),e.jsx(ps,{size:20,className:"text-primary-600"}),e.jsx("input",{type:"month",value:x,onChange:y=>i(y.target.value),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-slate-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})}),e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200/80 bg-white/80 backdrop-blur-sm shadow-sm p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg sm:text-xl font-semibold text-primary-900",children:["Monthly Theme: ",he]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Define the overarching theme and messaging strategy. I'll use this everywhere."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d.themeNarrative&&e.jsxs(w,{onClick:()=>{const y={};[1,2,3,4].forEach(C=>{const P=d.weekly[C];P&&P.subplot&&(y[C]={theme:P.custom_theme||"",subplot:P.subplot})}),te({theme:d.theme,monthlyPlot:d.monthlyPlot||"",fullResponse:d.themeNarrative,weeks:Object.keys(y).length>0?y:void 0}),D(!0)},variant:"outline",size:"sm",className:"flex items-center text-sm",children:[e.jsx(ea,{size:16,className:"mr-2"}),"View Preview"]}),e.jsxs(w,{onClick:ue,loading:g,className:"flex items-center text-sm",size:"sm",disabled:!o,children:[e.jsx(ds,{size:16,className:"mr-2"}),"Generate for Me"]}),e.jsxs(w,{variant:d.themePerfect?"default":"outline",onClick:f,size:"sm",className:"flex items-center",disabled:!o,children:[e.jsx(Vs,{size:16,className:"mr-2"}),d.themePerfect?"Marked Perfect":"Mark as Perfect"]})]})]}),e.jsx(Ie,{value:d.theme,onChange:y=>ye(y.target.value),placeholder:"Define the overarching theme and messaging strategy for this month...",rows:6,disabled:!o}),e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("span",{className:"text-xs text-slate-500",children:"Auto-saves as you type"})})]}),d.theme&&e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200/80 bg-white/80 backdrop-blur-sm shadow-sm p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-primary-900",children:"Monthly Plot"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Transform your theme into a narrative arc that unlocks the weekly subplots."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(w,{onClick:ke,loading:j,className:"flex items-center text-sm",size:"sm",disabled:!o,children:[e.jsx(ds,{size:16,className:"mr-2"}),"Generate for Me"]}),e.jsxs(w,{variant:d.plotPerfect?"default":"outline",onClick:ee,size:"sm",className:"flex items-center",disabled:!o,children:[e.jsx(Vs,{size:16,className:"mr-2"}),d.plotPerfect?"Marked Perfect":"Mark as Perfect"]})]})]}),e.jsx(Ie,{value:d.monthlyPlot||"",onChange:y=>H({monthlyPlot:y.target.value,plotPerfect:!1}),placeholder:"Describe the suspenseful monthly overview I'll use to craft each week.",rows:5,disabled:!o}),e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("span",{className:"text-xs text-slate-500",children:"Auto-saves as you type"})})]}),d.monthlyPlot&&e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200/80 bg-white/80 backdrop-blur-sm shadow-sm p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4 min-w-0",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-slate-900",children:"Weekly Subplots"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Unlock each week sequentially. Mark a week as perfect to progress to the next."}),e.jsx("div",{className:"space-y-6",children:[1,2,3,4].map(y=>{var pe;const C=d.weekly[y]||da(y),se=!(y===1?d.plotPerfect:(pe=d.weekly[y-1])==null?void 0:pe.subplotPerfect),ae=F===y;return e.jsxs("div",{className:`border rounded-xl p-4 transition-all ${se?"opacity-70 pointer-events-none border-slate-200 bg-slate-50/50":"border-slate-200 bg-white"}`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-primary-900",children:["Week ",y]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Focus the story for this week and I'll generate the rest for you."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(w,{size:"sm",onClick:()=>ge(y),loading:ae,className:"flex items-center text-xs",disabled:!o||se,children:[e.jsx(ds,{size:14,className:"mr-1"}),"Generate for Me"]}),e.jsxs(w,{variant:C.subplotPerfect?"default":"outline",size:"sm",onClick:()=>q(y,{subplotPerfect:!C.subplotPerfect},!0),className:"flex items-center text-xs",disabled:!o||se,children:[e.jsx(Vs,{size:14,className:"mr-1"}),C.subplotPerfect?"Perfect":"Mark Perfect"]})]})]}),e.jsx(cs,{label:"Theme for the Week (optional)",value:C.custom_theme||"",onChange:je=>q(y,{custom_theme:je.target.value}),placeholder:"e.g. Customer wins with product-led innovation",disabled:!o||se}),e.jsx(Ie,{label:"Weekly Subplot",value:C.subplot||"",onChange:je=>q(y,{subplot:je.target.value}),placeholder:`Describe the story beat for week ${y}.`,rows:4,className:"mt-3",disabled:!o||se})]},y)})})]}),_e&&e.jsx("div",{className:"rounded-2xl border border-green-500/30 bg-green-500/10 p-6 shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(gt,{className:"w-8 h-8 text-green-400"})})}),e.jsx("h3",{className:"text-xl font-semibold text-green-300 mb-2",children:"Season Planning Complete! ðŸŽ‰"}),e.jsx("p",{className:"text-green-200 mb-6",children:"Your monthly theme, plot, and weekly subplots are ready. Time to create your detailed content calendar!"}),c&&e.jsx(w,{onClick:()=>c("monthly"),size:"lg",className:"bg-green-600 hover:bg-green-500",children:"Go to Content Calendar â†’"})]})}),S&&G&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"rounded-2xl border border-primary-200 bg-white max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-purple-600 to-slate-900 text-white p-6 flex items-start gap-4",children:[e.jsx(es,{size:"lg",animate:!1,className:"ring-2 ring-white/30 shadow-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-semibold mb-2",children:"Here's the month's scripting"}),e.jsxs("p",{className:"text-sm text-white/80 leading-relaxed",children:[G.monthlyPlot.substring(0,150),"..."]})]}),e.jsx("button",{onClick:()=>D(!1),className:"text-white/80 hover:text-white transition p-1","aria-label":"Close preview",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 bg-white",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500 mb-2",children:"Monthly Theme"}),e.jsx("p",{className:"text-lg font-semibold text-primary-900",children:G.theme})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500 mb-2",children:"Monthly Plot"}),e.jsx("p",{className:"text-base text-slate-700 leading-relaxed",children:G.monthlyPlot})]}),G.weeks&&Object.keys(G.weeks).length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500 mb-3",children:"Weekly Subplots"}),e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(y=>{var P;const C=(P=G.weeks)==null?void 0:P[y];return!C||!C.subplot?null:e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsxs("h5",{className:"text-sm font-semibold text-primary-900 mb-2",children:["Week ",y,C.theme?`: ${C.theme}`:""]}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed whitespace-pre-wrap",children:C.subplot})]},y)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500 mb-3",children:"Full Narrative Breakdown"}),e.jsx("div",{className:"prose prose-sm max-w-none text-slate-700 whitespace-pre-wrap bg-slate-50 rounded-lg p-4 border border-slate-200",children:G.fullResponse})]})]}),e.jsxs("div",{className:"border-t border-slate-200 p-4 bg-slate-50 flex items-center justify-between gap-3",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>D(!1),children:"Close"}),e.jsxs(w,{size:"sm",onClick:()=>ie(void 0,null,function*(){try{let y="";G.weeks&&Object.keys(G.weeks).length>0&&(y=`

WEEKLY SUBPLOTS:
`,[1,2,3,4].forEach(C=>{var se;const P=(se=G.weeks)==null?void 0:se[C];P&&P.subplot&&(y+=`
WEEK ${C}${P.theme?` - ${P.theme}`:""}:
${P.subplot}
`)})),yield navigator.clipboard.writeText(`MONTHLY THEME: ${G.theme}

MONTHLY PLOT:
${G.monthlyPlot}`+y+`

FULL BREAKDOWN:
${G.fullResponse}`),E("âœ¨ Copied to clipboard!"),setTimeout(()=>E(null),3e3)}catch(y){console.error("Failed to copy:",y),E("Failed to copy to clipboard")}}),className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy to Clipboard"]})]})]})})]})]})})},_n=Object.freeze(Object.defineProperty({__proto__:null,SeasonPage:Fr},Symbol.toStringTag,{value:"Module"})),Lr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Rr={LinkedIn:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-300/60",hover:"hover:bg-blue-200"},Instagram:{bg:"bg-pink-100",text:"text-pink-700",border:"border-pink-300/60",hover:"hover:bg-pink-200"},X:{bg:"bg-cyan-100",text:"text-cyan-700",border:"border-cyan-300/60",hover:"hover:bg-cyan-200"},Facebook:{bg:"bg-indigo-100",text:"text-indigo-700",border:"border-indigo-300/60",hover:"hover:bg-indigo-200"},TikTok:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-300/60",hover:"hover:bg-purple-200"},YouTube:{bg:"bg-red-100",text:"text-red-700",border:"border-red-300/60",hover:"hover:bg-red-200"},Blog:{bg:"bg-green-100",text:"text-green-700",border:"border-green-300/60",hover:"hover:bg-green-200"},Email:{bg:"bg-amber-100",text:"text-amber-700",border:"border-amber-300/60",hover:"hover:bg-amber-200"}},Br=s=>Rr[s]||{bg:"bg-slate-100",text:"text-slate-700",border:"border-slate-300/60",hover:"hover:bg-slate-200"},Wr=({month:s,calendar:l,events:r,brand:c,onContentClick:u,onGenerateDate:o,canEdit:N,isGenerating:k=!1,glowingItems:x=new Set,generatingDate:i=null})=>{const[d,A]=s.split("-").map(Number),g=new Date(d,A-1,1),j=new Date(d,A,0).getDate(),t=g.getDay(),F=[];for(let S=0;S<t;S++)F.push({date:"",day:0,isCurrentMonth:!1});for(let S=1;S<=j;S++){const D=`${d}-${String(A).padStart(2,"0")}-${String(S).padStart(2,"0")}`;F.push({date:D,day:S,isCurrentMonth:!0})}const T=S=>l?l.items.filter(D=>D.date===S):[],_=S=>r.filter(D=>D.event_date===S),E=S=>{const D=new Date().toISOString().split("T")[0];return S===D};return e.jsxs("div",{className:"glass-effect rounded-xl border border-primary-500/20 overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 bg-primary-500/5 border-b border-primary-500/20",children:Lr.map(S=>e.jsxs("div",{className:"p-1.5 sm:p-2 md:p-3 text-center text-[10px] sm:text-xs md:text-sm font-semibold text-primary-600",children:[e.jsx("span",{className:"hidden sm:inline",children:S}),e.jsx("span",{className:"sm:hidden",children:S.slice(0,1)})]},S))}),e.jsx("div",{className:"grid grid-cols-7 divide-x divide-y divide-primary-500/10",children:F.map((S,D)=>{if(!S.isCurrentMonth)return e.jsx("div",{className:"h-32 bg-slate-50"},D);const G=T(S.date),te=_(S.date),re=E(S.date);return e.jsxs("div",{className:as("min-h-[80px] sm:min-h-[100px] md:h-32 p-1 sm:p-1.5 md:p-2 flex flex-col bg-white hover:bg-primary-50/30 transition-colors",re&&"bg-primary-100/20 ring-2 ring-primary-400/40 ring-inset"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5 sm:mb-1",children:[e.jsx("span",{className:as("text-xs sm:text-sm font-semibold",re?"text-primary-600":"text-slate-600"),children:S.day}),G.length===0&&N&&e.jsx("button",{onClick:()=>o(S.date),disabled:k,className:as("p-0.5 sm:p-1 rounded transition-colors",k&&i===S.date?"text-blue-600 bg-blue-50":"hover:bg-primary-500/10 text-primary-500",k&&"cursor-not-allowed opacity-50"),title:"Generate content",children:k&&i===S.date?e.jsx(rt,{size:12,className:"animate-spin sm:w-3.5 sm:h-3.5"}):e.jsx(Pe,{size:12,className:"sm:w-3.5 sm:h-3.5"})})]}),te.length>0&&e.jsxs("div",{className:"mb-0.5 sm:mb-1",children:[te.slice(0,1).map(V=>e.jsxs("div",{className:"text-[9px] sm:text-xs px-1 sm:px-2 py-0.5 bg-amber-100 text-amber-700 rounded truncate border border-amber-300/40",title:V.title,children:[e.jsx("span",{className:"hidden sm:inline",children:"ðŸ“… "}),V.title]},V.event_id)),te.length>1&&e.jsxs("div",{className:"text-[8px] sm:text-xs text-slate-500 mt-0.5 px-1",children:["+",te.length-1]})]}),e.jsxs("div",{className:"flex-1 space-y-0.5 sm:space-y-1 overflow-y-auto",children:[G.slice(0,3).map(V=>{const U=Br(V.channel),le=x.has(`${V.date}-${V.channel}`);return e.jsx("button",{onClick:()=>u(V),className:as("w-full text-left text-[9px] sm:text-xs px-1 sm:px-2 py-0.5 sm:py-1 rounded border transition-all relative",V.is_perfect?"bg-green-100 border-green-400/60 text-green-700 hover:bg-green-200 ring-1 ring-green-400/40":`${U.bg} ${U.border} ${U.text} ${U.hover}`,le&&"animate-magical-glow"),children:e.jsxs("div",{className:"flex items-center gap-0.5 sm:gap-1 truncate",children:[V.is_perfect&&e.jsx(vt,{size:8,className:"fill-current flex-shrink-0 sm:w-2.5 sm:h-2.5"}),e.jsxs("span",{className:"truncate font-medium",children:[V.channel,V.character_focus&&e.jsxs("span",{className:"text-[8px] sm:text-[10px] opacity-70",children:[" (",V.character_focus,")"]})]}),le&&e.jsx(Pe,{size:8,className:"text-primary-500 animate-pulse flex-shrink-0 sm:w-2.5 sm:h-2.5"})]})},V.id)}),G.length>3&&e.jsxs("button",{onClick:()=>u(G[3]),className:"text-[9px] sm:text-xs text-slate-600 hover:text-slate-900 hover:bg-slate-100 px-1 sm:px-2 py-0.5 sm:py-1 rounded transition-colors w-full text-left font-medium",children:["+",G.length-3]})]})]},D)})})]})},Ur={awe:{emoji:"âœ¨",color:"bg-purple-100 text-purple-700 border-purple-200"},inspired:{emoji:"ðŸ’¡",color:"bg-amber-100 text-amber-700 border-amber-200"},touched:{emoji:"ðŸ’–",color:"bg-pink-100 text-pink-700 border-pink-200"},laughter:{emoji:"ðŸ˜„",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},provoked:{emoji:"ðŸ”¥",color:"bg-orange-100 text-orange-700 border-orange-200"},excited:{emoji:"ðŸš€",color:"bg-blue-100 text-blue-700 border-blue-200"},confident:{emoji:"ðŸ’ª",color:"bg-green-100 text-green-700 border-green-200"},reassured:{emoji:"ðŸ¤",color:"bg-teal-100 text-teal-700 border-teal-200"},confused:{emoji:"ðŸ˜•",color:"bg-gray-100 text-gray-600 border-gray-200"},disconnected:{emoji:"ðŸ”Œ",color:"bg-slate-100 text-slate-600 border-slate-200"},bored:{emoji:"ðŸ˜",color:"bg-stone-100 text-stone-600 border-stone-200"},agitated:{emoji:"ðŸ˜¤",color:"bg-red-100 text-red-600 border-red-200"},skeptical:{emoji:"ðŸ¤¨",color:"bg-zinc-100 text-zinc-600 border-zinc-200"},indifferent:{emoji:"ðŸ˜¶",color:"bg-neutral-100 text-neutral-600 border-neutral-200"},overwhelmed:{emoji:"ðŸ˜µ",color:"bg-violet-100 text-violet-600 border-violet-200"}},ma=({isOpen:s,onClose:l,expandedBrief:r,observerFeedback:c,onSendToDraft:u,onSave:o})=>{const[N,k]=n.useState(r),[x,i]=n.useState(!1),[d,A]=n.useState(!1),[g,m]=n.useState(!1),[j,t]=n.useState(!1);if(n.useEffect(()=>{k(r),t(!1),m(!1)},[r]),n.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),!s)return null;const F=()=>ie(void 0,null,function*(){try{yield navigator.clipboard.writeText(N),i(!0),setTimeout(()=>i(!1),2e3)}catch(S){console.error("Failed to copy:",S)}}),T=()=>{u&&(u(N),l())},_=()=>ie(void 0,null,function*(){if(!o){l();return}try{A(!0),yield o(N),t(!1),m(!0),setTimeout(()=>m(!1),2e3)}catch(S){console.error("Failed to save expanded brief:",S),alert("Failed to save expanded brief. Please try again.")}finally{A(!1)}}),E=S=>S>=8?"text-green-600 bg-green-50":S>=6?"text-amber-600 bg-amber-50":"text-red-600 bg-red-50";return e.jsxs("div",{className:"fixed inset-0 z-[60] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:l}),e.jsx("div",{className:"relative h-full overflow-y-auto flex items-center justify-center p-3 sm:p-4",children:e.jsxs("div",{className:"relative bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-slate-200 z-10 px-3 sm:px-4 md:px-6 py-3 sm:py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-slate-900",children:"Expanded Story Brief"}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-500 mt-1",children:"Full creative direction for this content piece"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-wrap w-full sm:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-1 sm:flex-initial",children:[o&&e.jsx(w,{size:"sm",onClick:_,disabled:d||!j,className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:d?"Saving...":g?e.jsxs(e.Fragment,{children:[e.jsx(Cs,{size:12,className:"text-green-600 sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Saved"})]}):"Save"}),e.jsx(w,{variant:"outline",size:"sm",onClick:F,className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:x?e.jsxs(e.Fragment,{children:[e.jsx(Cs,{size:12,className:"text-green-600 sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Copied"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ss,{size:12,className:"sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Copy"})]})})]}),u&&e.jsxs(w,{size:"sm",onClick:T,className:"bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white text-xs sm:text-sm",children:[e.jsx("span",{className:"hidden sm:inline",children:"Send to Draft"}),e.jsx("span",{className:"sm:hidden",children:"To Draft"})]}),e.jsx("button",{onClick:l,className:"p-1.5 sm:p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(nt,{size:18,className:"sm:w-5 sm:h-5"})})]})]})}),c&&e.jsxs("div",{className:"border-b border-slate-100 px-3 sm:px-4 md:px-6 py-3 bg-gradient-to-r from-slate-50 to-white",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-slate-500",children:[e.jsx(Pe,{size:14,className:"text-purple-500"}),e.jsx("span",{children:"Client Observer"})]}),e.jsxs("div",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${E(c.score)}`,children:[c.score,"/10"]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:c.emotions.map((S,D)=>{const G=Ur[S]||{emoji:"ðŸŽ¯",color:"bg-slate-100 text-slate-600 border-slate-200"};return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium border ${G.color}`,children:[e.jsx("span",{children:G.emoji}),e.jsx("span",{className:"capitalize",children:S})]},D)})}),c.attempts>1&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-400",children:[e.jsx(Ws,{size:12}),e.jsxs("span",{children:[c.attempts," iterations"]})]})]}),c.reaction&&e.jsxs("p",{className:"mt-2 text-xs sm:text-sm text-slate-600 italic",children:['"',c.reaction,'"']})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 md:p-6",children:e.jsx(Ie,{value:N,onChange:S=>{k(S.target.value),t(!0),m(!1)},rows:25,className:"w-full text-sm leading-relaxed font-mono",placeholder:"Expanded story brief will appear here..."})})]})})]})},Zt=[{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash",category:"âš¡ Fast & Cheap",freeAccess:!0},{value:"gemini-2.0-flash",label:"Gemini 2.0 Flash",category:"âš¡ Fast & Cheap",freeAccess:!0},{value:"gpt-4o-mini",label:"GPT-4o Mini",category:"âš¡ Fast & Cheap",freeAccess:!1},{value:"claude-haiku-4.5",label:"Claude Haiku 4.5",category:"âš¡ Fast & Cheap",freeAccess:!1},{value:"gpt-5-mini",label:"GPT-5 Mini",category:"âš–ï¸ Balanced",freeAccess:!1},{value:"gpt-4.1",label:"GPT-4.1",category:"âš–ï¸ Balanced",freeAccess:!1},{value:"gpt-4o",label:"GPT-4o",category:"âš–ï¸ Balanced",freeAccess:!1},{value:"claude-sonnet-4",label:"Claude Sonnet 4",category:"âš–ï¸ Balanced",freeAccess:!1},{value:"claude-3.7-sonnet",label:"Claude 3.7 Sonnet",category:"âš–ï¸ Balanced",freeAccess:!1},{value:"deepseek-v3.2",label:"DeepSeek V3.2",category:"âš–ï¸ Balanced",freeAccess:!1},{value:"gpt-5.1-instant",label:"GPT-5.1 Instant âš¡",category:"ðŸš€ Premium",freeAccess:!1},{value:"claude-sonnet-4.5",label:"Claude Sonnet 4.5",category:"ðŸš€ Premium",freeAccess:!1},{value:"gpt-5",label:"GPT-5",category:"ðŸš€ Premium",freeAccess:!1}],$s=({value:s,onChange:l,className:r="",showForFreeUsers:c=!1})=>{const{authUser:u}=Is(),o=!(u!=null&&u.plan)||u.plan==="free",N=o?Zt.filter(x=>x.freeAccess):Zt;if(o&&!c)return e.jsxs("div",{className:`flex items-center gap-2 text-xs text-slate-500 ${r}`,children:[e.jsx(Mt,{size:14,className:"text-emerald-500"}),e.jsx("span",{children:"Gemini 2.5 Flash (FREE)"})]});const k=N.reduce((x,i)=>(x[i.category]||(x[i.category]=[]),x[i.category].push(i),x),{});return e.jsxs("div",{className:`flex items-center gap-2 ${r}`,children:[e.jsx(Mt,{size:14,className:"text-slate-400"}),e.jsx("select",{value:s,onChange:x=>l(x.target.value),className:"text-xs px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 focus:outline-none focus:border-primary-400 transition",children:Object.entries(k).map(([x,i])=>e.jsx("optgroup",{label:x,children:i.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))},x))})]})},Gr=n.lazy(()=>Nt(()=>import("./react-vendor-BnMxgzCM.js").then(s=>s.i),__vite__mapDeps([1,2,3]))),Yr={LinkedIn:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-300"},Instagram:{bg:"bg-pink-100",text:"text-pink-700",border:"border-pink-300"},X:{bg:"bg-cyan-100",text:"text-cyan-700",border:"border-cyan-300"},Facebook:{bg:"bg-indigo-100",text:"text-indigo-700",border:"border-indigo-300"},TikTok:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-300"},YouTube:{bg:"bg-red-100",text:"text-red-700",border:"border-red-300"},Blog:{bg:"bg-green-100",text:"text-green-700",border:"border-green-300"},Email:{bg:"bg-amber-100",text:"text-amber-700",border:"border-amber-300"}},Hr=s=>Yr[s]||{bg:"bg-slate-100",text:"text-slate-700",border:"border-slate-300"},Vr=({isOpen:s,onClose:l,content:r,allContentForDay:c=[],allContent:u=[],brand:o,onContentUpdate:N,onRegenerate:k,preferredModel:x="claude-haiku-3.5",canEdit:i=!0,events:d=[],monthTheme:A,weekFocus:g,showNotification:m,hideNotification:j})=>{const[t,F]=n.useState(r),[T,_]=n.useState(""),[E,S]=n.useState([]),[D,G]=n.useState([]),[te,re]=n.useState(""),[V,U]=n.useState(!1),[le,we]=n.useState(!1),[he,L]=n.useState(!1),[Q,H]=n.useState(!1),[ye,f]=n.useState(!1),[ee,q]=n.useState(!1),[ue,ke]=n.useState(!1),[ge,Ce]=n.useState([]),[Z,_e]=n.useState(!1),[Se,W]=n.useState(!0),[me,y]=n.useState(x),[C,P]=n.useState("saved"),[se,ae]=n.useState(0),[pe,je]=n.useState(null),[Ke,Y]=n.useState(!1),Oe=n.useRef(null),Me=n.useRef(null),{authUser:Ae}=Is(),ze=!(Ae!=null&&Ae.plan)||Ae.plan==="free",Ge=(()=>{try{const a=JSON.parse(o.buyer_profile||"[]");return Array.isArray(a)&&a.length>0?a:[{name:"Primary Audience",profile:o.buyer_profile||""}]}catch(a){return[{name:"Primary Audience",profile:o.buyer_profile||""}]}})(),Le=Ge[se]||Ge[0];n.useEffect(()=>{r&&(F(r),_(r.user_revision||""),re(""),Ce([]))},[r]),n.useEffect(()=>{console.log("ContentModal Debug State:",{canEdit:i,isExpanding:V,isRefining:le,streaming:t==null?void 0:t._streaming,hasDraft:!!T,hasRefineNotes:!!te.trim(),modalOpen:s})},[i,V,le,t==null?void 0:t._streaming,T,te,s]),n.useEffect(()=>{t&&(_(t.user_revision||""),re(""),H(!1),f(!1),je(null))},[t==null?void 0:t.id]);const Ye=c.findIndex(a=>a.id===(t==null?void 0:t.id)),Re=Ye>0,Je=Ye<c.length-1,rs=a=>{a==="prev"&&Re?F(c[Ye-1]):a==="next"&&Je&&F(c[Ye+1])},Fe=u?[...u].sort((a,p)=>a.date.localeCompare(p.date)):[];Fe.findIndex(a=>a.id===(t==null?void 0:t.id));const is=t==null?void 0:t.date,Be=Fe.length>0?[...new Set(Fe.map(a=>a.date))].sort():[],Ze=Be,We=Be.findIndex(a=>a===is),He=We>0,b=We<Be.length-1,oe=a=>{if(a==="prev"&&He){const p=Be[We-1],M=Fe.find($=>$.date===p);M&&F(M)}else if(a==="next"&&b){const p=Be[We+1],M=Fe.find($=>$.date===p);M&&F(M)}},ce=a=>{a!==T&&(S(p=>[...p.slice(-19),T]),G([]),_(a))},ve=()=>{if(E.length>0){const a=E[E.length-1];G(p=>[...p,T]),_(a),S(p=>p.slice(0,-1))}},v=()=>{if(D.length>0){const a=D[D.length-1];S(p=>[...p,T]),_(a),G(p=>p.slice(0,-1))}};if(n.useEffect(()=>{if(t){const a=c.find(p=>p.id===t.id);a&&F(a)}},[c,t==null?void 0:t.id]),n.useEffect(()=>{if(!(!i||!t))return Me.current&&clearTimeout(Me.current),T!==(t.user_revision||"")&&(P("unsaved"),Me.current=setTimeout(()=>{P("saving"),N(t.id,{user_revision:T}),setTimeout(()=>P("saved"),500)},2e3)),()=>{Me.current&&clearTimeout(Me.current)}},[T,t,i,N]),n.useEffect(()=>(s?(document.body.style.overflow="hidden",document.body.classList.add("modal-open")):(document.body.style.overflow="unset",document.body.classList.remove("modal-open")),()=>{document.body.style.overflow="unset",document.body.classList.remove("modal-open")}),[s]),!s||!t)return null;t.final_brief||t.expanded_brief||t.brief;const O=Array.isArray(o.cast_management)?o.cast_management:[],K=Hr(t.channel),z=Array.isArray(o.team_members)?o.team_members:[],B=()=>ie(void 0,null,function*(){if(console.log("ðŸ”µ handleExpand clicked!",{canEdit:i,streaming:t==null?void 0:t._streaming}),!(!t||!i||t._streaming)){U(!0),m==null||m("Expanding brief into rich creative concept...",me);try{const a=T.trim()?T.trim():void 0,p=Le.profile||o.buyer_profile,M=yield ms.expandBrief(t,R(I({},o),{buyer_profile:p}),me,a,O,g),$=M.expandedBrief,ne=M.observerFeedback;ne&&(je(ne),console.log("âœ¨ Client Observer Feedback:",ne));let J=$;typeof $=="object"&&$!==null&&(J=xe($)),ce(J),N(t.id,{expanded_brief:J,final_brief:J,user_revision:J}),W(!0)}catch(a){console.error("Failed to expand:",a),alert("Failed to expand brief. Please try again.")}finally{U(!1),j==null||j()}}}),X=()=>ie(void 0,null,function*(){if(!t)return;const a=`
ðŸŽ£ HOOK
${t.story_hook||"N/A"}

ðŸ“‹ DIRECTIVES
${t.directives||"N/A"}

ðŸŽ­ CHARACTER
${t.character_focus||"N/A"}

ðŸŽ¬ MEDIA TYPE
${t.media_type||"N/A"}

ðŸŽ¨ TONE
${t.tone||"N/A"}

ðŸŽ¯ CALL TO ACTION
${t.call_to_action||"N/A"}
    `.trim();try{yield navigator.clipboard.writeText(a),f(!0),setTimeout(()=>f(!1),2e3)}catch(p){console.error("Failed to copy:",p)}}),xe=a=>typeof a=="string"?a:[{key:"day",title:"ðŸ“… Day"},{key:"channel",title:"ðŸ“¢ Channel"},{key:"storyHook",title:"ðŸŽ£ Story Hook & Content Idea"},{key:"hook",title:"ðŸŽ£ Story Hook"},{key:"characterFocus",title:"ðŸŽ­ Character Focus"},{key:"character_focus",title:"ðŸŽ­ Character Focus"},{key:"emotionalBeat",title:"ðŸ’« Emotional Beat"},{key:"emotional_beat",title:"ðŸ’« Emotional Beat"},{key:"narrativePurpose",title:"ðŸ“– Narrative Purpose"},{key:"narrative_purpose",title:"ðŸ“– Narrative Purpose"},{key:"mediaType",title:"ðŸŽ¬ Media Type"},{key:"media_type",title:"ðŸŽ¬ Media Type"},{key:"callToAction",title:"ðŸŽ¯ Call To Action"},{key:"call_to_action",title:"ðŸŽ¯ Call To Action"},{key:"cta",title:"ðŸŽ¯ Call To Action"},{key:"directives",title:"ðŸ“‹ Content Directives"},{key:"brief",title:"ðŸ“ Creative Brief"},{key:"keyMessage",title:"ðŸ’¡ Key Message"},{key:"contentStructure",title:"ðŸ“‹ Content Structure"},{key:"successMetrics",title:"âœ¨ Success Metrics"}].filter($=>{const ne=a[$.key];return ne&&(typeof ne=="string"||typeof ne=="number")}).map($=>{const J=String(a[$.key]).replace(/\n/g,"<br>");return`<h3><strong>${$.title}</strong></h3><p>${J}</p>`}).join(""),fe=()=>ie(void 0,null,function*(){if(console.log("âœ¨ handleRefine (Review) clicked!",{canEdit:i,streaming:t==null?void 0:t._streaming,notes:te}),!(!t||!i||!te.trim()||t._streaming)){we(!0);try{const a=`
ORIGINAL IDEA:
Hook: ${t.story_hook||"N/A"}
Directives: ${t.directives||"N/A"}
Character: ${t.character_focus||"N/A"}
Media Type: ${t.media_type||"N/A"}
CTA: ${t.call_to_action||"N/A"}
      `.trim(),p=te.trim(),M=Le.profile||o.buyer_profile,$=yield ms.refineContent(R(I({},o),{buyer_profile:M}),a,p,t.date,O,me);ce($),N(t.id,{expanded_brief:$,final_brief:$,user_revision:$,is_perfect:!1}),re("")}catch(a){console.error("Failed to refine:",a),alert("Failed to refine content. Please try again.")}finally{we(!1)}}}),Ne=()=>{if(console.log("â­ handleMarkPerfect clicked!",{canEdit:i,streaming:t==null?void 0:t._streaming,draft:T}),!i||t._streaming)return;const a=!t.is_perfect;F(p=>p?R(I({},p),{is_perfect:a}):null),N(t.id,{is_perfect:a,user_revision:T,final_brief:T||t.final_brief||t.expanded_brief||t.brief})},be=()=>ie(void 0,null,function*(){if(!(!t||!i||!k)){L(!0);try{yield k(t.id)}catch(a){console.error("Failed to regenerate:",a),alert("Failed to regenerate content. Please try again.")}finally{L(!1)}}}),$e=()=>{if(z.length===0){alert("No team members found. Add team members in Settings.");return}q(!0)},Ue=()=>ie(void 0,null,function*(){if(t){if(ge.length===0){alert("Please select at least one team member.");return}try{m==null||m("Sending brief via email...",x);const a=z.filter($=>ge.includes($.id)).map($=>$.email);if(a.length===0)throw new Error("No valid email addresses found");const p={title:t.title,channel:t.channel,date:t.date,storyHook:t.story_hook,characterFocus:t.character_focus,emotionalBeat:t.emotional_beat,narrativePurpose:t.narrative_purpose,mediaType:t.media_type,callToAction:t.call_to_action,brief:T||t.expanded_brief||t.brief||"",suggestedTime:t.suggested_posting_time},M=yield fetch("https://andorabrand.me/api/api/email/send-brief",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({teamMemberEmails:a,contentData:p,brandName:o.brand_name})});if(!M.ok){const $=yield M.json();throw new Error($.error||"Failed to send email")}j==null||j(),alert(`âœ… Brief sent to ${a.length} team member(s)!`),q(!1),Ce([])}catch(a){console.error("Failed to send brief:",a),j==null||j(),alert(`âŒ Failed to send brief: ${a instanceof Error?a.message:"Unknown error"}`)}}}),h=a=>{_(a)};return e.jsxs("div",{className:"fixed inset-0 z-[100] flex flex-col",children:[e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-slate-900/95 via-slate-800/95 to-slate-900/95 backdrop-blur-sm",onClick:l}),e.jsx("div",{className:"relative z-10 flex-1 overflow-y-auto",children:e.jsxs("div",{className:"min-h-full bg-white",children:[e.jsx("div",{className:"sticky top-0 bg-white/95 backdrop-blur-lg border-b border-slate-200 z-20 shadow-sm",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-3 sm:px-4 md:px-6 py-3 sm:py-4",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-slate-600 mb-2 sm:mb-3 overflow-x-auto",children:[e.jsx("span",{className:"hover:text-slate-900 cursor-default",children:"Content Calendar"}),e.jsx(Qe,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"hover:text-slate-900 cursor-default",children:new Date(t.date+"T12:00:00Z").toLocaleDateString("en-US",{month:"long",year:"numeric",timeZone:"UTC"})}),e.jsx(Qe,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"hover:text-slate-900 cursor-default",children:new Date(t.date+"T12:00:00Z").toLocaleDateString("en-US",{weekday:"long",day:"numeric",timeZone:"UTC"})}),e.jsx(Qe,{size:14,className:"text-slate-400"}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold border ${K.bg} ${K.text} ${K.border}`,children:t.channel})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 sm:gap-4 p-2 sm:p-3 bg-slate-50 rounded-lg mb-2 sm:mb-3",children:[u&&u.length>0&&Ze&&Ze.length>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:()=>oe("prev"),disabled:!He,className:`flex items-center gap-1 px-2 sm:px-3 py-1.5 rounded-lg text-xs sm:text-sm font-medium transition-colors ${He?"hover:bg-white text-slate-700 shadow-sm":"text-slate-300 cursor-not-allowed"}`,title:"Previous day",children:[e.jsx(us,{size:14,className:"sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Prev Day"}),e.jsx("span",{className:"md:hidden",children:"Prev"})]}),e.jsxs("span",{className:"text-[10px] sm:text-xs font-medium text-slate-600 px-1 sm:px-2 whitespace-nowrap",children:["Day ",We+1,"/",Ze.length]}),e.jsxs("button",{onClick:()=>oe("next"),disabled:!b,className:`flex items-center gap-1 px-2 sm:px-3 py-1.5 rounded-lg text-xs sm:text-sm font-medium transition-colors ${b?"hover:bg-white text-slate-700 shadow-sm":"text-slate-300 cursor-not-allowed"}`,title:"Next day",children:[e.jsx("span",{className:"hidden md:inline",children:"Next Day"}),e.jsx("span",{className:"md:hidden",children:"Next"}),e.jsx(Qe,{size:14,className:"sm:w-4 sm:h-4"})]})]}),c&&c.length>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:border-l border-slate-200 sm:pl-4",children:[e.jsx("button",{onClick:()=>rs("prev"),disabled:!Re,className:`p-1.5 sm:p-2 rounded-lg transition-colors ${Re?"hover:bg-white text-slate-700 shadow-sm":"text-slate-300 cursor-not-allowed"}`,title:"Previous channel",children:e.jsx(us,{size:16,className:"sm:w-[18px] sm:h-[18px]"})}),e.jsxs("span",{className:"text-[10px] sm:text-xs font-medium text-slate-600 px-1 sm:px-2 whitespace-nowrap",children:[Ye+1,"/",c.length]}),e.jsx("button",{onClick:()=>rs("next"),disabled:!Je,className:`p-1.5 sm:p-2 rounded-lg transition-colors ${Je?"hover:bg-white text-slate-700 shadow-sm":"text-slate-300 cursor-not-allowed"}`,title:"Next channel",children:e.jsx(Qe,{size:16,className:"sm:w-[18px] sm:h-[18px]"})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto",children:[e.jsx("div",{className:"flex items-center gap-2 sm:gap-3 mb-1 sm:mb-2",children:t.suggested_posting_time&&e.jsxs("span",{className:"flex items-center gap-1 sm:gap-1.5 text-[10px] sm:text-xs text-slate-500",children:[e.jsx(Ds,{size:12,className:"sm:w-3.5 sm:h-3.5"}),t.suggested_posting_time]})}),e.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-slate-900 mb-1",children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0 flex-wrap w-full sm:w-auto justify-end",children:[i&&!ze&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx($s,{value:me,onChange:a=>y(a),className:"text-xs"})}),i&&Ge.length>1&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("select",{value:se,onChange:a=>ae(Number(a.target.value)),className:"text-xs px-2 py-1.5 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",title:"Select target audience",children:Ge.map((a,p)=>e.jsx("option",{value:p,children:a.name||`Audience ${p+1}`},p))})}),i&&k&&e.jsxs(w,{variant:"outline",size:"sm",onClick:be,loading:he,disabled:he,className:"flex items-center gap-1 sm:gap-2 text-orange-600 hover:text-orange-700 hover:bg-orange-50 text-xs sm:text-sm",title:Ge.length>1?`Regenerate original idea for ${Le.name} using ${me}`:`Regenerate original idea using ${me}`,children:[e.jsx(Ws,{size:14,className:he?"animate-spin":""}),e.jsx("span",{className:"hidden sm:inline",children:"Regenerate Idea"}),e.jsx("span",{className:"sm:hidden",children:"Regen"})]}),i&&z.length>0&&e.jsxs(w,{variant:"outline",size:"sm",onClick:$e,className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(_s,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Send"})]}),e.jsxs(w,{variant:t.is_perfect?"default":"outline",size:"sm",onClick:Ne,disabled:!i||t._streaming,className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(vt,{size:14,className:t.is_perfect?"fill-current":""}),e.jsx("span",{className:"hidden sm:inline",children:t.is_perfect?"Perfect":"Mark Perfect"}),e.jsx("span",{className:"sm:hidden",children:"â˜…"})]}),e.jsx("button",{onClick:l,className:"p-1.5 sm:p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(nt,{size:18,className:"sm:w-5 sm:h-5"})})]})]})]})}),e.jsxs("div",{className:"max-w-5xl mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6 md:py-8 space-y-4 sm:space-y-6 md:space-y-8",children:[!i&&e.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg text-amber-800",children:"ðŸ‘€ View-only access"}),(t.story_hook||t.character_focus||t.directives||t.media_type||t.call_to_action)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"ðŸ’¡ Original Idea"}),e.jsx(w,{variant:"outline",size:"sm",onClick:X,className:"flex items-center gap-2",children:ye?e.jsxs(e.Fragment,{children:[e.jsx(Cs,{size:14,className:"text-green-600"}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(ss,{size:14}),"Copy"]})})]}),e.jsxs("div",{className:"p-6 bg-gradient-to-br from-orange-50 via-pink-50 to-purple-50 border-2 border-orange-200 rounded-2xl space-y-4",children:[t.story_hook&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-1.5",children:"ðŸŽ£ Hook"}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:t.story_hook})]}),t.directives&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-1.5",children:"ðŸ“‹ Directives"}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed whitespace-pre-wrap",children:t.directives})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 md:gap-4 pt-2 border-t border-orange-200/50",children:[t.character_focus&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-600 mb-1",children:"ðŸŽ­ Character"}),e.jsx("p",{className:"text-sm text-slate-700",children:t.character_focus})]}),t.media_type&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-600 mb-1",children:"ðŸŽ¬ Media Type"}),e.jsx("p",{className:"text-sm text-slate-700 font-medium uppercase tracking-wide",children:t.media_type})]}),t.tone&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-600 mb-1",children:"ðŸŽ¨ Tone"}),e.jsx("p",{className:"text-sm text-slate-700 font-medium",children:t.tone})]}),t.call_to_action&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-600 mb-1",children:"ðŸŽ¯ CTA"}),e.jsx("p",{className:"text-sm text-slate-700",children:t.call_to_action})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Full Creative Execution"}),!ze&&e.jsx($s,{value:me,onChange:y})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-wrap",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>_e(!Z),className:"flex items-center gap-2",title:Z?"Exit Fullscreen":"Fullscreen",children:Z?e.jsx(Ts,{size:14}):e.jsx(sa,{size:14})}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>W(!Se),disabled:!i,className:"flex items-center gap-2",title:"Toggle Rich Text Editor",children:[e.jsx(et,{size:14}),Se?"Plain":"Rich"]}),!t.expanded_brief&&!t.final_brief?e.jsxs(w,{size:"sm",onClick:B,loading:V,disabled:!i||t._streaming,className:"flex items-center gap-2 bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white",title:`Expand brief into full content using ${me}`,children:[e.jsx(ta,{size:14}),"Expand Brief"]}):null,e.jsx(w,{variant:"outline",size:"sm",onClick:ve,disabled:!i||E.length===0,className:"flex items-center gap-2",title:"Undo",children:e.jsx(aa,{size:14})}),e.jsx(w,{variant:"outline",size:"sm",onClick:v,disabled:!i||D.length===0,className:"flex items-center gap-2",title:"Redo",children:e.jsx(ra,{size:14})}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>ie(void 0,null,function*(){if(T){const a=document.createElement("div");a.innerHTML=T;const p=a.textContent||a.innerText||T;yield navigator.clipboard.writeText(p),H(!0),setTimeout(()=>H(!1),2e3)}}),disabled:!T,className:"flex items-center gap-2",children:[Q?e.jsx(Cs,{size:14,className:"text-green-600"}):e.jsx(ss,{size:14}),Q?"Copied!":"Copy"]}),(t.expanded_brief||t.final_brief)&&e.jsxs(w,{variant:"primary",size:"sm",onClick:B,loading:V,disabled:!i||t._streaming,className:"flex items-center gap-2 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white",title:`Regenerate expanded brief using ${me}`,children:[e.jsx(Ws,{size:14,className:V?"animate-spin":""}),"Regenerate Expansion"]})]})]}),Se?e.jsxs("div",{className:`${Z?"fixed inset-0 z-[90] bg-white flex flex-col overflow-hidden":""}`,children:[Z&&e.jsxs("div",{className:"flex items-center justify-between gap-3 px-8 py-4 border-b border-slate-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Full Creative Execution"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${C==="saved"?"bg-green-100 text-green-700":C==="saving"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:C==="saved"?"âœ“ Saved":C==="saving"?"â³ Saving...":"âš  Unsaved"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&z.length>0&&e.jsxs(w,{variant:"outline",size:"sm",onClick:$e,className:"flex items-center gap-2",children:[e.jsx(_s,{size:14}),"Send Brief"]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>_e(!1),className:"flex items-center gap-2",children:[e.jsx(Ts,{size:14}),"Exit Fullscreen"]})]})]}),e.jsx("div",{className:`${Z?"flex-1 overflow-y-auto px-8 py-6":""}`,children:e.jsx("div",{className:`${Z?"max-w-4xl mx-auto":""}`,children:e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"min-h-[300px] flex items-center justify-center bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading editor..."})]})}),children:e.jsx(Gr,{ref:Oe,value:T,onChange:a=>{t.is_perfect?Y(!0):ce(a)},readOnly:!i||t._streaming,theme:"snow",className:`${Z?"h-auto":"min-h-[300px]"}`,placeholder:"Click 'Expand Brief' to generate the full script/article/copy, or type your own content here...",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","blockquote","code-block"],["clean"]]}})})})})]}):e.jsxs("div",{className:`${Z?"fixed inset-0 z-[90] bg-white flex flex-col overflow-hidden":""}`,children:[Z&&e.jsxs("div",{className:"flex items-center justify-between gap-3 px-8 py-4 border-b border-slate-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Full Creative Execution"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${C==="saved"?"bg-green-100 text-green-700":C==="saving"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:C==="saved"?"âœ“ Saved":C==="saving"?"â³ Saving...":"âš  Unsaved"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&z.length>0&&e.jsxs(w,{variant:"outline",size:"sm",onClick:$e,className:"flex items-center gap-2",children:[e.jsx(_s,{size:14}),"Send Brief"]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>_e(!1),className:"flex items-center gap-2",children:[e.jsx(Ts,{size:14}),"Exit Fullscreen"]})]})]}),e.jsx("div",{className:`${Z?"flex-1 overflow-y-auto px-8 py-6":""}`,children:e.jsx("div",{className:`${Z?"max-w-4xl mx-auto":""}`,children:e.jsx(Ie,{value:T,onChange:a=>{t.is_perfect?Y(!0):ce(a.target.value)},placeholder:"Click 'Expand Brief' to generate the full script/article/copy, or type your own prompt/notes here first to guide Andora's writing...",disabled:!i||t._streaming,rows:Z?30:12,className:`text-sm leading-relaxed font-mono ${Z?"w-full min-h-screen":""}`})})})]})]}),e.jsxs("div",{className:"p-6 bg-gradient-to-br from-orange-50 via-pink-50 to-purple-50 border-2 border-orange-200 rounded-2xl space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5 text-orange-600"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Review"})]}),e.jsx("p",{className:"text-xs text-slate-600",children:"Andora will review your notes below and expand them into a full creative brief in the draft field above"}),e.jsx(Ie,{value:te,onChange:a=>re(a.target.value),placeholder:"Write your review notes here - ideas, directions, tweaks you want. Andora will contextualize this with the original brief and create an expanded version...",disabled:!i||t._streaming,rows:3,className:"bg-white/80 text-sm"}),e.jsxs(w,{onClick:fe,loading:le,disabled:!i||!te.trim()||t._streaming,className:"w-full bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white",children:[e.jsx(ds,{size:16,className:"mr-2"}),le?"Andora is reviewing...":"Review"]})]}),z.length>0&&e.jsxs("div",{className:"p-6 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-2 border-blue-200 rounded-2xl space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Team Comments"})]}),e.jsx("p",{className:"text-xs text-slate-600",children:"Leave notes for your team about this brief"}),e.jsx(Ie,{value:t.comments||"",onChange:a=>{i&&N(t.id,{comments:a.target.value})},placeholder:"Add comments for your team here...",disabled:!i||t._streaming,rows:3,className:"bg-white/80 text-sm"})]})]})]})}),ee&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>q(!1)}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Send Brief to Team"}),e.jsx("div",{className:"space-y-2 mb-6 max-h-64 overflow-y-auto",children:z.map(a=>e.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-slate-50 rounded-lg cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ge.includes(a.id),onChange:p=>{p.target.checked?Ce([...ge,a.id]):Ce(ge.filter(M=>M!==a.id))},className:"w-4 h-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:a.name}),e.jsx("p",{className:"text-xs text-slate-500",children:a.email})]})]},a.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",onClick:()=>q(!1),className:"flex-1",children:"Cancel"}),e.jsxs(w,{onClick:Ue,disabled:ge.length===0,className:"flex-1",children:["Send to ",ge.length," member(s)"]})]})]})]}),e.jsx(ma,{isOpen:ue,onClose:()=>ke(!1),expandedBrief:(t==null?void 0:t.expanded_brief)||(t==null?void 0:t.final_brief)||"",observerFeedback:pe,onSendToDraft:h}),Ke&&e.jsxs("div",{className:"fixed inset-0 z-[101] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>Y(!1)}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"This content is marked as perfect."}),e.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Editing this content will mark it as imperfect. Are you sure you want to continue?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",onClick:()=>Y(!1),className:"flex-1",children:"Cancel"}),e.jsx(w,{onClick:()=>{Y(!1),N(t.id,{is_perfect:!1})},className:"flex-1",children:"Edit Anyway"})]})]})]})]})},qr=n.lazy(()=>Nt(()=>import("./react-vendor-BnMxgzCM.js").then(s=>s.i),__vite__mapDeps([1,2,3]))),Kr={LinkedIn:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-300"},Instagram:{bg:"bg-pink-100",text:"text-pink-700",border:"border-pink-300"},X:{bg:"bg-cyan-100",text:"text-cyan-700",border:"border-cyan-300"},Facebook:{bg:"bg-indigo-100",text:"text-indigo-700",border:"border-indigo-300"},TikTok:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-300"},YouTube:{bg:"bg-red-100",text:"text-red-700",border:"border-red-300"},Blog:{bg:"bg-green-100",text:"text-green-700",border:"border-green-300"},Email:{bg:"bg-amber-100",text:"text-amber-700",border:"border-amber-300"}},Jr=s=>Kr[s]||{bg:"bg-slate-100",text:"text-slate-700",border:"border-slate-300"},Zr=({isOpen:s,onClose:l,content:r,allContentForDay:c=[],allContent:u=[],brand:o,onContentUpdate:N,onRegenerate:k,preferredModel:x="claude-haiku-3.5",canEdit:i=!0,events:d=[],monthTheme:A,weekFocus:g,showNotification:m,hideNotification:j})=>{const[t,F]=n.useState(r),[T,_]=n.useState(""),[E,S]=n.useState([]),[D,G]=n.useState([]),[te,re]=n.useState(""),[V,U]=n.useState(!1),[le,we]=n.useState(!1),[he,L]=n.useState(!1),[Q,H]=n.useState(!1),[ye,f]=n.useState(!1),[ee,q]=n.useState(!1),[ue,ke]=n.useState(!1),[ge,Ce]=n.useState([]),[Z,_e]=n.useState(!1),[Se,W]=n.useState(!0),[me,y]=n.useState(x),[C,P]=n.useState("saved"),[se,ae]=n.useState(0),[pe,je]=n.useState(null),[Ke,Y]=n.useState(!1),Oe=n.useRef(null),Me=n.useRef(null),{authUser:Ae}=Is(),ze=!(Ae!=null&&Ae.plan)||Ae.plan==="free",Ge=(()=>{try{const a=JSON.parse(o.buyer_profile||"[]");return Array.isArray(a)&&a.length>0?a:[{name:"Primary Audience",profile:o.buyer_profile||""}]}catch(a){return[{name:"Primary Audience",profile:o.buyer_profile||""}]}})(),Le=Ge[se]||Ge[0];n.useEffect(()=>{r&&(F(r),_(r.user_revision||""),re(""),Ce([]))},[r]),n.useEffect(()=>{console.log("ContentSidebar Debug State:",{canEdit:i,isExpanding:V,isRefining:le,streaming:t==null?void 0:t._streaming,hasDraft:!!T,hasRefineNotes:!!te.trim(),modalOpen:s})},[i,V,le,t==null?void 0:t._streaming,T,te,s]),n.useEffect(()=>{t&&(_(t.user_revision||""),re(""),H(!1),f(!1),je(null))},[t==null?void 0:t.id]);const Ye=c.findIndex(a=>a.id===(t==null?void 0:t.id)),Re=Ye>0,Je=Ye<c.length-1,rs=a=>{a==="prev"&&Re?F(c[Ye-1]):a==="next"&&Je&&F(c[Ye+1])},Fe=u?[...u].sort((a,p)=>a.date.localeCompare(p.date)):[];Fe.findIndex(a=>a.id===(t==null?void 0:t.id));const is=t==null?void 0:t.date,Be=Fe.length>0?[...new Set(Fe.map(a=>a.date))].sort():[],Ze=Be,We=Be.findIndex(a=>a===is),He=We>0,b=We<Be.length-1,oe=a=>{if(a==="prev"&&He){const p=Be[We-1],M=Fe.find($=>$.date===p);M&&F(M)}else if(a==="next"&&b){const p=Be[We+1],M=Fe.find($=>$.date===p);M&&F(M)}},ce=a=>{a!==T&&(S(p=>[...p.slice(-19),T]),G([]),_(a))},ve=()=>{if(E.length>0){const a=E[E.length-1];G(p=>[...p,T]),_(a),S(p=>p.slice(0,-1))}},v=()=>{if(D.length>0){const a=D[D.length-1];S(p=>[...p,T]),_(a),G(p=>p.slice(0,-1))}};if(n.useEffect(()=>{if(t){const a=c.find(p=>p.id===t.id);a&&F(a)}},[c,t==null?void 0:t.id]),n.useEffect(()=>{if(!(!i||!t))return Me.current&&clearTimeout(Me.current),T!==(t.user_revision||"")&&(P("unsaved"),Me.current=setTimeout(()=>{P("saving"),N(t.id,{user_revision:T}),setTimeout(()=>P("saved"),500)},2e3)),()=>{Me.current&&clearTimeout(Me.current)}},[T,t,i,N]),!s||!t)return null;t.final_brief||t.expanded_brief||t.brief;const O=Array.isArray(o.cast_management)?o.cast_management:[],K=Jr(t.channel),z=Array.isArray(o.team_members)?o.team_members:[],B=()=>ie(void 0,null,function*(){if(console.log("ðŸ”µ handleExpand clicked!",{canEdit:i,streaming:t==null?void 0:t._streaming}),!(!t||!i||t._streaming)){U(!0),m==null||m("Expanding brief into rich creative concept...",me);try{const a=T.trim()?T.trim():void 0,p=Le.profile||o.buyer_profile,M=yield ms.expandBrief(t,R(I({},o),{buyer_profile:p}),me,a,O,g),$=M.expandedBrief,ne=M.observerFeedback;ne&&(je(ne),console.log("âœ¨ Client Observer Feedback:",ne));let J=$;typeof $=="object"&&$!==null&&(J=xe($)),ce(J),N(t.id,{expanded_brief:J,final_brief:J,user_revision:J}),W(!0)}catch(a){console.error("Failed to expand:",a),alert("Failed to expand brief. Please try again.")}finally{U(!1),j==null||j()}}}),X=()=>ie(void 0,null,function*(){if(!t)return;const a=`
ðŸŽ£ HOOK
${t.story_hook||"N/A"}

ðŸ“‹ DIRECTIVES
${t.directives||"N/A"}

ðŸŽ­ CHARACTER
${t.character_focus||"N/A"}

ðŸŽ¬ MEDIA TYPE
${t.media_type||"N/A"}

ðŸŽ¨ TONE
${t.tone||"N/A"}

ðŸŽ¯ CALL TO ACTION
${t.call_to_action||"N/A"}
    `.trim();try{yield navigator.clipboard.writeText(a),f(!0),setTimeout(()=>f(!1),2e3)}catch(p){console.error("Failed to copy:",p)}}),xe=a=>typeof a=="string"?a:[{key:"day",title:"ðŸ“… Day"},{key:"channel",title:"ðŸ“¢ Channel"},{key:"storyHook",title:"ðŸŽ£ Story Hook & Content Idea"},{key:"hook",title:"ðŸŽ£ Story Hook"},{key:"characterFocus",title:"ðŸŽ­ Character Focus"},{key:"character_focus",title:"ðŸŽ­ Character Focus"},{key:"emotionalBeat",title:"ðŸ’« Emotional Beat"},{key:"emotional_beat",title:"ðŸ’« Emotional Beat"},{key:"narrativePurpose",title:"ðŸ“– Narrative Purpose"},{key:"narrative_purpose",title:"ðŸ“– Narrative Purpose"},{key:"mediaType",title:"ðŸŽ¬ Media Type"},{key:"media_type",title:"ðŸŽ¬ Media Type"},{key:"callToAction",title:"ðŸŽ¯ Call To Action"},{key:"call_to_action",title:"ðŸŽ¯ Call To Action"},{key:"cta",title:"ðŸŽ¯ Call To Action"},{key:"directives",title:"ðŸ“‹ Content Directives"},{key:"brief",title:"ðŸ“ Creative Brief"},{key:"keyMessage",title:"ðŸ’¡ Key Message"},{key:"contentStructure",title:"ðŸ“‹ Content Structure"},{key:"successMetrics",title:"âœ¨ Success Metrics"}].filter($=>{const ne=a[$.key];return ne&&(typeof ne=="string"||typeof ne=="number")}).map($=>{const J=String(a[$.key]).replace(/\n/g,"<br>");return`<h3><strong>${$.title}</strong></h3><p>${J}</p>`}).join(""),fe=()=>ie(void 0,null,function*(){if(console.log("âœ¨ handleRefine (Review) clicked!",{canEdit:i,streaming:t==null?void 0:t._streaming,notes:te}),!(!t||!i||!te.trim()||t._streaming)){we(!0);try{const a=`
ORIGINAL IDEA:
Hook: ${t.story_hook||"N/A"}
Directives: ${t.directives||"N/A"}
Character: ${t.character_focus||"N/A"}
Media Type: ${t.media_type||"N/A"}
CTA: ${t.call_to_action||"N/A"}
      `.trim(),p=te.trim(),M=Le.profile||o.buyer_profile,$=yield ms.refineContent(R(I({},o),{buyer_profile:M}),a,p,t.date,O,me);ce($),N(t.id,{expanded_brief:$,final_brief:$,user_revision:$,is_perfect:!1}),re("")}catch(a){console.error("Failed to refine:",a),alert("Failed to refine content. Please try again.")}finally{we(!1)}}}),Ne=()=>{if(console.log("â­ handleMarkPerfect clicked!",{canEdit:i,streaming:t==null?void 0:t._streaming,draft:T}),!i||t._streaming)return;const a=!t.is_perfect;F(p=>p?R(I({},p),{is_perfect:a}):null),N(t.id,{is_perfect:a,user_revision:T,final_brief:T||t.final_brief||t.expanded_brief||t.brief})},be=()=>ie(void 0,null,function*(){if(!(!t||!i||!k)){L(!0);try{yield k(t.id)}catch(a){console.error("Failed to regenerate:",a),alert("Failed to regenerate content. Please try again.")}finally{L(!1)}}}),$e=()=>{if(z.length===0){alert("No team members found. Add team members in Settings.");return}q(!0)},Ue=()=>ie(void 0,null,function*(){if(t){if(ge.length===0){alert("Please select at least one team member.");return}try{m==null||m("Sending brief via email...",x);const a=z.filter($=>ge.includes($.id)).map($=>$.email);if(a.length===0)throw new Error("No valid email addresses found");const p={title:t.title,channel:t.channel,date:t.date,storyHook:t.story_hook,characterFocus:t.character_focus,emotionalBeat:t.emotional_beat,narrativePurpose:t.narrative_purpose,mediaType:t.media_type,callToAction:t.call_to_action,brief:T||t.expanded_brief||t.brief||"",suggestedTime:t.suggested_posting_time},M=yield fetch("https://andorabrand.me/api/api/email/send-brief",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({teamMemberEmails:a,contentData:p,brandName:o.brand_name})});if(!M.ok){const $=yield M.json();throw new Error($.error||"Failed to send email")}j==null||j(),alert(`âœ… Brief sent to ${a.length} team member(s)!`),q(!1),Ce([])}catch(a){console.error("Failed to send brief:",a),j==null||j(),alert(`âŒ Failed to send brief: ${a instanceof Error?a.message:"Unknown error"}`)}}}),h=a=>{_(a)};return e.jsxs("div",{className:`fixed inset-y-0 right-0 z-50 w-full max-w-2xl bg-white shadow-2xl transform transition-transform duration-300 ease-in-out ${s?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"sticky top-0 bg-white/95 backdrop-blur-lg border-b border-slate-200 z-20 shadow-sm flex-shrink-0",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-3 sm:px-4 md:px-6 py-3 sm:py-4",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-slate-600 mb-2 sm:mb-3 overflow-x-auto",children:[e.jsx("span",{className:"hover:text-slate-900 cursor-default",children:"Content Calendar"}),e.jsx(Qe,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"hover:text-slate-900 cursor-default",children:new Date(t.date+"T12:00:00Z").toLocaleDateString("en-US",{month:"long",year:"numeric",timeZone:"UTC"})}),e.jsx(Qe,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"hover:text-slate-900 cursor-default",children:new Date(t.date+"T12:00:00Z").toLocaleDateString("en-US",{weekday:"long",day:"numeric",timeZone:"UTC"})}),e.jsx(Qe,{size:14,className:"text-slate-400"}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold border ${K.bg} ${K.text} ${K.border}`,children:t.channel})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 sm:gap-4 p-2 sm:p-3 bg-slate-50 rounded-lg mb-2 sm:mb-3",children:[u&&u.length>0&&Ze&&Ze.length>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:()=>oe("prev"),disabled:!He,className:`flex items-center gap-1 px-2 sm:px-3 py-1.5 rounded-lg text-xs sm:text-sm font-medium transition-colors ${He?"hover:bg-white text-slate-700 shadow-sm":"text-slate-300 cursor-not-allowed"}`,title:"Previous day",children:[e.jsx(us,{size:14,className:"sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Prev Day"}),e.jsx("span",{className:"md:hidden",children:"Prev"})]}),e.jsxs("span",{className:"text-[10px] sm:text-xs font-medium text-slate-600 px-1 sm:px-2 whitespace-nowrap",children:["Day ",We+1,"/",Ze.length]}),e.jsxs("button",{onClick:()=>oe("next"),disabled:!b,className:`flex items-center gap-1 px-2 sm:px-3 py-1.5 rounded-lg text-xs sm:text-sm font-medium transition-colors ${b?"hover:bg-white text-slate-700 shadow-sm":"text-slate-300 cursor-not-allowed"}`,title:"Next day",children:[e.jsx("span",{className:"hidden md:inline",children:"Next Day"}),e.jsx("span",{className:"md:hidden",children:"Next"}),e.jsx(Qe,{size:14,className:"sm:w-4 sm:h-4"})]})]}),c&&c.length>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:border-l border-slate-200 sm:pl-4",children:[e.jsx("button",{onClick:()=>rs("prev"),disabled:!Re,className:`p-1.5 sm:p-2 rounded-lg transition-colors ${Re?"hover:bg-white text-slate-700 shadow-sm":"text-slate-300 cursor-not-allowed"}`,title:"Previous channel",children:e.jsx(us,{size:16,className:"sm:w-[18px] sm:h-[18px]"})}),e.jsxs("span",{className:"text-[10px] sm:text-xs font-medium text-slate-600 px-1 sm:px-2 whitespace-nowrap",children:[Ye+1,"/",c.length]}),e.jsx("button",{onClick:()=>rs("next"),disabled:!Je,className:`p-1.5 sm:p-2 rounded-lg transition-colors ${Je?"hover:bg-white text-slate-700 shadow-sm":"text-slate-300 cursor-not-allowed"}`,title:"Next channel",children:e.jsx(Qe,{size:16,className:"sm:w-[18px] sm:h-[18px]"})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto",children:[e.jsx("div",{className:"flex items-center gap-2 sm:gap-3 mb-1 sm:mb-2",children:t.suggested_posting_time&&e.jsxs("span",{className:"flex items-center gap-1 sm:gap-1.5 text-[10px] sm:text-xs text-slate-500",children:[e.jsx(Ds,{size:12,className:"sm:w-3.5 sm:h-3.5"}),t.suggested_posting_time]})}),e.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-slate-900 mb-1",children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0 flex-wrap w-full sm:w-auto justify-end",children:[!ze&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx($s,{value:me,onChange:a=>y(a),className:"text-xs"})}),Ge.length>1&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("select",{value:se,onChange:a=>ae(Number(a.target.value)),className:"text-xs px-2 py-1.5 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",title:"Select target audience",children:Ge.map((a,p)=>e.jsx("option",{value:p,children:a.name||`Audience ${p+1}`},p))})}),i&&k&&e.jsxs(w,{variant:"outline",size:"sm",onClick:be,loading:he,disabled:he,className:"flex items-center gap-1 sm:gap-2 text-orange-600 hover:text-orange-700 hover:bg-orange-50 text-xs sm:text-sm",title:Ge.length>1?`Regenerate original idea for ${Le.name} using ${me}`:`Regenerate original idea using ${me}`,children:[e.jsx(Ws,{size:14,className:he?"animate-spin":""}),e.jsx("span",{className:"hidden sm:inline",children:"Regenerate Idea"}),e.jsx("span",{className:"sm:hidden",children:"Regen"})]}),i&&z.length>0&&e.jsxs(w,{variant:"outline",size:"sm",onClick:$e,className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(_s,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Send"})]}),e.jsxs(w,{variant:t.is_perfect?"default":"outline",size:"sm",onClick:Ne,disabled:!i||t._streaming,className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(vt,{size:14,className:t.is_perfect?"fill-current":""}),e.jsx("span",{className:"hidden sm:inline",children:t.is_perfect?"Perfect":"Mark Perfect"}),e.jsx("span",{className:"sm:hidden",children:"â˜…"})]}),e.jsx("button",{onClick:l,className:"p-1.5 sm:p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(nt,{size:18,className:"sm:w-5 sm:h-5"})})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6 md:py-8 space-y-4 sm:space-y-6 md:space-y-8",children:[!i&&e.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg text-amber-800",children:"ðŸ‘€ View-only access"}),(t.story_hook||t.character_focus||t.directives||t.media_type||t.call_to_action)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"ðŸ’¡ Original Idea"}),e.jsx(w,{variant:"outline",size:"sm",onClick:X,className:"flex items-center gap-2",children:ye?e.jsxs(e.Fragment,{children:[e.jsx(Cs,{size:14,className:"text-green-600"}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(ss,{size:14}),"Copy"]})})]}),e.jsxs("div",{className:"p-6 bg-gradient-to-br from-orange-50 via-pink-50 to-purple-50 border-2 border-orange-200 rounded-2xl space-y-4",children:[t.story_hook&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-1.5",children:"ðŸŽ£ Hook"}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:t.story_hook})]}),t.directives&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-1.5",children:"ðŸ“‹ Directives"}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed whitespace-pre-wrap",children:t.directives})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 md:gap-4 pt-2 border-t border-orange-200/50",children:[t.character_focus&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-600 mb-1",children:"ðŸŽ­ Character"}),e.jsx("p",{className:"text-sm text-slate-700",children:t.character_focus})]}),t.media_type&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-600 mb-1",children:"ðŸŽ¬ Media Type"}),e.jsx("p",{className:"text-sm text-slate-700 font-medium uppercase tracking-wide",children:t.media_type})]}),t.tone&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-600 mb-1",children:"ðŸŽ¨ Tone"}),e.jsx("p",{className:"text-sm text-slate-700 font-medium",children:t.tone})]}),t.call_to_action&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-600 mb-1",children:"ðŸŽ¯ CTA"}),e.jsx("p",{className:"text-sm text-slate-700",children:t.call_to_action})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Full Creative Execution"}),!ze&&e.jsx($s,{value:me,onChange:y})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-wrap",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>_e(!Z),className:"flex items-center gap-2",title:Z?"Exit Fullscreen":"Fullscreen",children:Z?e.jsx(Ts,{size:14}):e.jsx(sa,{size:14})}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>W(!Se),disabled:!i,className:"flex items-center gap-2",title:"Toggle Rich Text Editor",children:[e.jsx(et,{size:14}),Se?"Plain":"Rich"]}),!t.expanded_brief&&!t.final_brief?e.jsxs(w,{size:"sm",onClick:B,loading:V,disabled:!i||t._streaming,className:"flex items-center gap-2 bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white",title:`Expand brief into full content using ${me}`,children:[e.jsx(ta,{size:14}),"Expand Brief"]}):null,e.jsx(w,{variant:"outline",size:"sm",onClick:ve,disabled:!i||E.length===0,className:"flex items-center gap-2",title:"Undo",children:e.jsx(aa,{size:14})}),e.jsx(w,{variant:"outline",size:"sm",onClick:v,disabled:!i||D.length===0,className:"flex items-center gap-2",title:"Redo",children:e.jsx(ra,{size:14})}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>ie(void 0,null,function*(){if(T){const a=document.createElement("div");a.innerHTML=T;const p=a.textContent||a.innerText||T;yield navigator.clipboard.writeText(p),H(!0),setTimeout(()=>H(!1),2e3)}}),disabled:!T,className:"flex items-center gap-2",children:[Q?e.jsx(Cs,{size:14,className:"text-green-600"}):e.jsx(ss,{size:14}),Q?"Copied!":"Copy"]}),(t.expanded_brief||t.final_brief)&&e.jsxs(w,{variant:"primary",size:"sm",onClick:B,loading:V,disabled:!i||t._streaming,className:"flex items-center gap-2 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white",title:`Regenerate expanded brief using ${me}`,children:[e.jsx(Ws,{size:14,className:V?"animate-spin":""}),"Regenerate Expansion"]})]})]}),Se?e.jsxs("div",{className:`${Z?"fixed inset-0 z-[90] bg-white flex flex-col overflow-hidden":""}`,children:[Z&&e.jsxs("div",{className:"flex items-center justify-between gap-3 px-8 py-4 border-b border-slate-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Full Creative Execution"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${C==="saved"?"bg-green-100 text-green-700":C==="saving"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:C==="saved"?"âœ“ Saved":C==="saving"?"â³ Saving...":"âš  Unsaved"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&z.length>0&&e.jsxs(w,{variant:"outline",size:"sm",onClick:$e,className:"flex items-center gap-2",children:[e.jsx(_s,{size:14}),"Send Brief"]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>_e(!1),className:"flex items-center gap-2",children:[e.jsx(Ts,{size:14}),"Exit Fullscreen"]})]})]}),e.jsx("div",{className:`${Z?"flex-1 overflow-y-auto px-8 py-6":""}`,children:e.jsx("div",{className:`${Z?"max-w-4xl mx-auto":""}`,children:e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"min-h-[300px] flex items-center justify-center bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading editor..."})]})}),children:e.jsx(qr,{ref:Oe,value:T,onChange:a=>{t.is_perfect?Y(!0):ce(a)},readOnly:!i||t._streaming,theme:"snow",className:`${Z?"h-auto":"min-h-[300px]"}`,placeholder:"Click 'Expand Brief' to generate the full script/article/copy, or type your own content here...",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","blockquote","code-block"],["clean"]]}})})})})]}):e.jsxs("div",{className:`${Z?"fixed inset-0 z-[90] bg-white flex flex-col overflow-hidden":""}`,children:[Z&&e.jsxs("div",{className:"flex items-center justify-between gap-3 px-8 py-4 border-b border-slate-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Full Creative Execution"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${C==="saved"?"bg-green-100 text-green-700":C==="saving"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:C==="saved"?"âœ“ Saved":C==="saving"?"â³ Saving...":"âš  Unsaved"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&z.length>0&&e.jsxs(w,{variant:"outline",size:"sm",onClick:$e,className:"flex items-center gap-2",children:[e.jsx(_s,{size:14}),"Send Brief"]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>_e(!1),className:"flex items-center gap-2",children:[e.jsx(Ts,{size:14}),"Exit Fullscreen"]})]})]}),e.jsx("div",{className:`${Z?"flex-1 overflow-y-auto px-8 py-6":""}`,children:e.jsx("div",{className:`${Z?"max-w-4xl mx-auto":""}`,children:e.jsx(Ie,{value:T,onChange:a=>{t.is_perfect?Y(!0):ce(a.target.value)},placeholder:"Click 'Expand Brief' to generate the full script/article/copy, or type your own prompt/notes here first to guide Andora's writing...",disabled:!i||t._streaming,rows:Z?30:12,className:`text-sm leading-relaxed font-mono ${Z?"w-full min-h-screen":""}`})})})]})]}),e.jsxs("div",{className:"p-6 bg-gradient-to-br from-orange-50 via-pink-50 to-purple-50 border-2 border-orange-200 rounded-2xl space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5 text-orange-600"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Review"})]}),e.jsx("p",{className:"text-xs text-slate-600",children:"Andora will review your notes below and expand them into a full creative brief in the draft field above"}),e.jsx(Ie,{value:te,onChange:a=>re(a.target.value),placeholder:"Write your review notes here - ideas, directions, tweaks you want. Andora will contextualize this with the original brief and create an expanded version...",disabled:!i||t._streaming,rows:3,className:"bg-white/80 text-sm"}),e.jsxs(w,{onClick:fe,loading:le,disabled:!i||!te.trim()||t._streaming,className:"w-full bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white",children:[e.jsx(ds,{size:16,className:"mr-2"}),le?"Andora is reviewing...":"Review"]})]}),z.length>0&&e.jsxs("div",{className:"p-6 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-2 border-blue-200 rounded-2xl space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Team Comments"})]}),e.jsx("p",{className:"text-xs text-slate-600",children:"Leave notes for your team about this brief"}),e.jsx(Ie,{value:t.comments||"",onChange:a=>{i&&N(t.id,{comments:a.target.value})},placeholder:"Add comments for your team here...",disabled:!i||t._streaming,rows:3,className:"bg-white/80 text-sm"})]})]})})]}),ee&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>q(!1)}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Send Brief to Team"}),e.jsx("div",{className:"space-y-2 mb-6 max-h-64 overflow-y-auto",children:z.map(a=>e.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-slate-50 rounded-lg cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ge.includes(a.id),onChange:p=>{p.target.checked?Ce([...ge,a.id]):Ce(ge.filter(M=>M!==a.id))},className:"w-4 h-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:a.name}),e.jsx("p",{className:"text-xs text-slate-500",children:a.email})]})]},a.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",onClick:()=>q(!1),className:"flex-1",children:"Cancel"}),e.jsxs(w,{onClick:Ue,disabled:ge.length===0,className:"flex-1",children:["Send to ",ge.length," member(s)"]})]})]})]}),e.jsx(ma,{isOpen:ue,onClose:()=>ke(!1),expandedBrief:(t==null?void 0:t.expanded_brief)||(t==null?void 0:t.final_brief)||"",observerFeedback:pe,onSendToDraft:h}),Ke&&e.jsxs("div",{className:"fixed inset-0 z-[101] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>Y(!1)}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"This content is marked as perfect."}),e.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Editing this content will mark it as imperfect. Are you sure you want to continue?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",onClick:()=>Y(!1),className:"flex-1",children:"Cancel"}),e.jsx(w,{onClick:()=>{Y(!1),N(t.id,{is_perfect:!1})},className:"flex-1",children:"Edit Anyway"})]})]})]})]})},ht={dashboard:[{id:"dashboard-welcome",target:'[data-tour="brand-overview"]',title:"Welcome to Your Dashboard",content:"This is your command center. See brand health, recent activity, and quick actions all in one place.",placement:"bottom",spotlightPadding:16},{id:"dashboard-quick-actions",target:'[data-tour="quick-actions"]',title:"Quick Actions",content:"Jump to any section of your brand workspace with these quick action buttons.",placement:"top",spotlightPadding:12}],config:[{id:"config-brand-identity",target:'[data-tour="brand-identity"]',title:"Brand Identity",content:"Define your brand's core identity: name, tagline, industry, and personality. This guides all AI-generated content.",placement:"right",spotlightPadding:20},{id:"config-channels",target:'[data-tour="channels"]',title:"Content Channels",content:"Select which platforms you publish on. Andora will tailor content for each channel's unique format.",placement:"left",spotlightPadding:16},{id:"config-posting-schedule",target:'[data-tour="posting-schedule"]',title:"Posting Schedule",content:"Set which channels you post to on each day of the week. This controls your content calendar generation.",placement:"top",spotlightPadding:16}],plot:[{id:"plot-narrative",target:'[data-tour="narrative"]',title:"Brand Narrative",content:"Your brand's story foundation. This narrative guides character development and content themes.",placement:"bottom",spotlightPadding:20},{id:"plot-characters",target:'[data-tour="characters"]',title:"Brand Characters",content:"Create AI personas that embody different aspects of your brand. Each character has a unique voice and perspective.",placement:"top",spotlightPadding:16},{id:"plot-generate-cast",target:'[data-tour="generate-cast"]',title:"Generate Characters",content:"Let AI create a full cast of brand characters based on your narrative. You can refine them later.",placement:"left",spotlightPadding:12}],events:[{id:"events-calendar",target:'[data-tour="events-calendar"]',title:"Events Calendar",content:"Add important dates, product launches, holidays, and campaigns. Events automatically influence content generation.",placement:"bottom",spotlightPadding:16},{id:"events-add",target:'[data-tour="add-event"]',title:"Add Events",content:"Click here to add new events. Include dates, descriptions, and importance levels to guide content.",placement:"left",spotlightPadding:12}],season:[{id:"season-overview",target:'[data-tour="season-overview"]',title:"Seasonal Planning",content:"Plan your content strategy by month. Set themes, plot arcs, and weekly subplots for cohesive storytelling.",placement:"bottom",spotlightPadding:20},{id:"season-themes",target:'[data-tour="monthly-themes"]',title:"Monthly Themes",content:"Each month gets a core theme or message. This creates consistency across all your content.",placement:"right",spotlightPadding:16},{id:"season-subplots",target:'[data-tour="weekly-subplots"]',title:"Weekly Subplots",content:"Break down monthly themes into weekly story arcs. Each week advances your brand narrative.",placement:"top",spotlightPadding:16}],monthly:[{id:"monthly-calendar",target:'[data-tour="calendar-grid"]',title:"Your Content Calendar",content:"This is your monthly content at a glance. Each day shows planned posts across all your channels.",placement:"bottom",spotlightPadding:20},{id:"monthly-generate-week",target:'[data-tour="generate-week"]',title:"Generate Content for a Week",content:"Click here to let me generate content for a specific week. I will consider your themes, events, and characters.",placement:"top",spotlightPadding:16},{id:"monthly-generate-month",target:'[data-tour="generate-month"]',title:"Generate Content for a Full Month",content:"Click here to let me generate content for the entire month. I will skip any content that you have marked as perfect.",placement:"top",spotlightPadding:16},{id:"monthly-embed-events",target:'[data-tour="embed-events"]',title:"Embed Your Events",content:"If you have any events that are not yet part of your story, you can embed them here. I will weave them into your weekly subplots.",placement:"top",spotlightPadding:16},{id:"monthly-model-switcher",target:'[data-tour="model-switcher"]',title:"Select Your AI Model",content:"You can choose which AI model I should use. Some are better for creative tasks, while others are faster and more cost-effective.",placement:"left",spotlightPadding:12}]},pt="andora-guided-tour-progress",Xr=s=>{const[l,r]=n.useState(!1),[c,u]=n.useState(0),[o,N]=n.useState({});n.useEffect(()=>{try{const t=localStorage.getItem(pt);t&&N(JSON.parse(t))}catch(t){console.error("Failed to load tour progress:",t)}},[]);const k=n.useCallback(t=>{try{localStorage.setItem(pt,JSON.stringify(t)),N(t)}catch(F){console.error("Failed to save tour progress:",F)}},[]);n.useEffect(()=>{const t=o[s];if(ht[s]&&ht[s].length>0&&!(t!=null&&t.completed)&&!(t!=null&&t.dismissed)){const T=setTimeout(()=>{r(!0),u((t==null?void 0:t.currentStep)||0)},500);return()=>clearTimeout(T)}},[s,o]);const x=ht[s]||[],i=x[c],d=n.useCallback(()=>{if(c<x.length-1){const t=c+1;u(t);const F=R(I({},o),{[s]:{completed:!1,currentStep:t,dismissed:!1}});k(F)}else{const t=R(I({},o),{[s]:{completed:!0,currentStep:0,dismissed:!1}});k(t),r(!1)}},[c,x.length,s,o,k]),A=n.useCallback(()=>{if(c>0){const t=c-1;u(t);const F=R(I({},o),{[s]:{completed:!1,currentStep:t,dismissed:!1}});k(F)}},[c,s,o,k]),g=n.useCallback(()=>{const t=R(I({},o),{[s]:{completed:!1,currentStep:0,dismissed:!0}});k(t),r(!1)},[s,o,k]),m=n.useCallback(()=>{u(0),r(!0);const t=R(I({},o),{[s]:{completed:!1,currentStep:0,dismissed:!1}});k(t)},[s,o,k]),j=n.useCallback(()=>{localStorage.removeItem(pt),N({}),r(!1)},[]);return{isActive:l,currentStep:i,currentStepIndex:c,totalSteps:x.length,nextStep:d,previousStep:A,skipTour:g,restartTour:m,resetAllProgress:j,hasSteps:x.length>0,isFirstStep:c===0,isLastStep:c===x.length-1}},Qr=({isActive:s,currentStep:l,currentStepIndex:r,totalSteps:c,nextStep:u,previousStep:o,skipTour:N})=>{var k,x;return!s||!l?null:e.jsxs("div",{className:"fixed inset-0 z-[10000]",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),e.jsx("div",{className:"absolute",style:{top:l.target?(k=document.querySelector(l.target))==null?void 0:k.getBoundingClientRect().top:"50%",left:l.target?(x=document.querySelector(l.target))==null?void 0:x.getBoundingClientRect().left:"50%",transform:"translate(-50%, -50%)"},children:e.jsxs("div",{className:"relative rounded-lg bg-white p-6 shadow-2xl",style:{width:"300px"},children:[e.jsx("button",{onClick:N,className:"absolute top-2 right-2 p-1 text-slate-500 hover:text-slate-700",children:e.jsx(nt,{size:18})}),e.jsx("h3",{className:"text-lg font-bold mb-2",children:l.title}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:l.content}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:[r+1," / ",c]}),e.jsxs("div",{className:"flex gap-2",children:[r>0&&e.jsxs(w,{onClick:o,variant:"outline",size:"sm",children:[e.jsx(Ss,{size:16,className:"mr-1"}),"Prev"]}),e.jsxs(w,{onClick:u,size:"sm",children:[r===c-1?"Finish":"Next",e.jsx(Ps,{size:16,className:"ml-1"})]})]})]})]})})]})},en=({brand:s,calendar:l,month:r,monthTheme:c,events:u=[],weeklySubplots:o={}})=>{const[N,k]=r.split("-"),x=new Date(parseInt(N),parseInt(k)-1,1).toLocaleDateString("en-US",{month:"long",year:"numeric"});let i="";i+="â•".repeat(80)+`
`,i+=`${s.name.toUpperCase()} - CONTENT CALENDAR
`,i+=`${x}
`,i+="â•".repeat(80)+`

`,i+=`*BRAND OVERVIEW*
`,i+="â”€".repeat(80)+`
`,i+=`Tagline: _"${s.tagline}"_
`,s.industry&&(i+=`Industry: ${s.industry}
`),s.vision&&(i+=`Vision: ${s.vision}
`),i+=`
`,c&&(i+=`*MONTHLY THEME*
`,i+="â”€".repeat(80)+`
`,i+=`${c}

`);const d=Object.entries(o);d.length>0&&(i+=`*WEEKLY SUBPLOTS*
`,i+="â”€".repeat(80)+`
`,d.sort(([g],[m])=>parseInt(g)-parseInt(m)).forEach(([g,m])=>{const j=m.perfect?" â˜…":"";i+=`
Week ${g}${j}:
`,i+=`${m.subplot}
`}),i+=`
`),u.length>0&&(i+=`*SCHEDULED EVENTS*
`,i+="â”€".repeat(80)+`
`,u.forEach(g=>{const m=new Date(g.date+"T12:00:00Z").toLocaleDateString("en-US",{month:"short",day:"numeric",timeZone:"UTC"}),j=g.embedded_in_subplot?" [Embedded]":"";i+=`â€¢ ${m}: ${g.title}${j}
`,g.description&&(i+=`  ${g.description}
`)}),i+=`
`),i+=`*CONTENT CALENDAR*
`,i+="â•".repeat(80)+`

`;const A={};return l.items.forEach(g=>{const m=new Date(g.date+"T12:00:00Z"),j=Math.ceil(m.getUTCDate()/7);A[j]||(A[j]=[]),A[j].push(g)}),Object.entries(A).sort(([g],[m])=>parseInt(g)-parseInt(m)).forEach(([g,m])=>{i+=`â”Œ${"â”€".repeat(78)}â”
`,i+=`â”‚ WEEK ${g}${" ".repeat(72-g.length)}â”‚
`,i+=`â””${"â”€".repeat(78)}â”˜

`,m.sort((t,F)=>t.date.localeCompare(F.date)).forEach(t=>{const F=new Date(t.date+"T12:00:00Z"),T=F.toLocaleDateString("en-US",{weekday:"long",timeZone:"UTC"}),_=F.toLocaleDateString("en-US",{month:"short",day:"numeric",timeZone:"UTC"}),E=t.is_perfect?" â˜…":"",S=sn(t.channel);i+=`â”Œâ”€ ${T}, ${_} ${S} ${t.channel}${E}
`,i+=`â”‚
`,i+=`â”‚ *${t.title}*
`,i+=`â”‚
`,(t.character_name||t.format_style)&&(i+="â”‚ ",t.character_name&&(i+=`Character: _${t.character_name}_`),t.character_name&&t.format_style&&(i+=" | "),t.format_style&&(i+=`Format: _${t.format_style}_`),i+=`
â”‚
`),t.suggested_posting_time&&(i+=`â”‚ â° ${t.suggested_posting_time}
â”‚
`),t.brief&&(i+=`â”‚ BRIEF:
`,t.brief.split(`
`).forEach(te=>{te.trim()&&(i+=`â”‚ ${te}
`)}),i+=`â”‚
`);const D=t.user_revision||t.final_brief||t.expanded_brief;D&&(i+=`â”‚ CONTENT:
`,D.replace(/<h[1-6][^>]*>/gi,`
â”‚ *`).replace(/<\/h[1-6]>/gi,`*
â”‚
`).replace(/<strong[^>]*>/gi,"*").replace(/<\/strong>/gi,"*").replace(/<em[^>]*>/gi,"_").replace(/<\/em>/gi,"_").replace(/<p[^>]*>/gi,`
â”‚ `).replace(/<\/p>/gi,`
`).replace(/<br\s*\/?>/gi,`
â”‚ `).replace(/<li[^>]*>/gi,`
â”‚ â€¢ `).replace(/<\/li>/gi,"").replace(/<ul[^>]*>|<\/ul>/gi,`
`).replace(/<[^>]+>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').split(`
`).forEach(re=>{re.trim()&&tn(re.replace(/^â”‚\s*/,""),75).forEach(U=>{i+=`â”‚ ${U}
`})}),i+=`â”‚
`),t.hashtags&&t.hashtags.length>0&&(i+=`â”‚ ${t.hashtags.join(" ")}
â”‚
`),t.comments&&(i+=`â”‚ ðŸ’¬ TEAM NOTES:
`,t.comments.split(`
`).forEach(te=>{te.trim()&&(i+=`â”‚    ${te}
`)}),i+=`â”‚
`),i+=`â””${"â”€".repeat(78)}

`})}),i+="â•".repeat(80)+`
`,i+=`Generated by Andora - ${new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}
`,i+="â•".repeat(80)+`
`,i},sn=s=>({instagram:"ðŸ“¸",facebook:"ðŸ“˜",twitter:"ðŸ¦",linkedin:"ðŸ’¼",tiktok:"ðŸŽµ",youtube:"ðŸ“º",blog:"ðŸ“",email:"âœ‰ï¸",website:"ðŸŒ"})[s.toLowerCase()]||"ðŸ“¢",tn=(s,l)=>{const r=s.split(" "),c=[];let u="";return r.forEach(o=>{(u+o).length>l?(u&&c.push(u.trim()),u=o+" "):u+=o+" "}),u.trim()&&c.push(u.trim()),c},an=(s,l)=>{const r=new Blob([s],{type:"text/plain;charset=utf-8"}),c=URL.createObjectURL(r),u=document.createElement("a");u.href=c,u.download=l,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c)},rn=({brand:s,events:l,onBrandUpdate:r,preferredModel:c,canEdit:u=!0})=>{const[o,N]=_t(c||"gemini-2.5-flash"),k=vs.useCallback(v=>{typeof N=="function"&&N(v)},[N]),{message:x,modelInfo:i,isVisible:d,showNotification:A,hideNotification:g,updateMessage:m,action:j}=ia(),[t,F]=n.useState(()=>{const v=new Date;return`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}`}),[T,_]=n.useState(null),[E,S]=n.useState(!1),[D,G]=n.useState(!1),[te,re]=n.useState(null),[V,U]=n.useState(null),[le,we]=n.useState({current:0,total:0}),[he,L]=n.useState(!1),[Q,H]=n.useState(!1),[ye,f]=n.useState(!1),[ee,q]=n.useState(new Set),[ue,ke]=n.useState([]),[ge,Ce]=n.useState(!1),[Z,_e]=n.useState(!1),[Se,W]=n.useState(null),me=n.useRef(null),y=s.monthly_calendars[t],C=n.useMemo(()=>!y||u?y:R(I({},y),{items:y.items.filter(v=>v.is_perfect)}),[y,u]);n.useEffect(()=>{const v=O=>{me.current&&!me.current.contains(O.target)&&L(!1)};return he&&document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[he]),n.useEffect(()=>{if(C&&C.items&&C.items.some(O=>O._streaming)){console.log("ðŸ§¹ Cleaning up stuck _streaming flags...");const O=C.items.map(K=>{if(K._streaming){const z=I({},K);return delete z._streaming,z}return K});r({monthly_calendars:R(I({},s.monthly_calendars),{[t]:{month:t,items:O}})})}},[t,C]);const P=new Date(t+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),se=n.useMemo(()=>l.filter(v=>v.event_date.startsWith(t)),[l,t]),ae=n.useMemo(()=>{var Ne;const[v,O]=t.split("-").map(Number),K=new Date(v,O,0).getDate(),z=((Ne=s.channels)==null?void 0:Ne.length)||0,B=K*z,X=(C==null?void 0:C.items)||[],xe=X.length,fe=X.filter(be=>be.is_perfect).length;return{totalSlots:B,created:xe,perfect:fe}},[t,s.channels,C]);n.useEffect(()=>{const v=()=>ie(void 0,null,function*(){try{const[O,K]=t.split("-"),z=yield De.getUnembeddedEvents(s.brand_id,O,K);ke(z||[])}catch(O){console.error("Failed to fetch unembedded events:",O),ke([])}});s.brand_id&&v()},[t,s.brand_id,l]);const pe=v=>{const[O,K]=t.split("-").map(Number),z=new Date(O,K-1);v==="prev"?z.setMonth(z.getMonth()-1):z.setMonth(z.getMonth()+1);const B=`${z.getFullYear()}-${String(z.getMonth()+1).padStart(2,"0")}`;F(B)},je=v=>{_(v),S(!0)},Ke=(v,O)=>{if(!u)return;const K=s.monthly_calendars[t];if(!K)return;const z=K.items.map(B=>B.id===v?I(I({},B),O):B);r({monthly_calendars:R(I({},s.monthly_calendars),{[t]:R(I({},K),{items:z})})}),(T==null?void 0:T.id)===v&&_(I(I({},T),O))},Y=v=>ie(void 0,null,function*(){if(!u)return;const O=s.monthly_calendars[t];if(!O)return;const K=O.items.find(z=>z.id===v);if(K){A("ai_regenerate_content",o);try{const z=ze(K.date),B=yield ms.generateContentCalendarEntry(s,K.date,R(I({},z),{preferredChannels:[K.channel]}),o),X=R(I({},B),{id:v}),xe=O.items.map(fe=>fe.id===v?X:fe);r({monthly_calendars:R(I({},s.monthly_calendars),{[t]:R(I({},O),{items:xe})})}),_(X)}catch(z){throw console.error("Failed to regenerate content:",z),z}finally{g()}}}),Oe=()=>{const[v,O]=t.split("-").map(Number),z=new Date(v,O,0).getDate(),B=[];return[{start:1,end:7},{start:8,end:14},{start:15,end:21},{start:22,end:28},{start:29,end:z}].forEach((xe,fe)=>{const Ne=fe+1,be=[];for(let $e=xe.start;$e<=Math.min(xe.end,z);$e++){const Ue=`${v}-${String(O).padStart(2,"0")}-${String($e).padStart(2,"0")}`;be.push(Ue)}be.length>0&&B.push({week:Ne,dates:be,startDay:xe.start,endDay:Math.min(xe.end,z)})}),B},Me=v=>{const[O,K,z]=v.split("-").map(Number);return z>=1&&z<=7?1:z>=8&&z<=14?2:z>=15&&z<=21?3:z>=22&&z<=28?4:z>=29?5:1},Ae=()=>{const v=s.monthly_calendars[t];return v?v.items.filter(O=>O.is_perfect).map(O=>({date:O.date,channel:O.channel,title:O.title,brief:O.brief||O.final_brief,character_focus:O.character_focus,story_hook:O.story_hook})):[]},ze=v=>{var xe,fe;const O=(xe=s.monthly_themes)==null?void 0:xe[t],K=typeof O=="string"?O:(O==null?void 0:O.theme)||"",z=(fe=s.season_plans)==null?void 0:fe[t];let B="";if(v&&(z!=null&&z.weekly)){const Ne=Me(v),be=z.weekly[Ne];B=(be==null?void 0:be.subplot)||(be==null?void 0:be.custom_theme)||""}const X=Ae();return{monthTheme:K||(z==null?void 0:z.theme)||`${s.brand_name} updates for ${P}`,weekFocus:B,monthlyPlot:(z==null?void 0:z.monthlyPlot)||"",preferredChannels:s.channels||["LinkedIn"],events:se,characters:s.cast_management||[],perfectContent:X}},Ge=v=>ie(void 0,null,function*(){var O;if(!(!u||D)){G(!0),re(v),U("day"),A("ai_generate_content_day",o);try{const K=ze(v),z=new Date(v+"T12:00:00Z"),B=s.timezone||"UTC",X=z.toLocaleDateString("en-US",{weekday:"long",timeZone:B}).toLowerCase(),xe=(O=s.channel_schedule)==null?void 0:O[X];if(!xe||xe.length===0){console.log(`â­ï¸ Skipping ${v} (${X}) - no channels scheduled`),g(),G(!1),re(null),U(null);return}const fe=[];for(const Ne of xe)try{const be=yield ms.generateContentCalendarEntry(s,v,R(I({},K),{preferredChannels:[Ne]}),o);fe.push(be)}catch(be){console.error(`Failed to generate content for ${Ne}:`,be)}if(fe.length>0){const Ne=s.monthly_calendars[t]||{month:t,items:[]},$e=[...Ne.items.filter(Ue=>Ue.date!==v),...fe];r({monthly_calendars:R(I({},s.monthly_calendars),{[t]:R(I({},Ne),{items:$e})})})}}catch(K){console.error("Failed to generate content:",K),alert("Failed to generate content. Please try again.")}finally{g(),G(!1),re(null),U(null)}}}),Le=(v,O)=>ie(void 0,null,function*(){if(!u||D)return;const K=s.id||s.brand_id;console.log("ðŸŽ¬ Generate Week Called (STREAMING):",{weekNum:v,dates:O,brandId:K}),A("ai_generate_content_week",o),G(!0),f(!1),U("week");try{const z=s.monthly_calendars[t]||{month:t,items:[]},B={},X=[];if(O.forEach(p=>{const M=new Date(p+"T12:00:00Z"),$=s.timezone||"UTC",ne=M.toLocaleDateString("en-US",{weekday:"long",timeZone:$}).toLowerCase();let J=[];s.channel_schedule?J=s.channel_schedule[ne]||[]:J=s.channels||["LinkedIn"],J.length>0?(B[p]=J,X.push(p)):console.log(`â­ï¸ Skipping ${p} (${ne}) - no channels scheduled`)}),X.length===0){alert("No channels scheduled for any days in this week. Please configure your Channel Posting Schedule in Brand Profile.");return}O=X;const xe=z.items.filter(p=>O.includes(p.date)).map(p=>({date:p.date,channel:p.channel,is_perfect:p.is_perfect,story_hook:p.story_hook||p.title})),fe={brandId:K,dates:O,channels:B,existingContent:xe,model:o};console.log("ðŸ“¡ Connecting to SSE stream...");const Ne=yield fetch("https://andorabrand.me/api/content/generate-week-stream",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify(fe)});if(!Ne.ok)throw new Error("Failed to start streaming");if(!Ne.body)throw new Error("No response body");const be=Ne.body.getReader(),$e=new TextDecoder;let Ue="";const h=[],a=new Set;for(;;){const{done:p,value:M}=yield be.read();if(p)break;if(ye){be.cancel(),console.log("ðŸ›‘ Stream cancelled by user");break}Ue+=$e.decode(M,{stream:!0});const $=Ue.split(`
`);Ue=$.pop()||"";for(const ne of $)if(!(!ne.trim()||ne.startsWith(":"))){if(ne.startsWith("event:")){const J=ne.slice(6).trim();continue}if(ne.startsWith("data:"))try{const J=JSON.parse(ne.slice(5).trim());if(J.message&&m(J.message,J.model||o),J.entry){const Te=J.entry,Xe=`content-${Te.date}-${Te.channel}-${Date.now()}-${h.length}`,ts=`${Te.date}-${Te.channel}`;a.add(ts);const gs={id:Xe,date:Te.date,channel:Te.channel,title:Te.title||"...",brief:Te.brief||"...",final_brief:Te.brief||"...",story_hook:Te.story_hook||"...",directives:Te.directives||"",character_focus:Te.character_focus||"",media_type:Te.media_type||"",call_to_action:Te.call_to_action||"",is_perfect:!1,_streaming:!0};h.push(gs);const zs=new Set(O),Ee=[...z.items.filter(os=>!zs.has(os.date)||os.is_perfect),...h];r({monthly_calendars:R(I({},s.monthly_calendars),{[t]:{month:t,items:Ee}})}),q(os=>new Set(os).add(ts)),we({current:h.length,total:h.length+1}),setTimeout(()=>{q(ys=>{const xs=new Set(ys);return xs.delete(ts),xs});const ns=(s.monthly_calendars[t]||{month:t,items:[]}).items.map(ys=>{if(`${ys.date}-${ys.channel}`===ts&&ys._streaming){const xs=I({},ys);return delete xs._streaming,xs}return ys});r({monthly_calendars:R(I({},s.monthly_calendars),{[t]:{month:t,items:ns}})})},1500)}J.totalEntries&&(console.log(`âœ… Stream complete: ${J.totalEntries} entries generated`),m(`Generated ${J.totalEntries} content entries`,o))}catch(J){console.warn("Failed to parse SSE data:",ne)}}}}catch(z){console.error("Failed to generate week:",z),alert("Failed to generate week content. Please try again.")}finally{g(),G(!1),f(!1),re(null),U(null),we({current:0,total:0});const z=s.monthly_calendars[t];if(z&&z.items.some(B=>B._streaming)){const B=z.items.map(X=>{if(X._streaming){const xe=I({},X);return delete xe._streaming,xe}return X});r({monthly_calendars:R(I({},s.monthly_calendars),{[t]:{month:t,items:B}})})}setTimeout(()=>{q(new Set)},2e3)}}),Ye=()=>{f(!0)},Re=()=>ie(void 0,null,function*(){var K;if(!u||D)return;const v=Oe();if(v.length===0)return;const O=v.flatMap(z=>z.dates);G(!0),U("month"),f(!1),we({current:0,total:O.length}),m(`Generating content for ${O.length} days in ${P}...`,o);try{const z=s.monthly_calendars[t]||{month:t,items:[]},B=[];for(let X=0;X<O.length;X++){if(ye){console.log("Generation stopped by user");break}const xe=O[X];re(xe),we({current:X+1,total:O.length});const fe=new Date(xe+"T12:00:00Z"),Ne=fe.toLocaleDateString("en-US",{month:"short",day:"numeric",timeZone:"UTC"});m(`Generating content for ${Ne}...`,o);const be=ze(xe),$e=z.items.filter(M=>M.date===xe);if($e.some(M=>M.is_perfect)&&$e.every(M=>M.is_perfect))continue;const h=s.timezone||"UTC",a=fe.toLocaleDateString("en-US",{weekday:"long",timeZone:h}).toLowerCase(),p=(K=s.channel_schedule)==null?void 0:K[a];if(!p||p.length===0){console.log(`â­ï¸ Skipping ${xe} (${a}) - no channels scheduled`);continue}for(const M of p){if(ye)break;const $=$e.find(ne=>ne.channel===M);if(!($!=null&&$.is_perfect))try{const ne=yield ms.generateContentCalendarEntry(s,xe,R(I({},be),{preferredChannels:[M]}),o);B.push(ne),q(J=>new Set(J).add(ne.id)),setTimeout(()=>{q(J=>{const Te=new Set(J);return Te.delete(ne.id),Te})},1500)}catch(ne){console.error(`Failed to generate content for ${M} on ${xe}:`,ne)}}}if(B.length>0){const xe=[...z.items.filter(fe=>fe.is_perfect),...B];r({monthly_calendars:R(I({},s.monthly_calendars),{[t]:{month:t,items:xe}})})}}catch(z){console.error("Failed to generate month:",z),alert("Failed to generate month content. Please try again.")}finally{g(),G(!1),f(!1),re(null),U(null),we({current:0,total:0}),q(new Set)}}),Je=(v,O=!1)=>ie(void 0,null,function*(){Ce(!0),m(`Embedding events into Week ${v}...`,o);try{const[K,z]=t.split("-"),B=yield De.embedEventsIntoWeek(s.brand_id,K,z,v,O);if(B.needsConfirmation&&!O){W(v),_e(!0),g();return}const X=yield De.getUnembeddedEvents(s.brand_id,K,z);if(ke(X||[]),m(`Successfully embedded ${B.eventsEmbedded} event(s) into Week ${v}`,o,{label:"Undo",onClick:()=>rs(v)}),B.shouldRegenerateContent&&confirm(`Week ${v} subplot has been updated. Would you like to regenerate imperfect content for this week?`)){const Ne=Oe().find(be=>be.week===v);Ne&&(yield Le(v,Ne.dates))}}catch(K){console.error("Failed to embed events:",K),g(),alert("Failed to embed events. Please try again.")}finally{Ce(!1),_e(!1),W(null)}}),rs=v=>ie(void 0,null,function*(){try{const[O,K]=t.split("-");yield De.undoEmbedEvents(s.brand_id,O,K,v);const z=yield De.getUnembeddedEvents(s.brand_id,O,K);ke(z||[]),g(),alert(`Successfully restored subplot for week ${v}`)}catch(O){console.error("Failed to undo embed events:",O),alert("Failed to undo embed events. Please try again.")}}),is=(()=>{const v={},O=Oe();return ue.forEach(K=>{const z=K.start_date||K.event_date;if(!z)return;const B=O.find(X=>X.dates.some(xe=>xe===z));B&&(v[B.week]=(v[B.week]||0)+1)}),v})(),Be=()=>{var v,O;try{const[K,z]=t.split("-"),B=(v=s.season_plans)==null?void 0:v[t],X=(B==null?void 0:B.weekly)||{},xe=en({brand:s,calendar:C,month:t,monthTheme:(O=s.monthly_themes)==null?void 0:O[t],events:se,weeklySubplots:X}),fe=new Date(parseInt(K),parseInt(z)-1,1).toLocaleDateString("en-US",{month:"long",year:"numeric"}).replace(/\s+/g,"_"),Ne=`${s.name.replace(/\s+/g,"_")}_${fe}_Calendar.txt`;an(xe,Ne)}catch(K){console.error("Export failed:",K),alert("Failed to export calendar. Please try again.")}},{isActive:Ze,currentStep:We,currentStepIndex:He,totalSteps:b,nextStep:oe,previousStep:ce,skipTour:ve}=Xr("monthly");return e.jsxs("div",{className:"max-w-6xl mx-auto p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6",children:[e.jsx(Qr,{isActive:Ze,currentStep:We,currentStepIndex:He,totalSteps:b,nextStep:oe,previousStep:ce,skipTour:ve}),e.jsx(kt,{message:x,show:d,modelInfo:i,progress:D&&le.total>0?le:null,onStop:D?Ye:void 0,action:j}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsx(ps,{className:"w-6 h-6 sm:w-8 sm:h-8 text-primary-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold shimmer-text",children:"Monthly Content Calendar"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 mt-1 text-xs sm:text-sm",children:[e.jsxs("span",{className:"text-slate-600",children:[e.jsx("span",{className:"font-semibold text-primary-600",children:ae.created}),e.jsxs("span",{className:"text-slate-400",children:["/",ae.totalSlots]}),e.jsx("span",{className:"text-slate-500 ml-1",children:"slots created"})]}),e.jsx("span",{className:"text-slate-400",children:"â€¢"}),e.jsxs("span",{className:"text-slate-600",children:[e.jsx("span",{className:"font-semibold text-green-600",children:ae.perfect}),e.jsxs("span",{className:"text-slate-400",children:["/",ae.created]}),e.jsx("span",{className:"text-slate-500 ml-1",children:"perfect"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap w-full sm:w-auto",children:[e.jsx("div",{"data-tour":"model-switcher",children:e.jsx($s,{value:o,onChange:k})}),D&&e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 px-2 sm:px-3 md:px-4 py-1.5 sm:py-2 bg-primary-50 border border-primary-200 rounded-lg",children:[e.jsx(rt,{className:"w-3 h-3 sm:w-4 sm:h-4 text-primary-600 animate-spin"}),e.jsxs("span",{className:"text-xs sm:text-sm text-primary-700",children:[V==="month"&&`Generating month... (${le.current}/${le.total})`,V==="week"&&`Generating week... (${le.current}/${le.total})`,V==="day"&&"Generating content...",!V&&"Generating content..."]})]})]})]}),u&&e.jsxs("div",{className:"glass-effect rounded-xl p-3 sm:p-4 border border-primary-500/20",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4 sm:w-5 sm:h-5 text-primary-500"}),e.jsx("span",{className:"text-xs sm:text-sm font-semibold text-dark-900",children:"Story Scene Generation"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-wrap w-full sm:w-auto",children:[e.jsxs("div",{className:"relative flex-1 sm:flex-initial",ref:me,"data-tour":"generate-week",children:[e.jsxs(w,{onClick:()=>L(!he),disabled:D,size:"sm",variant:"outline",className:"flex items-center gap-1 sm:gap-2 w-full sm:w-auto text-xs sm:text-sm",children:[e.jsx(Pe,{size:14,className:"sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Generate Week"}),e.jsx("span",{className:"sm:hidden",children:"Week"}),e.jsx(Qs,{size:12,className:`sm:w-3.5 sm:h-3.5 transition-transform ${he?"rotate-180":""}`})]}),he&&e.jsx("div",{className:"absolute right-0 mt-2 w-64 sm:w-72 bg-white rounded-lg shadow-lg border border-slate-200 z-10",children:Oe().map(v=>{const[O,K]=t.split("-").map(Number),z=new Date(O,K-1,1).toLocaleDateString("en-US",{month:"short"}),B=`Week ${v.week} (${z} ${v.startDay}-${v.endDay})`;return e.jsx("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-primary-50 first:rounded-t-lg last:rounded-b-lg transition-colors",children:e.jsxs("button",{onClick:()=>{Le(v.week,v.dates),L(!1)},className:"flex-1 text-left text-sm",children:[B," ",e.jsxs("span",{className:"text-xs text-slate-500",children:["(",v.dates.length," days)"]})]})},v.week)})})]}),ue.length>0&&e.jsxs("div",{className:"relative flex-1 sm:flex-initial","data-tour":"embed-events",children:[e.jsxs(w,{onClick:()=>H(!Q),disabled:ge,size:"sm",variant:"outline",className:"flex items-center gap-1 sm:gap-2 w-full sm:w-auto text-xs sm:text-sm bg-orange-100 hover:bg-orange-200 text-orange-700 border-orange-200",children:[e.jsxs("span",{className:"font-semibold",children:["ðŸ“Œ ",ue.length]}),e.jsx("span",{className:"hidden sm:inline",children:"Embed Events"}),e.jsx("span",{className:"sm:hidden",children:"Embed"}),e.jsx(Qs,{size:12,className:`sm:w-3.5 sm:h-3.5 transition-transform ${Q?"rotate-180":""}`})]}),Q&&e.jsx("div",{className:"absolute right-0 mt-2 w-64 sm:w-72 bg-white rounded-lg shadow-lg border border-slate-200 z-10",children:Oe().map(v=>{const O=is[v.week]||0;if(O===0)return null;const[K,z]=t.split("-").map(Number),B=new Date(K,z-1,1).toLocaleDateString("en-US",{month:"short"}),X=`Week ${v.week} (${B} ${v.startDay}-${v.endDay})`;return e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-orange-50 first:rounded-t-lg last:rounded-b-lg transition-colors",children:[e.jsx("button",{onClick:()=>{Je(v.week),H(!1)},className:"flex-1 text-left text-sm",children:X}),e.jsxs("span",{className:"ml-2 px-2 py-1 bg-orange-100 text-orange-700 rounded text-xs font-medium",children:["ðŸ“Œ ",O]})]},v.week)})})]}),e.jsx("div",{"data-tour":"generate-month",children:e.jsxs(w,{onClick:Re,disabled:D,size:"sm",className:"flex items-center gap-1 sm:gap-2 bg-gradient-to-r from-accent-500 to-accent-600 hover:from-accent-600 hover:to-accent-700 text-white flex-1 sm:flex-initial text-xs sm:text-sm",children:[e.jsx(ds,{size:14,className:"sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Generate Full Month"}),e.jsx("span",{className:"sm:hidden",children:"Full Month"})]})}),e.jsxs(w,{onClick:Be,disabled:!C||C.items.length===0,size:"sm",variant:"outline",className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm border-primary-300 hover:bg-primary-50",title:"Export calendar to formatted text file",children:[e.jsx(Fa,{size:14,className:"sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Export Calendar"}),e.jsx("span",{className:"sm:hidden",children:"Export"})]})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Andora will skip perfect briefs and regenerate the rest. Each day is a story scene with character-driven narrative."})]}),e.jsx("div",{className:"glass-effect rounded-xl p-3 sm:p-4 border border-primary-500/20",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-4",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>pe("prev"),className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(us,{size:14,className:"sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"Prev"})]}),e.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-semibold text-dark-900 text-center",children:P}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>pe("next"),className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx("span",{className:"sm:hidden",children:"Next"}),e.jsx(Qe,{size:14,className:"sm:w-4 sm:h-4"})]})]})}),e.jsx("div",{"data-tour":"calendar-grid",className:`transition-all duration-300 ${E?"lg:pr-96":""}`,children:e.jsx(Wr,{month:t,calendar:C,events:se,brand:s,onContentClick:je,onGenerateDate:Ge,canEdit:u,isGenerating:D,generatingDate:te,glowingItems:ee})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(Zr,{isOpen:E,onClose:()=>{S(!1),_(null)},content:T,allContentForDay:T?C==null?void 0:C.items.filter(v=>v.date===T.date):[],allContent:(C==null?void 0:C.items)||[],brand:s,onContentUpdate:Ke,onRegenerate:Y,preferredModel:o,canEdit:u,events:se,monthTheme:s.monthly_themes[t],weekFocus:T?ze(T.date).weekFocus:void 0,showNotification:A,hideNotification:g})}),e.jsx("div",{className:"lg:hidden",children:e.jsx(Vr,{isOpen:E,onClose:()=>{S(!1),_(null)},content:T,allContentForDay:T?C==null?void 0:C.items.filter(v=>v.date===T.date):[],allContent:(C==null?void 0:C.items)||[],brand:s,onContentUpdate:Ke,onRegenerate:Y,preferredModel:o,canEdit:u,events:se,monthTheme:s.monthly_themes[t],weekFocus:T?ze(T.date).weekFocus:void 0,showNotification:A,hideNotification:g})}),Z&&Se!==null&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md shadow-2xl",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:["Week ",Se," is Perfect"]}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"This week's subplot is marked as perfect. Embedding new events will update it and mark it as imperfect. Do you want to proceed anyway?"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(w,{variant:"outline",onClick:()=>{_e(!1),W(null),Ce(!1)},children:"Cancel"}),e.jsx(w,{onClick:()=>{Se!==null&&Je(Se,!0)},className:"bg-orange-500 hover:bg-orange-600 text-white",children:"Reflow Anyway"})]})]})})]})},Cn=Object.freeze(Object.defineProperty({__proto__:null,MonthlyPage:rn},Symbol.toStringTag,{value:"Module"})),nn=({brand:s})=>{var A;const[l,r]=_t("gemini-2.5-flash"),[c,u]=n.useState([{id:"welcome",role:"assistant",content:`Hello! I'm Andora, your storytelling companion for ${s.brand_name}. I have complete awareness of your brand narrative, character cast, and strategic context. How can I help bring your story to life today?`,timestamp:new Date}]),[o,N]=n.useState(""),[k,x]=n.useState(!1),i=()=>ie(void 0,null,function*(){if(!o.trim()||k)return;const g={id:`user-${Date.now()}`,role:"user",content:o.trim(),timestamp:new Date};u(m=>[...m,g]),N(""),x(!0);try{const m=yield ms.chatResponse(o.trim(),s,s.cast_management||[],l),j={id:`assistant-${Date.now()}`,role:"assistant",content:m,timestamp:new Date};u(t=>[...t,j])}catch(m){console.error("Error getting AI response:",m);const j={id:`error-${Date.now()}`,role:"assistant",content:"I apologize, but I encountered a temporary glitch in my neural pathways. Please try again, and I'll be right back to help you craft amazing content!",timestamp:new Date};u(t=>[...t,j])}finally{x(!1)}}),d=g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),i())};return e.jsxs("div",{className:"max-w-4xl mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6 space-y-3 sm:space-y-4 md:space-y-6 relative floating-particles min-w-0 overflow-x-hidden",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx(es,{size:"lg",className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold shimmer-text truncate",children:"Chat with Andora"}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 mt-1",children:[e.jsx(Pe,{className:"w-3 h-3 sm:w-4 sm:h-4 text-primary-400 shrink-0"}),e.jsxs("p",{className:"text-slate-500 text-xs sm:text-sm lg:text-base truncate",children:["Your storytelling companion for ",s.brand_name]})]})]})]}),e.jsx("div",{className:"flex-shrink-0 w-full sm:w-auto",children:e.jsx($s,{value:l,onChange:r})})]}),e.jsxs("div",{className:"neural-glow p-4 rounded-lg border border-primary-500/30",children:[e.jsx("h3",{className:"font-medium text-primary-300 mb-2",children:"My Knowledge Base:"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 sm:gap-4 text-sm text-slate-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Brand Story:"})," Complete narrative framework"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Characters:"})," ",((A=s.cast_management)==null?void 0:A.length)||0," cast members"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Channels:"})," ",s.channels.join(", ")]})]})]}),e.jsxs("div",{className:"glass-effect rounded-lg h-[500px] sm:h-[600px] flex flex-col border border-primary-500/20",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-4",children:[c.map(g=>e.jsxs("div",{className:`flex items-start space-x-2 sm:space-x-3 ${g.role==="user"?"flex-row-reverse space-x-reverse":""}`,children:[e.jsx("div",{className:"flex-shrink-0",children:g.role==="user"?e.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-gradient-to-r from-primary-600 to-purple-600 flex items-center justify-center",children:e.jsx(Qt,{size:16,className:"text-white"})}):e.jsx(es,{size:"sm"})}),e.jsxs("div",{className:`flex-1 max-w-[85%] sm:max-w-[70%] ${g.role==="user"?"text-right":"text-left"}`,children:[e.jsx("div",{className:`inline-block px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-sm sm:text-base ${g.role==="user"?"bg-gradient-to-r from-primary-600 to-purple-600 text-white":"conversation-bubble text-slate-600"}`,children:e.jsx("p",{className:"whitespace-pre-wrap",children:g.content})}),e.jsx("div",{className:"text-xs text-slate-500 mt-2",children:g.timestamp.toLocaleTimeString()})]})]},g.id)),k&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(es,{size:"sm",animate:!0}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"inline-block px-3 sm:px-4 py-2 sm:py-3 conversation-bubble",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-primary-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-accent-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})})]})]}),e.jsxs("div",{className:"border-t border-primary-200/60 p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsx(Ie,{value:o,onChange:g=>N(g.target.value),onKeyDown:d,placeholder:"Ask me about content strategy, character development, seasonal themes, or anything about your brand story...",rows:2,className:"flex-1 resize-none text-sm",disabled:k}),e.jsxs(w,{onClick:i,disabled:!o.trim()||k,className:"flex items-center self-end sm:self-end",size:"sm",children:[e.jsx(_s,{size:16,className:"mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Send"})]})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-2 flex items-center justify-center sm:justify-start",children:[e.jsx(Pe,{size:12,className:"mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Press Enter to send â€¢ Shift+Enter for new line"}),e.jsx("span",{className:"sm:hidden",children:"Enter to send â€¢ Shift+Enter for new line"})]})]})]})]})},Sn=Object.freeze(Object.defineProperty({__proto__:null,ChatPage:nn},Symbol.toStringTag,{value:"Module"})),ln=({brand:s})=>{var k,x,i,d;const[l,r]=vs.useState(!0),c=(x=(k=s==null?void 0:s.cast_management)==null?void 0:k.length)!=null?x:0,u=Object.keys((s==null?void 0:s.monthly_themes)||{}).length,o=(d=(i=s==null?void 0:s.channels)==null?void 0:i.length)!=null?d:0,N=Object.keys((s==null?void 0:s.season_plans)||{}).length;return Object.keys((s==null?void 0:s.weekly_subplots)||{}).length,Object.keys((s==null?void 0:s.monthly_calendars)||{}).length,vs.useEffect(()=>{const A=setTimeout(()=>r(!1),300);return()=>clearTimeout(A)},[]),l?e.jsx("div",{className:"mx-auto max-w-7xl px-6 py-10",children:e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-2 border-primary-600 border-t-transparent"}),e.jsx("p",{className:"text-slate-600",children:"Preparing your control center..."})]})})}):e.jsxs("div",{className:"mx-auto max-w-7xl space-y-10 px-6 py-10",children:[e.jsx("section",{className:"overflow-hidden rounded-3xl border border-primary-500/10 bg-gradient-to-br from-primary-500/10 via-white to-transparent p-8 shadow-xl",children:e.jsxs("div",{className:"flex flex-col gap-8 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-primary-500/10 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-primary-600",children:[e.jsx(Ls,{className:"h-4 w-4"})," Narrative Control Center"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-900 sm:text-4xl",children:s?`Welcome back to ${s.brand_name}`:"Your story studio is ready"}),e.jsx("p",{className:"mt-2 max-w-2xl text-sm text-slate-600 sm:text-base",children:s?"Track momentum, align your cast, and keep every beat connected. Scroll down to see the strongest opportunities right now.":"Create a brand to unlock character creation, content arcs, and event-driven planning in one intuitive dashboard."})]})]}),e.jsxs("div",{className:"grid w-full gap-4 sm:grid-cols-2 lg:max-w-lg",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200/70 bg-white/80 px-5 py-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Characters"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx(Ns,{className:"h-5 w-5 text-primary-500"}),e.jsx("span",{className:"text-2xl font-bold text-primary-900",children:c})]})]}),e.jsxs("div",{className:"rounded-2xl border border-primary-500/20 bg-primary-500/10 px-5 py-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-primary-600",children:"Monthly Themes"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx(ps,{className:"h-5 w-5 text-primary-500"}),e.jsx("span",{className:"text-2xl font-bold text-primary-900",children:u})]})]}),e.jsxs("div",{className:"rounded-2xl border border-emerald-500/20 bg-emerald-50/80 px-5 py-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-emerald-600",children:"Channels"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx(Xt,{className:"h-5 w-5 text-emerald-500"}),e.jsx("span",{className:"text-2xl font-bold text-emerald-700",children:o})]})]}),e.jsxs("div",{className:"rounded-2xl border border-indigo-500/20 bg-indigo-500/10 px-5 py-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-600",children:"Season Plans"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx(La,{className:"h-5 w-5 text-indigo-500"}),e.jsx("span",{className:"text-2xl font-bold text-indigo-700",children:N})]})]})]})]})}),e.jsxs("section",{className:"space-y-6",children:[s&&(()=>{var T;const A=new Date,g=[0,1,2].map(_=>{const E=new Date(A);return E.setDate(A.getDate()+_),E}),m=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}`,j=(T=s.monthly_calendars)==null?void 0:T[m];s.cast_management;const t=_=>{const E=`${_.getFullYear()}-${String(_.getMonth()+1).padStart(2,"0")}-${String(_.getDate()).padStart(2,"0")}`;return(j==null?void 0:j.items.filter(S=>S.date===E))||[]},F=_=>_===0?"Today":_===1?"Tomorrow":g[_].toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});return e.jsxs("div",{className:"rounded-3xl border border-primary-200/40 bg-gradient-to-br from-purple-500/10 via-white to-transparent p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"This Week's Content"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Character assignments for your upcoming briefs"})]}),e.jsx(ps,{className:"h-5 w-5 text-purple-500"})]}),e.jsx("div",{className:"mt-5 space-y-3",children:g.map((_,E)=>{const S=t(_),D=S.map(G=>G.character_focus).filter(Boolean).slice(0,3);return e.jsx("div",{className:"rounded-2xl border border-purple-200/40 bg-white/80 px-5 py-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-600",children:F(E)}),e.jsx("p",{className:"mt-1 text-sm text-slate-900",children:S.length>0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-semibold",children:S.length})," brief",S.length===1?"":"s"]}):e.jsx("span",{className:"text-slate-500",children:"No briefs scheduled"})}),D.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:D.map((G,te)=>e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-purple-100 px-2 py-0.5 text-xs font-medium text-purple-700 border border-purple-200",children:[e.jsx(Ns,{className:"h-3 w-3"}),G]},te))})]})})},E)})}),j&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("a",{href:"/monthly",className:"inline-flex items-center gap-2 text-sm font-medium text-purple-600 hover:text-purple-700 transition-colors",children:["View full calendar",e.jsx(Ps,{className:"h-4 w-4"})]})})]})})(),e.jsxs("div",{className:"rounded-3xl border border-slate-200/70 bg-white/90 p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Focus Routes"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Deep dive into the workspace area that will have the biggest impact today."})]}),e.jsx(Ps,{className:"h-5 w-5 text-slate-400"})]}),e.jsxs("div",{className:"mt-5 space-y-4",children:[e.jsxs("a",{href:"/events",className:"block rounded-2xl border border-primary-500/20 bg-primary-500/5 px-5 py-4 transition hover:border-primary-500/40 hover:bg-primary-500/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-primary-800",children:"Events & Moments"}),e.jsx("span",{className:"text-xs text-primary-600",children:"Sync your timeline"})]}),e.jsx("p",{className:"mt-2 text-sm text-primary-700",children:"Keep upcoming launches visible so subplot ideas and calendars stay relevant."})]}),e.jsxs("a",{href:"/monthly",className:"block rounded-2xl border border-emerald-500/20 bg-emerald-50/80 px-5 py-4 transition hover:border-emerald-500/40",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-emerald-700",children:"Monthly Planning"}),e.jsx("span",{className:"text-xs text-emerald-600",children:u>0?`${u} theme${u===1?"":"s"} defined`:"Set your arc"})]}),e.jsx("p",{className:"mt-2 text-sm text-emerald-700",children:"Align your narrative pillars with actionable prompts for the next content cycle."})]}),e.jsxs("a",{href:"/plot",className:"block rounded-2xl border border-indigo-500/20 bg-indigo-500/10 px-5 py-4 transition hover:border-indigo-500/40",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-indigo-800",children:"Plot Builder"}),e.jsx("span",{className:"text-xs text-indigo-600",children:"Craft story beats"})]}),e.jsx("p",{className:"mt-2 text-sm text-indigo-700",children:"Use AI-assisted arcs to keep every initiative grounded in character perspective."})]}),e.jsxs("a",{href:"/chat",className:"block rounded-2xl border border-slate-200/80 bg-slate-50 px-5 py-4 transition hover:border-slate-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Andora Copilot"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Collaborate faster"})]}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"Brief Andora on upcoming pushes, draft scripts, or refine pitches in real-time."})]})]})]}),!s&&e.jsxs("div",{className:"rounded-3xl border border-dashed border-primary-300 bg-white/80 p-6 text-center shadow-inner",children:[e.jsx(Pe,{className:"mx-auto h-8 w-8 text-primary-500"}),e.jsx("h2",{className:"mt-4 text-xl font-semibold text-slate-900",children:"Build your first brand"}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"Define your mission, capture your cast, and unlock guided storytelling experiences tailored to you."})]})]})]})},An=Object.freeze(Object.defineProperty({__proto__:null,DashboardPage:ln},Symbol.toStringTag,{value:"Module"})),on=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"404 - Not Found"}),e.jsx("p",{className:"mt-4 text-lg",children:"The page you are looking for does not exist."})]}),Tn=Object.freeze(Object.defineProperty({__proto__:null,NotFoundPage:on},Symbol.toStringTag,{value:"Module"}));export{yn as B,gn as C,An as D,kn as E,un as H,Cn as M,Tn as N,fn as P,jn as S,vn as T,Is as a,bn as b,Nn as c,wn as d,_n as e,Sn as f,pn as u};
